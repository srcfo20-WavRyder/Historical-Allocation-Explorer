
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="88692d2a-3632-568f-bda6-6b4d23fa6301")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,512929,(e,t,i)=>{},238552,(e,t,i)=>{var a=e.i(303583);e.r(512929);var s=e.r(421593),r=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(s),n=void 0!==a.default&&a.default.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,i=t.name,a=void 0===i?"stylesheet":i,s=t.optimizeForSpeed,r=void 0===s?n:s;d(o(a),"`name` must be a string"),this._name=a,this._deletedRulePlaceholder="#"+a+"-deleted-rule____{}",d("boolean"==typeof r,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=r,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,i=e.prototype;return i.setOptimizeForSpeed=function(e){d("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),d(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},i.isOptimizeForSpeed=function(){return this._optimizeForSpeed},i.inject=function(){var e=this;if(d(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(n||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,i){return"number"==typeof i?e._serverSheet.cssRules[i]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),i},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},i.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},i.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},i.insertRule=function(e,t){if(d(o(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var i=this.getSheet();"number"!=typeof t&&(t=i.cssRules.length);try{i.insertRule(e,t)}catch(t){return n||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var a=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,a))}return this._rulesCount++},i.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var i="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!i.cssRules[e])return e;i.deleteRule(e);try{i.insertRule(t,e)}catch(a){n||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),i.insertRule(this._deletedRulePlaceholder,e)}}else{var a=this._tags[e];d(a,"old rule at index `"+e+"` not found"),a.textContent=t}return e},i.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];d(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},i.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},i.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,i){return i?t=t.concat(Array.prototype.map.call(e.getSheetForTag(i).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},i.makeStyleTag=function(e,t,i){t&&d(o(t),"makeStyleTag accepts only strings as second parameter");var a=document.createElement("style");this._nonce&&a.setAttribute("nonce",this._nonce),a.type="text/css",a.setAttribute("data-"+e,""),t&&a.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return i?s.insertBefore(a,i):s.appendChild(a),a},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}();function d(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var c=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return t>>>0},u={};function p(e,t){if(!t)return"jsx-"+e;var i=String(t),a=e+i;return u[a]||(u[a]="jsx-"+c(e+"-"+i)),u[a]}function m(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var i=e+t;return u[i]||(u[i]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[i]}var g=function(){function e(e){var t=void 0===e?{}:e,i=t.styleSheet,a=void 0===i?null:i,s=t.optimizeForSpeed,r=void 0!==s&&s;this._sheet=a||new l({name:"styled-jsx",optimizeForSpeed:r}),this._sheet.inject(),a&&"boolean"==typeof r&&(this._sheet.setOptimizeForSpeed(r),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var i=this.getIdAndRules(e),a=i.styleId,s=i.rules;if(a in this._instancesCounts){this._instancesCounts[a]+=1;return}var r=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[a]=r,this._instancesCounts[a]=1},t.remove=function(e){var t=this,i=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(i in this._instancesCounts,"styleId: `"+i+"` not found"),this._instancesCounts[i]-=1,this._instancesCounts[i]<1){var a=this._fromServer&&this._fromServer[i];a?(a.parentNode.removeChild(a),delete this._fromServer[i]):(this._indices[i].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[i]),delete this._instancesCounts[i]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],i=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return i[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,i;return t=this.cssRules(),void 0===(i=e)&&(i={}),t.map(function(e){var t=e[0],a=e[1];return r.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:i.nonce?i.nonce:void 0,dangerouslySetInnerHTML:{__html:a}})})},t.getIdAndRules=function(e){var t=e.children,i=e.dynamic,a=e.id;if(i){var s=p(a,i);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return m(s,e)}):[m(s,t)]}}return{styleId:p(a),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),h=s.createContext(null);function f(){return new g}function v(){return s.useContext(h)}h.displayName="StyleSheetContext";var y=r.default.useInsertionEffect||r.default.useLayoutEffect,x="undefined"!=typeof window?f():void 0;function b(e){var t=x||v();return t&&("undefined"==typeof window?t.add(e):y(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}b.dynamic=function(e){return e.map(function(e){return p(e[0],e[1])}).join(" ")},i.StyleRegistry=function(e){var t=e.registry,i=e.children,a=s.useContext(h),n=s.useState(function(){return a||t||f()})[0];return r.default.createElement(h.Provider,{value:n},i)},i.createStyleRegistry=f,i.style=b,i.useStyleRegistry=v},717555,(e,t,i)=>{t.exports=e.r(238552).style},31157,742590,749659,605113,171686,e=>{"use strict";e.s([],31157);var t=e.i(247276);e.i(246429),e.i(685846),e.i(333309);var i=e.i(687448);e.i(66662),e.i(297473);var a=e.i(9461);e.i(125443),e.i(847675);var s=e.i(111041);(0,s.default)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),e.i(446836),e.i(266542);var r=e.i(920958),n=e.i(328788);e.i(243634),e.i(667536);var o=e.i(230433),l=e.i(211959),d=e.i(735806),c=e.i(555309),u=e.i(712548),p=e.i(633918),m=e.i(421593);e.i(18545);var g=e.i(116212);e.i(916390);var h=e.i(572848),f=e.i(763578),v=e.i(587221);e.i(692249);var y=e.i(687712),x=e.i(486492);e.i(364778),e.i(298616),e.i(910503);var b=e.i(133735);e.i(165475);var I=e.i(533431),S=e.i(723008);e.s(["UpsellFlow",()=>ep],605113);var j=e.i(12465),k=e.i(913106),_=e.i(942938);e.s(["UpsellPlansV2",()=>er],749659);var C=e.i(648843),w=e.i(831413),w=w,N=e.i(531875),E=e.i(401100);let P=(0,s.default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var R=e.i(979566),M=e.i(211555);let A=(0,s.default)("GlobeLock",[["path",{d:"M15.686 15A14.5 14.5 0 0 1 12 22a14.5 14.5 0 0 1 0-20 10 10 0 1 0 9.542 13",key:"qkt0x6"}],["path",{d:"M2 12h8.5",key:"ovaggd"}],["path",{d:"M20 6V4a2 2 0 1 0-4 0v2",key:"1of5e8"}],["rect",{width:"8",height:"5",x:"14",y:"6",rx:"1",key:"1fmf51"}]]),L=(0,s.default)("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);var U=e.i(351958);let T=(0,s.default)("Infinity",[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]]);e.s(["default",()=>z],742590);let z=(0,s.default)("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);var D=e.i(399628);let F=(0,s.default)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);var O=e.i(43491),B=e.i(793936),G=e.i(7390),H=e.i(90476),W=e.i(353824),Y=e.i(934357),K=e.i(206235),q=e.i(25594),V=e.i(715127),X=e.i(50636),Q=e.i(73978),Z=e.i(408430);e.i(690654);var $=e.i(129876),J=e.i(72290),ee=e.i(717555);function et(e){let{children:i,className:a,speed:s=.3,colorFrom:r="#d946ef",colorTo:n="#3b82f6",occasionalHighlight:o=!1,highlightInterval:d=4}=e,c=2/s;return(0,t.jsxs)("div",{style:{...o?{animation:"occasionalGradient ".concat(o?d:c,"s ease-in-out infinite")}:{backgroundImage:"linear-gradient(to right, ".concat(r,", ").concat(n,", ").concat(r,")"),backgroundSize:"200% 100%",animation:"gradient ".concat(c,"s ease-in-out infinite")}},className:ee.default.dynamic([["826796e2f576888e",[r,n,r,r,n,r,r,n,r]]])+" "+((0,l.cn)("relative inline-block",o?"text-current":"bg-gradient-to-r bg-clip-text text-transparent",a)||""),children:[i,(0,t.jsx)(ee.default,{id:"826796e2f576888e",dynamic:[r,n,r,r,n,r,r,n,r],children:"@keyframes gradient{0%,to{background-position:0%}50%{background-position:100%}}@keyframes occasionalGradient{0%,80%{background:0 0;background-clip:initial;color:inherit}85%{background:linear-gradient(to right,".concat(r,",").concat(n,",").concat(r,");color:transparent;background-position:0%;background-size:200% 100%;-webkit-background-clip:text;background-clip:text}92.5%{background:linear-gradient(to right,").concat(r,",").concat(n,",").concat(r,");color:transparent;background-position:100%;background-size:200% 100%;-webkit-background-clip:text;background-clip:text}to{background:linear-gradient(to right,").concat(r,",").concat(n,",").concat(r,");color:transparent;background-position:0%;background-size:200% 100%;-webkit-background-clip:text;background-clip:text}}")})]})}var ei=e.i(694193);function ea(){return(0,t.jsxs)(c.motion.div,{initial:{opacity:0,translateY:-150},animate:{opacity:.15,translateY:0},transition:{duration:1,ease:"easeOut"},className:"absolute -inset-x-[600px] -top-12 flex h-[400px] grow opacity-[0.15] blur-lg",style:{maskImage:"linear-gradient(to top, rgba(255, 255, 255, 0), rgb(255, 255, 255))",WebkitMaskImage:"linear-gradient(to top, rgba(255, 255, 255, 0), rgb(255, 255, 255))"},children:[(0,t.jsx)("div",{className:"grow gradient-one"}),(0,t.jsx)("div",{className:"grow gradient-two"}),(0,t.jsx)("style",{children:"\n      .gradient-one {\n        background: linear-gradient(to bottom, rgb(255, 255, 255), rgba(10, 10, 10, 0)); /* Fallback for non-conic browsers */\n        background: conic-gradient(\n          from 90deg at 35% -1%,\n          rgb(255, 255, 255) 7.2deg,\n          rgb(255, 255, 255) 14.4deg,\n          rgba(10, 10, 10, 0) 36deg,\n          rgba(10, 10, 10, 0) 342deg,\n          rgb(255, 255, 255) 360deg\n        ); /* Overrides if supported */\n      }\n      .gradient-two {\n        background: linear-gradient(to bottom, rgb(255, 255, 255), rgba(10, 10, 10, 0)); /* Fallback for non-conic browsers */\n        background: conic-gradient(\n          from -90deg at 65% -1%,\n          rgb(255, 255, 255) 0deg,\n          rgba(10, 10, 10, 0) 18deg,\n          rgba(10, 10, 10, 0) 324deg,\n          rgb(255, 255, 255) 345.6deg,\n          rgb(255, 255, 255) 352.8deg\n        ); /* Overrides if supported */\n      }\n    "})]})}var es=e.i(845285);let er=e=>{let{isSubscribed:s,isSuccessful:p}=e,{t:h}=(0,g.useTranslation)("upsell"),f=(0,X.useFeatureFlags)(),[y,x]=(0,m.useState)(f.SUPERGROK_PAYWALL_ANNUAL_SELECTED_DEFAULT_ENABLED?"yearly":"monthly"),b=(0,d.useUpsellStore)(e=>e.upsellCategory),S=(0,r.useLogEvent)(),{currentTeam:j}=(0,$.useEnterprise)(),[k,_]=(0,m.useState)({individual:1,team:+!!j}),Q=(0,n.useMobileSize)(),J=(0,u.useSearchParams)();(0,m.useEffect)(()=>{s?S("upsell_fullscreen_open_subbed","",{location:"upsell-plans",isSubscribed:"true"}):S("upsell_fullscreen_open_not_subbed","",{location:"upsell-plans",isSubscribed:"false"})},[]),(0,m.useEffect)(()=>{if(p){let e=null==J?void 0:J.get("tier"),t=null==J?void 0:J.get("interval");S("upsell_fullscreen_open_success","",{location:"upsell-plans",isSubscribed:String(s),...e&&{tier:e},...t&&{interval:t}})}},[p,J]);let{resolvedTheme:ee}=(0,Z.useTheme)(),et="dark"===ee,{bestSubscription:ei}=(0,o.useSubscriptions)(),{superGrokSubscriptionPrices:er,superGrokProSubscriptionPrices:el,error:eu}=(0,o.useStripe)(),ep=(0,m.useRef)(!1);(0,m.useEffect)(()=>(eu&&!ep.current&&(I.toast.error(h("useStripe.fail","Failed to connect to subscription service")),ep.current=!0),()=>{ep.current=!1}),[eu,h]);let em=(0,m.useCallback)(()=>{S("toggle_interval","",{location:"upsell-plans",previousInterval:y,newInterval:"monthly"===y?"yearly":"monthly"}),x(e=>"monthly"===e?"yearly":"monthly")},[y,S]),eg=(0,m.useCallback)(()=>{let{setUpsellCategory:e}=d.useUpsellStore.getState(),t="individual"===b?"team":"individual";"team"===t&&x("monthly"),e(t)},[b]),eh=(0,m.useMemo)(()=>"team"===b?(0,t.jsxs)(c.motion.header,{initial:{opacity:0,translateY:8},animate:{opacity:1,translateY:0},transition:{duration:.4,ease:"easeOut"},className:"flex flex-col items-center gap-2",children:[(0,t.jsx)(es.GrokBusinessLogo,{isDark:et,className:"h-[40px] mb-[8px]"}),(0,t.jsxs)("div",{className:"flex flex-col items-center text-fg-secondary",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:h("grok-teams.tagline-first-line","Ignite collective genius")}),(0,t.jsx)("h3",{className:"text-lg font-semibold -m-1 dark:text-fg-tertiary",children:h("grok-teams.tagline-second-line","Scale intelligence across your organization")})]})]}):(0,t.jsxs)(c.motion.header,{initial:{opacity:0,translateY:8},animate:{opacity:1,translateY:0},transition:{duration:.4,ease:"easeOut"},className:"flex flex-col items-center gap-2",children:[(0,t.jsx)(es.SuperGrokWordPlain,{isDark:et,className:"h-[48px]"}),(0,t.jsxs)("div",{className:"flex flex-col items-center text-fg-secondary",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:h("grok-upsell-plans.title-grok-4-1","Introducing Grok 4.1")}),(0,t.jsx)("h3",{className:"text-lg font-semibold -m-1 dark:text-fg-tertiary",children:h("The most powerful AI model.","The most powerful AI model")})]})]}),[b,h,et]),ef={title:h("Basic","Basic"),ctaLabel:h("Sign up","Sign up"),isPopular:!1,features:[{Icon:N.CircleCheckIcon,label:h("free.limited-access-chat-models","Limited access to chat models")},{Icon:i.BrainIcon,label:h("free.limited-context-memory-v2","Limited context memory")},{Icon:V.ImageIcon,label:h("free.aurora-image-model-v2","Aurora image model")},{Icon:w.default,label:h("free.voice-with-vision","Voice access"),isHighlighted:!0},{Icon:R.FolderIcon,label:h("free.projects","Projects")},{Icon:C.AlarmCheckIcon,label:h("free.tasks","Tasks")}],monthlyPrice:"Free",yearlyPrice:"Free",planIndex:0,setSelectedPlanIndex:()=>{}},ev={title:h("supergrok.title","SuperGrok"),ctaLabel:h("supergrok.cta-label","Upgrade to SuperGrok"),isPopular:!0,features:[{Icon:N.CircleCheckIcon,label:h("supergrok.increased-access-grok-4-1","Increased access to Grok 4.1"),detail:h("supergrok.replaces-grok-3-v3","Improved reasoning and search capabilities"),isNewRowDetail:!0,isHighlighted:!0},{Icon:i.BrainIcon,label:h("supergrok.context-memory-v2","Extended memory"),detail:h("supergrok.context-memory-detail","{{tokens, number}} tokens",{tokens:128e3})},{Icon:w.default,label:h("supergrok.voice-with-vision-v2","Priority voice access")},{Icon:U.ImagePlusIcon,label:h("supergrok.imagine","Imagine image model "),isHighlighted:!0},{Icon:B.PersonalityIcon,label:h("supergrok.companions","Companions Ani and Valentine"),isHighlighted:!0},{Icon:G.PlusIcon,label:h("supergrok.everything-in-basic","Everything in Basic")}],monthlyPrice:null==er?void 0:er.monthly_price,yearlyPrice:null==er?void 0:er.yearly_price,planIndex:1,setSelectedPlanIndex:()=>{_(e=>({...e,individual:1}))}},ey={title:h("SuperGrok Heavy","SuperGrok Heavy"),ctaLabel:h("Upgrade to SuperGrok Heavy","Upgrade to Heavy"),isPopular:!1,features:[{Icon:K.ThunderIcon,label:h("supergrok-heavy.exclusive-preview-of-grok-4-heavy","Exclusive preview of Grok 4 Heavy"),isHighlighted:!0},{Icon:N.CircleCheckIcon,label:h("supergrok.extended-access-grok-4-1","Extended access to Grok 4.1")},{Icon:i.BrainIcon,label:h("supergrok-heavy.context-v2","Longest memory"),detail:h("supergrok-heavy.context.tokens","{{tokens, number}} tokens",{tokens:256e3})},{Icon:a.FlaskConical,label:h("supergrok-heavy.early-access-to-new-features","Early access to new features"),isHighlighted:!0},{Icon:G.PlusIcon,label:h("supergrok-heavy.everything-in-supergrok","Everything in SuperGrok")}],monthlyPrice:null==el?void 0:el.monthly_price,yearlyPrice:null==el?void 0:el.yearly_price,planIndex:2,setSelectedPlanIndex:()=>{_(e=>({...e,individual:2}))}},ex={title:h("Grok Business","Grok Business"),ctaLabel:h("Create a team","Create a team"),isPopular:!1,features:[{Icon:W.SuperGrokIcon,label:h("team.everything-in-supergrok","Everything in SuperGrok"),isHighlighted:!0},{Icon:L,label:h("team.sharing-collaboration","Sharing and collaboration")},{Icon:P,label:h("team.billing-and-invoicing","Centralized billing and invoicing")},{Icon:q.UsersIcon,label:h("team.user-access-management-v2","Advanced team + seat management")},{Icon:z,label:h("team.analytics-and-reporting","User analytics and reporting")},{Icon:A,label:h("team.domain-verification","Domain verification")},{Icon:M.GhostIcon,label:h("team.excluded-from-training","Excluded from training by default"),isHighlighted:!0},{Icon:G.PlusIcon,label:h("team.more-features","More")}],monthlyPrice:{id:"team",amount:{val:"3000"},currency:"usd",displayPrice:"$30/month",recurring:{interval:"monthly"}},yearlyPrice:{id:"team",amount:{val:"30000"},currency:"usd",displayPrice:"$300/year",recurring:{interval:"yearly"}},planIndex:0,setSelectedPlanIndex:()=>{_(e=>({...e,team:0}))}},eb={title:h("Enterprise","Enterprise"),ctaLabel:h("Contact us","Contact us"),isPopular:!1,features:[{Icon:T,label:h("enterprise.unlimited-users","Unlimited users")},{Icon:F,label:h("team.single-sign-on","Single sign-on (SSO)")},{Icon:H.RefreshCwIcon,label:h("team.directory-sync","Directory sync (SCIM)")},{Icon:D.LockIcon,label:h("enterprise.custom-rbac","Custom role-based access controls"),isHighlighted:!0},{Icon:E.ClockIcon,label:h("enterprise.custom-data-retention","Custom data retention")},{Icon:O.Network,label:h("enterprise.org-structure","Flexible organizational structures")},{Icon:Y.SupportIcon,label:h("enterprise.onboarding-and-support","Dedicated onboarding and support"),isHighlighted:!0},{Icon:G.PlusIcon,label:h("enterprise.more-features","More")}],monthlyPrice:"Enterprise",yearlyPrice:"Enterprise",planIndex:1,setSelectedPlanIndex:()=>{_(e=>({...e,team:1}))}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ea,{}),(0,t.jsx)(v.StarsBackground,{className:"[mask-image:radial-gradient(circle_at_top,#000000_0%,transparent_80%,transparent_100%)] z-0",starColor:et?[181,181,181]:[151,196,255]}),(0,t.jsxs)("div",{className:"flex flex-col w-full items-center gap-10 h-full pt-20",children:[eh,(0,t.jsx)(ec,{subType:b,onToggle:eg}),f.SUPERGROK_PAYWALL_INTERVAL_SELECTOR_AT_TOP_ENABLED&&(0,t.jsx)(ed,{subType:y,category:b,onToggle:em}),(0,t.jsxs)("div",{className:(0,l.cn)("relative w-full",{"max-w-5xl":"individual"===b&&!f.SUPERGROK_PAYWALL_HIDE_FREE_PLAN_CARD_ENABLED,"max-w-3xl":"team"===b||"individual"===b&&f.SUPERGROK_PAYWALL_HIDE_FREE_PLAN_CARD_ENABLED}),children:["individual"===b&&(0,t.jsxs)("div",{className:(0,l.cn)("grid gap-4 w-full relative",{"grid-cols-1 justify-items-center":Q,"grid-cols-3":!Q&&!f.SUPERGROK_PAYWALL_HIDE_FREE_PLAN_CARD_ENABLED,"grid-cols-2":!Q&&f.SUPERGROK_PAYWALL_HIDE_FREE_PLAN_CARD_ENABLED,"h-[450px]":!Q}),children:[!f.SUPERGROK_PAYWALL_HIDE_FREE_PLAN_CARD_ENABLED&&(0,t.jsx)(en,{...ef,frequencySubType:y,bestSubscription:ei,tier:void 0,selectedPlanIndex:k.individual}),(0,t.jsx)(en,{...ev,frequencySubType:y,bestSubscription:ei,tier:o.SubscriptionTier.SuperGrok,selectedPlanIndex:k.individual}),(0,t.jsx)(en,{...ey,frequencySubType:y,bestSubscription:ei,tier:o.SubscriptionTier.SuperGrokPro,selectedPlanIndex:k.individual})]}),"team"===b&&(0,t.jsxs)("div",{className:(0,l.cn)("grid gap-4 w-full relative",{"grid-cols-1 justify-items-center":Q,"grid-cols-2":!Q,"h-[450px]":!Q}),children:[(0,t.jsx)(eo,{...ex,teamTier:"team",frequencySubType:y,selectedPlanIndex:k.team}),(0,t.jsx)(eo,{...eb,teamTier:"enterprise",frequencySubType:y,selectedPlanIndex:k.team})]})]}),!f.SUPERGROK_PAYWALL_INTERVAL_SELECTOR_AT_TOP_ENABLED&&(0,t.jsx)(ed,{subType:y,category:b,onToggle:em})]})]})},en=e=>{let{frequencySubType:i,tier:a,bestSubscription:s,ctaLabel:n}=e,[l,d]=(0,m.useState)(!1),c=(0,r.useLogEvent)(),{t:u}=(0,g.useTranslation)("upsell"),{subscribeViaStripe:p}=(0,o.useStripe)(),h=(0,o.useGetSubscriptionError)(),f=(0,m.useCallback)(()=>{a&&(c("click_subscribe","",{location:"upsell-plans",interval:i,tier:a}),d(!0),p(i,a).catch(e=>{let t=h(String(e))||u("subscribe.fail","Oops, something went wrong while processing your subscription.");(0,I.toast)(t),c("subscribeViaStripe_fail","",{location:"upsell-plans"}),(0,x.logError)("upsell-plans",e)}).finally(()=>{d(!1)}))},[a,!1,c,p,i,h,u]),v=(0,m.useMemo)(()=>{let e=(0,o.getSubscriptionTierValue)(s),t=(0,o.getSubscriptionTierValue)(a),i=a===s;return{isDisabled:e>=t||void 0===a,ctaLabel:i?u("Current Plan","Current Plan"):e>t?u("You are on tier","You are on {{tier}}",{tier:(0,o.getSubscriptionTierName)(s)}):n}},[s,n,u,a,!1]);return(0,t.jsx)(el,{...e,isRedirecting:l,cardState:v,isSeatBased:!1,handleSelectCard:f})},eo=e=>{let{teamTier:i}=e,[a,s]=(0,m.useState)(!1),r=(0,u.useRouter)(),{currentTeam:n}=(0,$.useEnterprise)(),{user:o}=(0,h.useSession)(),{t:l}=(0,g.useTranslation)("upsell"),{CLOUD_CONSOLE_URL:d,WEBSITE_URL:c,ACCOUNT_URL:p}=(0,J.useEnvironment)(),f=(0,m.useCallback)(()=>{s(!0),"team"===i?(null==n?void 0:n.teamId)?r.push("".concat(d,"/team/").concat(n.teamId,"/grok-business")):(null==o?void 0:o.userId)?r.push("".concat(d,"?path=grok-business")):r.push("".concat(p,"/sign-up?redirect=cloud-console&action=grok-business")):r.push("".concat(c,"/grok/business/enquire"))},[i,null==n?void 0:n.teamId,null==o?void 0:o.userId,r,d,c,p]),v=(0,m.useMemo)(()=>{let t="team"===i&&!!n;return{isDisabled:t,ctaLabel:t?l("Current Plan","Current Plan"):e.ctaLabel}},[e.ctaLabel,l,n,i]);return(0,t.jsx)(el,{...e,isRedirecting:a,cardState:v,handleSelectCard:f,isSeatBased:!0,tier:void 0})};function el(e){let{title:i,isPopular:a,features:s,frequencySubType:r,monthlyPrice:o,yearlyPrice:c,tier:u,isRedirecting:h,cardState:v,isSeatBased:y,handleSelectCard:x,planIndex:b,selectedPlanIndex:I,setSelectedPlanIndex:j}=e,{t:k}=(0,g.useTranslation)("upsell"),_="monthly"===r?o:c,C=(0,X.useFeatureFlags)(),w=(0,d.useUpsellStore)(p.prop("setTargetTier")),N=I===b,E=(0,n.useMobileSize)(),P=(0,m.useCallback)(()=>{j(b),u&&w(u)},[b,j,u,w]),R=(0,m.useMemo)(()=>.5+1.5*Math.random(),[]);return(0,t.jsxs)("div",{className:(0,l.cn)("max-w-96 grow flex-1 w-full p-6 rounded-3xl bg-surface-l1 flex flex-col gap-6 shadow-sm z-[10] cursor-pointer",!E&&"self-stretch","border-2",N&&E?"border-fg-primary":"border-transparent"),onClick:P,children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center w-full justify-between h-6",children:[(0,t.jsx)("h1",{className:"text-sm font-bold",children:i}),a&&(0,t.jsx)("div",{className:"text-[12px] text-fg-primary font-semibold border px-1.5 py-0.5 rounded-lg dark:bg-surface-l2 bg-surface-base",children:k("Popular","Popular")})]}),(0,t.jsx)("h3",{className:"text-3xl font-bold text-fg-primary h-10",children:!!_&&("Free"===_?"Free":"Enterprise"===_?"Let's Talk":(0,t.jsxs)("div",{className:"flex items-end justify-between",children:[(0,t.jsx)(Q.default,{format:{style:"currency",currencyDisplay:"narrowSymbol",currency:_.currency,maximumFractionDigits:2,minimumFractionDigits:2},suffix:y?k("upsell.seat-suffix-with-currency","{{currency}}/seat",{currency:_.currency.toUpperCase()}):"monthly"===r||C.SUPERGROK_PAYWALL_ANNUAL_PRICING_MONTHLY_EQUIVALENT_ENABLED?k("upsell.month-suffix-with-currency","{{currency}}/month",{currency:_.currency.toUpperCase()}):k("upsell.year-suffix-with-currency","{{currency}}/year",{currency:_.currency.toUpperCase()}),value:"yearly"===r&&C.SUPERGROK_PAYWALL_ANNUAL_PRICING_MONTHLY_EQUIVALENT_ENABLED?parseFloat(_.amount.val)/100/12:parseFloat(_.amount.val)/100,className:"upsell-amount-suffix"}),"yearly"===r&&(0,t.jsx)("span",{className:"text-orange-400 text-[12px] ms-1 animate-in fade-in duration-300 ease-in-out whitespace-nowrap",children:k("saving-16","saving 16%")})]}))})]}),(0,t.jsx)(f.Button,{variant:v.isDisabled?"outline":"filled",className:(0,l.cn)("w-full font-semibold text-sm",!v.isDisabled&&"hover:scale-[101%] transition-transform duration-300","hover:bg-button-filled-hover"),size:"md",rounded:!0,onClick:x,disabled:h||v.isDisabled,"aria-label":h?k("Redirecting...","Redirecting..."):v.ctaLabel,children:h?(0,t.jsx)(S.Spinner,{className:"text-ivory",size:"sm"}):v.ctaLabel}),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:s.map(e=>(0,t.jsx)("div",{className:"flex items-center justify-between text-sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[e.Icon&&(0,t.jsx)(e.Icon,{className:(0,l.cn)("text-fg-tertiary my-0.5 size-4 flex-shrink-0",{"text-fg-primary":e.isHighlighted})}),(0,t.jsxs)("div",{className:"min-h-4",children:[C.SUBSCRIPTIONS_PAGE_ANIMATE&&e.isHighlighted&&N?(0,t.jsx)(et,{className:"font-semibold text-sm",occasionalHighlight:!1,speed:R,children:e.label}):e.isHighlighted||e.isBold?(0,t.jsx)("span",{className:(0,l.cn)("inline","font-semibold"),children:e.label}):(0,t.jsx)("span",{className:"inline",children:e.label}),e.detail&&(0,t.jsx)("span",{className:(0,l.cn)("text-fg-secondary text-xs ",e.isNewRowDetail?"inline-block":"inline ps-1"),children:e.detail})]})]})},e.label))})]})}let ed=e=>{let{subType:i,category:a,onToggle:s}=e,{t:r}=(0,g.useTranslation)("upsell");return"team"===a?null:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[r("Save-with-yearly-billing","Save with yearly billing"),(0,t.jsx)(ei.Switch,{checked:"yearly"===i,onCheckedChange:s,className:"relative"})]})},ec=e=>{let{subType:i,onToggle:a}=e,{t:s}=(0,g.useTranslation)("upsell"),r=[{key:"individual",label:s("Individual","Individual")},{key:"team",label:s("Business","Business")}];return(0,t.jsx)("div",{className:(0,l.cn)("inline-flex text-sm font-bold p-0.5 border rounded-full text-fg-secondary bg-surface-inset cursor-pointer relative"),onClick:a,children:r.map(e=>{let{key:a,label:s}=e,r=i===a;return(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)("button",{type:"button",className:(0,l.cn)("relative z-10 w-full py-1.5 px-3 rounded-full flex items-center justify-center whitespace-nowrap border border-transparent transition-colors",{"text-fg-primary":r}),children:(0,t.jsx)("span",{className:"relative z-10",children:s})}),r&&(0,t.jsx)(c.motion.div,{layoutId:"activeToggle",className:"absolute inset-0 bg-surface-l1 rounded-full",transition:{type:"spring",stiffness:500,damping:35}})]},a)})})},eu=e=>{let{onOpenChange:i,isSubscribed:a,isSuccessful:s,...r}=e,{t:n}=(0,g.useTranslation)("base");return(0,t.jsxs)(k.Dialog,{...r,onOpenChange:i,children:[(0,t.jsx)(k.DialogOverlay,{className:"fixed inset-0 z-50 bg-overlay duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,t.jsx)(_.VisuallyHidden,{children:(0,t.jsx)(y.DialogTitle,{children:n("superGrok-upsell-dialog.title","Upgrade to SuperGrok")})}),(0,t.jsxs)(k.DialogContent,{className:(0,l.cn)("fixed z-50 bg-background grid inset-0 place-items-center gap-4 duration-200 w-[100vw] min-h-[100vh] overflow-x-hidden","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 p-6"),onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:[(0,t.jsx)(er,{onSuccess:()=>null==i?void 0:i(!1),isSubscribed:a,isSuccessful:s}),(0,t.jsx)(f.Button,{variant:"ghostSecondary",size:"iconMd",className:"absolute top-4 right-4",onClick:()=>null==i?void 0:i(!1),"aria-label":n("Close","Close"),children:(0,t.jsx)(j.XIcon,{className:"size-5"})})]})]})},ep=()=>{let e=(0,h.useSession)(),{isSuperGrokUser:i,isSuperGrokProUser:a,isEnterpriseUser:s}=(0,o.useSubscriptions)(),r=(0,o.useCheckoutSuccess)(),n=(0,d.useUpsellStore)(p.prop("isUpselling")),l=(0,d.useUpsellStore)(p.prop("setIsUpselling"));return e.user?(0,t.jsx)(eu,{open:n,isSubscribed:i||a||s||!1,isSuccessful:r,onOpenChange:e=>{l(e)}}):null};e.s(["UpsellSuperGrokSmall",()=>ev],171686);var em=e.i(500751),eg=e.i(59238),eh=e.i(128803),ef=e.i(290583);function ev(){let{t:e}=(0,g.useTranslation)("upsell"),{isVisible:i,setClosedUpsellSmallKey:a,upsellSmallKey:s}=function(){var e;let t=(0,X.useFeatureFlags)(),i=(0,m.useMemo)(()=>ex.safeParse(t.UPSELL_SMALL_KEY.value),[t.UPSELL_SMALL_KEY.value]),a=null==(e=i.data)?void 0:e.key,[s,r]=(0,eh.useLocalStorage)("upsell-small-closed",""),n=i.success&&a!==s,l=(0,h.useSession)(),c=(0,d.useUpsellStore)(e=>e.isUpselling),u=(0,eg.useIsUpsellLayerVisible)(d.UPSELL_SMALL_PRIORITY),{isEnterpriseUser:p,isSuperGrokUser:g,isSuperGrokProUser:f,isPending:v}=(0,o.useSubscriptions)();return{isVisible:!(!n||c||p||g||f||v||!l.user)&&u,setClosedUpsellSmallKey:r,upsellSmallKey:a}}(),n=(0,r.useLogEvent)(),l=(0,m.useCallback)(()=>{let{setIsUpselling:e}=d.useUpsellStore.getState();n("upsell_card_clicked","",{location:"upsell-small"}),e(!0)},[n]),c=(0,m.useCallback)(e=>{e.stopPropagation(),a(s)},[a,s]);return(0,t.jsx)(ey,{isVisible:i,logo:(0,t.jsx)(es.SuperGrokWordPlain,{className:"h-[20px] mb-1",isDark:!0}),description:e("upsell-small.description","Unlock extended capabilities"),handleClick:l,handleClickClose:c})}function ey(e){let{isVisible:i,handleClick:a,handleClickClose:s,logo:r,description:n}=e,{t:o}=(0,g.useTranslation)("upsell");return(0,t.jsx)(b.AnimatePresence,{children:i&&(0,t.jsxs)(c.motion.div,{role:"button",className:(0,l.cn)("upsell-small","relative sm:fixed sm:bottom-2 sm:right-2","px-5 py-4 items-center w-[calc(100%-16px)] bg-black text-xs text-white border cursor-pointer","border-card min-[384px]:w-max min-[384px]:min-w-52 rounded-3xl group text-left","flex gap-4 dark","hover:scale-[1.01]"),onClick:a,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",stiffness:900,damping:30,duration:.1},children:[(0,t.jsx)(v.StarsBackground,{starDensity:.001,className:"rounded-[23px]"}),(0,t.jsx)("div",{className:"absolute inset-0 flex justify-center top-0 overflow-hidden rounded-[23px]",children:(0,t.jsx)("div",{className:"size-80 bg-red-500 bg-gradient-to-r from-sunset via-breeze to-cobalt aspect-square opacity-10 absolute bottom-4 blur-[32px] rounded-full"})}),(0,t.jsx)(f.Button,{className:(0,l.cn)("absolute transition-all scale-50 opacity-0 -top-1.5 -right-1.5","group-hover:opacity-100 group-hover:scale-100 border border-border-l1 bg-surface-base hover:bg-surface-l2"),variant:"none",size:"iconXs",rounded:!0,"aria-label":o("Hide upsell banner","Hide upsell banner"),onClick:s,children:(0,t.jsx)(em.PopInOut,{children:(0,t.jsx)(j.XIcon,{className:"size-4"})},"edit")}),(0,t.jsxs)("div",{className:"w-full z-10",children:[(0,t.jsx)("div",{className:"flex items-start",children:r}),(0,t.jsx)("p",{className:"text-muted-foreground",children:n})]}),(0,t.jsx)(f.Button,{rounded:!0,variant:"filled",className:"text-sm font-semibold z-10 bg-white hover:bg-gray-100",children:o("Upgrade","Upgrade")})]})})}let ex=ef.z.object({key:ef.z.string()})},850421,e=>{"use strict";e.s(["ImageEditorDialog",()=>ed],850421);var t=e.i(247276),i=e.i(246429),a=e.i(637797),s=e.i(420986),r=e.i(72290),n=e.i(497985);e.i(685846);var o=e.i(376098),l=e.i(90476),d=e.i(12465);let c=(0,e.i(111041).default)("FlipHorizontal",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3",key:"1i73f7"}],["path",{d:"M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3",key:"saxlbk"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 2v2",key:"tus03m"}]]);var u=e.i(443696),p=e.i(889963),m=e.i(122088),g=e.i(969736),h=e.i(486492),f=e.i(133735),v=e.i(555309),y=e.i(421593);e.i(18545);var x=e.i(116212),b=e.i(723008);let I=e=>{let{hasImage:a,prompt:s,onParentPeek:r,focusedImageUrl:I,parentImageUrl:S,isStreaming:j,onRegenerate:k,onClose:_}=e,{t:C}=(0,x.useTranslation)("base"),[w,N]=(0,y.useState)(!1),[E,P]=(0,y.useState)(void 0),[R,M]=(0,y.useState)(!1),A=(0,m.useMobileUa)(),L=(0,i.useChatPageStore)(e=>e.conversationId),U=(0,i.useChatPageStore)(e=>e.lastMessageId),{editImagePresets:T}=(0,p.useEditImagePresets)(),z=(0,y.useMemo)(()=>{if(!E)return;let e=T.flatMap(e=>e.presets).find(e=>e.prompt===E);return e?(0,t.jsxs)(t.Fragment,{children:[e.icon&&y.default.createElement(e.icon,{size:20,className:"text-secondary flex-shrink-0"}),(0,t.jsx)("h1",{className:"text-lg font-semibold truncate",children:e.label})]}):(0,t.jsx)("h1",{className:"text-lg font-semibold truncate",children:E})},[E,T]),D=(0,y.useCallback)(()=>{!R&&I&&(M(!0),(0,g.downloadImage)(I,null==I?void 0:I.split("/").pop()).catch((0,h.createLogError)("image-editor:handleDownload")).finally(()=>M(!1)))},[I,R]);return(0,y.useEffect)(()=>{s&&E!==s&&P(s)},[s,E]),(0,y.useEffect)(()=>{S&&!w&&N(!0)},[S,w]),(0,t.jsx)("header",{className:"flex justify-between w-full items-center min-h-10 gap-3  relative z-30 flex-shrink-0",children:(0,t.jsxs)(f.AnimatePresence,{mode:"popLayout",children:[E&&(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},className:"flex items-center gap-2 w-full overflow-hidden min-w-0",children:z},E),(0,t.jsxs)("div",{className:"flex gap-1 ms-auto shrink-0",children:[(0,t.jsxs)(t.Fragment,{children:[w&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},children:(0,t.jsx)(u.ButtonWithTooltip,{variant:"secondary",shape:"circle",size:"md","aria-label":C("Compare","Compare"),tooltipContent:C("Compare","Compare"),tooltipContentProps:{side:"bottom"},onMouseDown:()=>r(!0),onMouseUp:()=>r(!1),onMouseLeave:()=>r(!1),onTouchStart:e=>{e.preventDefault(),e.stopPropagation(),r(!0)},onTouchEnd:e=>{e.preventDefault(),e.stopPropagation(),r(!1)},onContextMenu:e=>{e.preventDefault(),e.stopPropagation()},onContextMenuCapture:e=>{e.preventDefault(),e.stopPropagation()},asChild:!0,disabled:j||!S,children:(0,t.jsx)(v.motion.button,{whileTap:!j&&S?{scale:.9}:void 0,children:(0,t.jsx)(c,{className:"size-5"})})})},"compare"),(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},children:(0,t.jsx)(u.ButtonWithTooltip,{size:"md",variant:"tertiary",shape:"circle",className:"text-fg-primary","aria-label":C("Regenerate","Regenerate"),tooltipContent:C("Regenerate","Regenerate"),tooltipContentProps:{side:"bottom"},asChild:!0,disabled:j||!S,onClick:k,children:(0,t.jsx)(v.motion.button,{whileTap:!j&&S?{scale:.9}:void 0,children:(0,t.jsx)(l.RefreshCwIcon,{className:"size-5"})})})},"regenerate")]}),a&&(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},children:(0,t.jsx)(u.ButtonWithTooltip,{variant:"tertiary",size:"md",shape:"circle",className:"text-fg-primary","aria-label":C("Download Image","Download Image"),tooltipContent:C("Download Image","Download Image"),tooltipContentProps:{side:"bottom"},disabled:j||!I||R,onClick:D,children:R?(0,t.jsx)(b.Spinner,{size:"xs"}):(0,t.jsx)(o.DownloadIcon,{className:"size-5"})})},"download"),L&&U&&(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},children:(0,t.jsx)(n.ShareButton,{variant:"tertiary",size:"md",shape:"pill",className:"text-fg-primary",showLabel:!0,conversationId:L,responseId:U,iconProps:{size:20}})},"share")]}),A?(0,t.jsx)(u.Button,{"aria-label":C("Close Image Editor","Close Image Editor"),variant:"secondary",size:"md",shape:"circle",onClick:_,children:(0,t.jsx)(d.XIcon,{size:20})}):(0,t.jsx)(u.ButtonWithTooltip,{"aria-label":C("Close Image Editor","Close Image Editor"),tooltipContent:C("Close Image Editor","Close Image Editor"),tooltipContentProps:{side:"bottom"},variant:"secondary",size:"md",shape:"circle",onClick:_,children:(0,t.jsx)(d.XIcon,{size:20})})]})]})})};var S=e.i(448888),j=e.i(211959);let k=e=>{let{images:i,focusedOption:a,isStreaming:s,onSelect:r}=e;return(0,t.jsx)(v.motion.aside,{className:"lg:fixed top-0 inset-0 lg:top-0 lg:right-0 lg:left-auto flex lg:flex-col items-center justify-center lg:h-full gap-4 pb-3 lg:p-6 pointer-events-none z-30",variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",children:(0,t.jsx)(f.AnimatePresence,{mode:"popLayout",children:i.map((e,i)=>(0,t.jsx)(v.motion.button,{className:(0,j.cn)("size-16 sm:size-20 relative rounded-xl border bg-background p-1 pointer-events-auto",{"ring-primary ring-2":i===a}),onClick:()=>r(i),whileTap:i!==a?{scale:.95}:{},variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",children:(0,t.jsx)("div",{className:"relative h-full w-full overflow-hidden rounded-lg",children:(0,t.jsx)("figure",{className:"absolute -translate-x-1/2 left-1/2 h-full aspect-[4/3]",children:(0,t.jsx)(S.GrokImage,{isModerated:e.isModerated,status:s?"streaming":"finished",iconSize:24,intermediateResults:s?e.progressMap:[{progress:1,imageUrl:e.url}]})})})},e.id))})},"image-editor-option-nav")};var _=e.i(560831),C=e.i(389),w=e.i(159422),N=e.i(633918),E=e.i(654917);let P=e=>{let{className:a,hasImage:s,inputValue:r,isStreaming:n,onInputValueChange:o,onSend:l,onAbort:d}=e,{t:c}=(0,x.useTranslation)("base"),u=(0,i.useChatPageStore)(N.prop("lastMessageId")),p=(0,i.useChatPageStore)(N.prop("streamedMessageId")),m=(0,w.useResponseStore)(N.prop("byId")),g=(0,y.useRef)(null),h=(0,y.useRef)(null),[f,b]=(0,y.useState)(!1),I=(0,y.useMemo)(()=>n||!s,[n,s]),S=(0,y.useMemo)(()=>!f&&!n&&s&&!!r.trim(),[f,s,r,n]),k=(0,y.useCallback)(async e=>{var t;e.preventDefault(),!I&&r.trim()&&(b(!0),await (null==(t=l(r))?void 0:t.finally(()=>{var e;null==(e=h.current)||e.focus(),b(!1)})))},[l,I,r]),P=(0,y.useMemo)(()=>{let e=p?m[p]:void 0;if((null==e?void 0:e.parentResponseId)===u)return e},[p,m,u]),R=(0,y.useMemo)(()=>{if(n)return(null==P?void 0:P.state)||"closed"},[n,P]),M=(0,y.useCallback)(e=>{if(e.stopPropagation(),"Enter"===e.key&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey&&!e.nativeEvent.isComposing){var t;e.preventDefault(),null==(t=g.current)||t.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))}},[]);return(0,t.jsxs)("form",{className:(0,j.cn)("w-full rounded-[32px] p-3 bg-input-background shadow shadow-input-border/10 flex gap-2 pl-5 items-end ring-1 ring-input-border ring-inset",a),onSubmit:k,ref:g,children:[(0,t.jsx)(E.default,{ref:h,className:(0,j.cn)("w-full @[480px]/input:px-3 bg-transparent focus:outline-none text-primary align-bottom resize-none pb-1.5",n&&"animate-pulse"),onChange:e=>o(e.target.value),value:r,placeholder:s?n?c("Editing image","Editing image"):c("Describe your edits","Describe your edits"):c("Upload an image to begin","Upload an image to begin"),minRows:1,onKeyDown:M,autoFocus:!0,disabled:I,name:"query",maxRows:5}),(0,t.jsx)("div",{className:(0,j.cn)("ms-auto flex flex-row items-end gap-1"),children:n&&("streaming"===R||"reconnecting"===R)?(0,t.jsx)(v.motion.button,{whileTap:{scale:.95},initial:{scale:.95,opacity:1},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:.5,transition:{duration:.2}},className:(0,j.cn)("group flex flex-col justify-center rounded-full focus:outline-none focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"),onClick:e=>{e.preventDefault(),d().catch(console.error)},children:(0,t.jsx)("div",{className:(0,j.cn)("h-9","aspect-square flex flex-col items-center justify-center rounded-full","rounded-full ring-1 ring-inset","bg-primary text-background ring-button-outline-border"),children:(0,t.jsx)(C.Square,{size:20})})}):(0,t.jsx)(v.motion.button,{initial:{opacity:.5},animate:{opacity:1,transition:{duration:.1}},whileHover:s?{scale:1.1}:void 0,whileTap:s?{scale:.95}:void 0,className:(0,j.cn)("group flex flex-col justify-center rounded-full focus:outline-none focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"),type:"submit","aria-label":c("Submit","Submit"),disabled:!S,children:(0,t.jsx)("div",{className:(0,j.cn)("h-9 relative","aspect-square flex flex-col items-center justify-center","rounded-full ring-1 ring-inset duration-100","before:absolute before:inset-0 before:rounded-full before:bg-primary before:ring-0 before:transition-all duration-500",S?"bg-primary text-background ring-transparent before: before:[clip-path:circle(50%_at_50%_50%)]":"bg-button-secondary text-secondary before:[clip-path:circle(0%_at_50%_50%)] ring-0"),children:(0,t.jsx)(_.ArrowUpIcon,{size:20,className:"relative"})})})})]})};var R=e.i(383274),M=e.i(50636),A=e.i(592766),L=e.i(511765),U=e.i(920958),T=e.i(259473),z=e.i(688578),D=e.i(536459),F=e.i(470753),O=e.i(533431),B=e.i(715127);let G=e=>{let{isEditingCurrentImage:i,setIsPeekingParent:a,isPeekingParent:s,focusedImage:r,parentImageUrl:n,generatedImageHeight:o,generatedImageWidth:l,isFinalImageLoaded:d,setIsFinalImageLoaded:c,isParentImageLoaded:u,setIsParentImageLoaded:p}=e,[m,g]=(0,y.useState)([]),[h,x]=(0,y.useState)(!1),[b,I]=(0,y.useState)(!1),[k,_]=(0,y.useState)(!0),C=(0,y.useMemo)(()=>!!(o&&l),[o,l]),w=(0,y.useMemo)(()=>o&&l?l/o:4/3,[o,l]);return(0,y.useEffect)(()=>{(i||!k)&&(null==r?void 0:r.progressMap)?g(r.progressMap):!i&&(null==r?void 0:r.url)?g(e=>[...e,{progress:1,imageUrl:r.url||""}]):g([])},[i,null==r?void 0:r.url,null==r?void 0:r.progressMap,k]),(0,y.useEffect)(()=>{if(!h)return void a(!1);let e=setTimeout(()=>{h&&!b&&a(!0)},100);return()=>clearTimeout(e)},[h,b,a]),(0,y.useEffect)(()=>{i&&k&&_(!1),i||!d||k||_(!0)},[i,d,k]),(0,t.jsx)("figure",{className:(0,j.cn)("relative group/image w-full max-w-5xl 2xl:max-w-6xl overflow-hidden rounded-lg select-none",!i&&n&&(s?"cursor-grabbing":"cursor-grab")),onDragStart:e=>{if(s)return void e.preventDefault();I(!0)},onDragEnd:()=>{I(!1),x(!1)},onMouseDown:e=>{0===e.button&&x(!0)},onMouseUp:()=>x(!1),onTouchStart:e=>{e.preventDefault(),e.stopPropagation(),x(!0)},onTouchEnd:e=>{e.preventDefault(),x(!1)},onMouseLeave:()=>{x(!1),I(!1)},children:(0,t.jsx)(f.AnimatePresence,{mode:"wait",children:i||!k?C?(0,t.jsx)(v.motion.div,{initial:{opacity:0,filter:"blur(4px)"},animate:{opacity:1,filter:"blur(0px)"},exit:{opacity:1,filter:"blur(0px)",transition:{delay:1.5}},transition:{ease:"easeInOut"},className:"h-full mx-auto",style:{aspectRatio:w,maxHeight:o},children:(0,t.jsx)(S.GrokImage,{status:"streaming",intermediateResults:m,isModerated:null==r?void 0:r.isModerated,aspectRatio:w})},"streaming-image"):(0,t.jsx)(H,{}):(0,t.jsxs)("div",{className:"flex relative items-center justify-center w-full h-full",children:[(null==r?void 0:r.url)&&(0,t.jsxs)(t.Fragment,{children:[!d&&(0,t.jsx)(H,{className:"absolute z-20 inset-0"}),(0,t.jsx)(v.motion.img,{variants:{hidden:{opacity:0,filter:"blur(4px)"},visible:{opacity:1,filter:"blur(0px)"}},exit:"hidden",animate:n&&s||!d?"hidden":"visible",transition:{ease:"easeInOut"},src:r.url,alt:"active-image",className:"max-h-full aspect-auto rounded-lg",onLoad:()=>c(!0)},"finished-image")]}),(0,t.jsx)(f.AnimatePresence,{children:!i&&n&&s&&(0,t.jsxs)(v.motion.div,{variants:{hidden:{opacity:0,filter:"blur(4px)"},visible:{opacity:1,filter:"blur(0px)"}},initial:"hidden",exit:"hidden",animate:"visible",transition:{ease:"easeInOut"},className:"absolute z-10 w-full h-full flex items-center overflow-hidden",children:[!u&&(0,t.jsx)(H,{className:"absolute z-20 inset-0"}),(0,t.jsx)(v.motion.img,{variants:{hidden:{opacity:0,filter:"blur(4px)"},visible:{opacity:1,filter:"blur(0px)"}},animate:u?"visible":"hidden",src:n,alt:"parent-image",className:"max-h-full aspect-auto mx-auto rounded-lg",onLoad:()=>p(!0)},"parent-image")]},"parent-image-container")})]})})})},H=e=>{let{className:i}=e;return(0,t.jsx)(v.motion.div,{initial:{opacity:0,filter:"blur(4px)"},animate:{opacity:1,filter:"blur(0px)"},transition:{ease:"easeInOut"},className:(0,j.cn)("h-full w-full flex items-center justify-center animate-pulse-lg",i),children:(0,t.jsx)(B.ImageIcon,{size:60,strokeWidth:1.3,className:"opacity-30 rotate-[-10deg]"})},"loader")};var W=e.i(328788),Y=e.i(165475),K=e.i(908793),q=e.i(431533),V=e.i(763578),X=e.i(659065),Q=e.i(879085),Z=e.i(667965);let $=e=>{let{hasImage:i,onSend:a,isStreaming:s}=e,{editImagePresets:r}=(0,p.useEditImagePresets)(),n=(0,W.useMobileSize)(),{t:o}=(0,x.useTranslation)("image-editor"),[l,d]=(0,y.useState)(null),[c,u]=(0,y.useState)(null),m=(0,y.useMemo)(()=>s||!i,[s,i]),g=(0,y.useCallback)(e=>{d(t=>t===e?null:e)},[d]),h=(0,y.useCallback)(e=>{if(!s)return d(null),a(e.prompt,e.presetId)},[s,a]),f=(0,y.useCallback)(()=>{if(!s)return D.useImageEditorStore.getState().close(),d(null),a("Make video","make-video")},[s,a]),b=(0,y.useCallback)(e=>{let t=document.querySelector('[data-preset-id="'.concat(e,'"]'));if(!t)return{};let i=t.getBoundingClientRect();return i.right+12+200>window.innerWidth?{left:i.left-200-12,top:i.top+(i.height-150)/2}:{left:i.right+12,top:i.top+(i.height-150)/2}},[]);return(0,y.useEffect)(()=>{if(!l||n)return void u(null);let e=()=>{let e=document.body.querySelector("[data-highlighted][data-preset-id]"),t=(null==e?void 0:e.getAttribute("data-preset-id"))||null;t&&u(t)};e();let t=new MutationObserver(e);return t.observe(document.body,{attributes:!0,attributeFilter:["data-highlighted"],subtree:!0}),()=>{t.disconnect()}},[l,n]),(0,t.jsxs)("div",{className:"@container flex w-full xs:justify-center justify-start items-center overflow-x-auto xs:overflow-visible gap-2 xs:gap-3 relative z-30 no-scrollbar",children:[(0,t.jsx)(v.motion.div,{variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},initial:"hidden",animate:"visible",transition:{duration:.15,ease:"easeInOut"},className:"bg-surface-base rounded-full",children:(0,t.jsxs)(V.Button,{variant:"filledSecondary",size:"md",className:"flex items-center justify-start py-3 border border-border-l1 rounded-3xl hover:text-fg-primary",onClick:f,children:[(0,t.jsx)(Z.Play,{fill:"currentColor",strokeWidth:0,className:"size-4"}),o("button.make-video","Make video")]},"make-video")},"make-video-animation"),r.map((e,i)=>(0,t.jsx)(v.motion.div,{variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},initial:"hidden",animate:"visible",transition:{duration:.15,ease:"easeInOut",delay:.06*(i+1)},className:"bg-surface-base rounded-full",children:n?(0,t.jsxs)(X.Drawer,{open:e.category===l,onOpenChange:t=>{t?d(e.category):d(null)},children:[(0,t.jsx)(X.DrawerTrigger,{disabled:m,asChild:!0,children:(0,t.jsx)(J,{category:e,disabled:m})}),(0,t.jsxs)(X.DrawerContent,{className:"max-h-[90dvh]",children:[(0,t.jsx)(X.DrawerHeader,{children:(0,t.jsxs)(X.DrawerTitle,{className:"flex items-center justify-center gap-2",children:[e.icon&&y.default.createElement(e.icon,{size:20,className:"text-secondary flex-shrink-0"}),e.label]})}),(0,t.jsx)("div",{className:"p-2 space-y-2 overflow-auto",children:e.presets.map(e=>(0,t.jsxs)(V.Button,{variant:"ghost",size:"lg",className:"w-full flex items-center justify-start gap-3 h-auto py-3",onClick:()=>h(e),children:[e.icon&&y.default.createElement(e.icon,{size:18,className:"text-secondary flex-shrink-0"}),(0,t.jsx)("span",{children:e.label})]},e.presetId))})]})]}):(0,t.jsxs)(Q.DropdownMenu,{open:e.category===l,onOpenChange:()=>g(e.category),children:[(0,t.jsx)(Q.DropdownMenuTrigger,{disabled:m,asChild:!0,children:(0,t.jsx)(J,{category:e,disabled:m})}),(0,t.jsx)(Q.DropdownMenuContent,{hideWhenDetached:!0,side:"top",sideOffset:8,className:"min-w-60 space-y-0.5 z-[100000]",onMouseLeave:()=>{u(null)},onWheel:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),children:e.presets.map(i=>(0,t.jsxs)(Q.DropdownMenuItem,{"data-preset-id":i.presetId,className:"flex items-center gap-2",onSelect:()=>h(i),children:[i.icon&&y.default.createElement(i.icon,{size:16,className:"text-secondary flex-shrink-0"}),i.label,c===i.presetId&&(0,K.createPortal)((0,t.jsxs)(v.motion.div,{layoutId:"preset-preview",className:"fixed w-[200px] h-[150px] bg-surface-l4 border border-border-l1 rounded-2xl shadow-lg z-50 pointer-events-none flex items-center justify-center p-1.5",style:b(i.presetId),children:[(0,t.jsx)(q.ImageLoader,{className:"absolute inset-0"}),i.previewUrl&&(0,t.jsx)(Y.default,{src:i.previewUrl,alt:i.presetId,width:200,height:150,priority:!n&&l===e.category,className:"w-full h-full object-cover rounded-xl relative z-10"})]}),document.body)]},i.presetId))})]})},e.category))]})},J=y.default.forwardRef((e,i)=>{let{category:a,disabled:s,...r}=e;return(0,t.jsxs)(V.Button,{ref:i,size:"md",variant:"filledSecondary",rounded:!0,className:(0,j.cn)(!s&&"*:hover:text-primary transition-all"),disabled:s,...r,children:[a.icon&&y.default.createElement(a.icon,{size:16,className:"flex-shrink-0 text-secondary transition-colors"}),(0,t.jsx)("span",{children:a.label})]})});var ee=e.i(949033),et=e.i(351958),ei=e.i(110098),ea=e.i(218946);let es=e=>{let{onUploadImage:a}=e,{t:s}=(0,x.useTranslation)("base"),n=(0,z.useFileStore)(N.prop("fetchUploadFile")),o=(0,z.useFileStore)(N.prop("removeByConversationId")),l=(0,i.useChatPageStore)(N.prop("conversationId")),{ASSET_SERVER_URL:d}=(0,r.useEnvironment)(),c=(0,ea.useRequestErrorToastFn)(),u=(0,y.useRef)(null),[p,m]=(0,y.useState)(!1),[g,h]=(0,y.useState)(!1),I=(0,y.useCallback)(()=>{var e;null==(e=u.current)||e.click()},[]),S=(0,y.useCallback)(async e=>{let t;if(1!==e.length||!e[0])return void O.toast.error(s("Only a single image file is allowed","Only a single image file is allowed"));if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(e[0].type))return void O.toast.error(s("Only image files are allowed","Only image files are allowed"));h(!0);try{let i=n(e[0],l||"no_conversation_id");t=await i.metadataPromise}catch(e){c("image-editor-upload:uploadFile",e)}t instanceof Error&&c("image-editor-upload:uploadFile",t,s("Failed to upload file","Failed to upload file")),h(!1),o(l||"no_conversation_id"),!t||t instanceof Error||a({url:(0,T.getAssetUrl)(d,t.fileUri),metadata:t})},[s,n,l,a,d,o,c]),j=(0,y.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),g||m(!0)},[g]),k=(0,y.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),m(!1)},[]),_=(0,y.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),m(!1),!g)return S(Array.from(e.dataTransfer.files))},[S,g]),C=(0,y.useCallback)(e=>{if(e.target.files)return S(Array.from(e.target.files)).finally(()=>{u.current&&(u.current.value="")})},[S]);return(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},onDragOver:j,onDragLeave:k,onDrop:_,className:"border resize transition-colors w-full max-w-7xl h-full flex justify-center items-center border-border-l1 rounded-2xl p-8 mb-3 text-center ".concat(p&&!g&&"bg-surface-l1 border-border-l1"),children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"p-4 rounded-full text-fg-secondary transition-colors bg-surface-l1",children:(0,t.jsx)(f.AnimatePresence,{mode:"popLayout",children:p&&!g?(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,t.jsx)(ee.Files,{className:"size-6"})},"files"):(0,t.jsx)(v.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,t.jsx)(et.ImagePlusIcon,{className:"size-6"})},"image-plus")})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-primary",children:s("Upload an image to begin","Upload an image to begin")}),(0,t.jsx)(f.AnimatePresence,{mode:"popLayout",children:g?(0,t.jsx)(v.motion.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-sm text-fg-secondary",children:s("Uploading image","Uploading image")},"uploading"):p?(0,t.jsx)(v.motion.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-sm text-fg-secondary",children:s("Drop image here","Drop image here")},"dragging"):(0,t.jsx)(v.motion.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-sm text-fg-secondary",children:s("Drag and drop to upload","Drag and drop to upload")},"not-dragging")})]}),(0,t.jsx)("div",{className:"flex gap-3",children:(0,t.jsxs)(V.Button,{variant:"outline",className:"text-fg-primary hover:bg-button-ghost-hover rounded-2xl transition-all py-2.5 px-4 h-auto *:hover:text-fg-primary *:hover:transition-colors",disabled:g,autoFocus:!0,onClick:I,children:[g?(0,t.jsx)(b.Spinner,{size:"xxs"}):(0,t.jsx)(ei.Upload,{className:"size-4 text-fg-secondary"}),s("Upload","Upload")]})}),(0,t.jsx)("input",{ref:u,className:"hidden",type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:C,multiple:!1,"data-testid":"file-input"})]})})},er=()=>{let{ASSET_SERVER_URL:e}=(0,r.useEnvironment)(),n=(0,M.useFeatureFlags)(),o=(0,U.useLogEvent)(),{t:l}=(0,x.useTranslation)("base"),d=(0,R.useMaybeRefreshAnonSession)(),{handleSendStart:c,timeToSendStart:u,consumeTimeToSendMs:p}=(0,A.useImageEditingMetrics)(),[m,g]=(0,L.useLocalStorage)("image-editor-first-open",!0),v=(0,D.useImageEditorStore)(N.prop("isOpen")),b=(0,D.useImageEditorStore)(N.prop("currentImage")),S=(0,D.useImageEditorStore)(N.prop("setImage")),j=(0,i.useChatPageStore)(N.prop("conversationId")),_=(0,i.useChatPageStore)(N.prop("streamedMessageId")),C=(0,i.useChatPageStore)(N.prop("lastMessageId")),E=(0,w.useResponseStore)(e=>e.byId[null!=_?_:""]),B=(0,w.useResponseStore)(N.prop("byId")),H=(0,y.useMemo)(()=>{var e;return null!=(e=w.useResponseStore.getState().byConversationId[null!=j?j:""])?e:[]},[j]),W=(0,s.useGenImagineVideoFromMediaUrl)(),[Y,K]=(0,y.useState)(""),[q,V]=(0,y.useState)(!1),[X,Q]=(0,y.useState)(null),[Z,J]=(0,y.useState)(!1),[ee,et]=(0,y.useState)(!1),[ei,ea]=(0,y.useState)(!1),[er,en]=(0,y.useState)(!1),[eo,el]=(0,y.useState)(!1),ed=(0,y.useMemo)(()=>!!b,[b]),ec=(0,y.useMemo)(()=>!!(b&&"key"in b),[b]),eu=(0,y.useMemo)(()=>!!(b&&"metadata"in b),[b]),ep=(0,y.useMemo)(()=>{if(ec){if(q)return!X&&E&&Q(E.responseId),E||B[null!=X?X:""];let e=H.filter(e=>e.streamingImageById).find(e=>{for(let t in e.streamingImageById){let i=e.streamingImageById[t];if(!i)continue;let a=i[100];if((null==a?void 0:a.imageUrl)===(null==b?void 0:b.url))return!0}});return e||(null==H?void 0:H.find(e=>{var t,i;return null==(t=e.generatedImageUrls)?void 0:t.includes(null!=(i=b.assetKey)?i:"")}))}},[b,H,ec,q,E,X,B]),em=(0,y.useMemo)(()=>(null==ep?void 0:ep.parentResponseId)?B[ep.parentResponseId]:void 0,[ep,B]),eg=(0,y.useMemo)(()=>em?(0,T.getAssetUrl)(e,em.imageEditUri):void 0,[em,e]),eh=(0,y.useMemo)(()=>{if(eu){var t,i;return[{id:null!=(t=b.metadata.fileUri)?t:"",url:null!=(i=(0,T.getAssetUrl)(e,b.metadata.fileUri))?i:"",isModerated:!1,progressMap:void 0}]}return ec?ep?q&&ep.streamingImageById?Object.entries(ep.streamingImageById).map(t=>{var i;let[a,s]=t,r=Object.keys(s).map(Number),n=s[Math.max(...r)];return{id:a,url:null!=(i=(0,T.getAssetUrl)(e,null==n?void 0:n.imageUrl))?i:"",isModerated:!1,progressMap:r.map(t=>{var i,a;return{progress:t/100,imageUrl:null!=(a=(0,T.getAssetUrl)(e,null==(i=s[t])?void 0:i.imageUrl))?a:""}})}}):ep.generatedImageUrls?ep.generatedImageUrls.map(t=>{var i,a;let s=null!=(a=Object.values(null!=(i=ep.streamingImageById)?i:{})[0])?a:{},r=Object.keys(s).map(Number);return{id:t,url:(0,T.getAssetUrl)(e,t),isModerated:!1,progressMap:r.length>0?r.map(t=>{var i,a;return{progress:t/100,imageUrl:null!=(a=(0,T.getAssetUrl)(e,null==(i=s[t])?void 0:i.imageUrl))?a:""}}):void 0}}):[]:[]:[]},[b,ep,ec,q,e,eu]),ef=(0,y.useMemo)(()=>eh.length>1?eh.find(e=>e.id===(null==b?void 0:b.key)||e.id===(null==b?void 0:b.assetKey)):eh[0],[eh,b]),ev=(0,y.useMemo)(()=>(0,t.jsx)(G,{isEditingCurrentImage:q,focusedImage:ef,parentImageUrl:er?void 0:eg,isPeekingParent:Z,setIsPeekingParent:J,generatedImageWidth:null==ep?void 0:ep.generatedImageWidth,generatedImageHeight:null==ep?void 0:ep.generatedImageHeight,isParentImageLoaded:ei,isFinalImageLoaded:eo,setIsFinalImageLoaded:el,setIsParentImageLoaded:ea}),[q,ef,Z,eg,null==ep?void 0:ep.generatedImageWidth,null==ep?void 0:ep.generatedImageHeight,ei,eo,er]),ey=(0,y.useCallback)(()=>{(null==ef?void 0:ef.url)&&W(ef.url).catch(e=>{(0,h.logError)("image-editor:handleMakeVideo",e)})},[null==ef?void 0:ef.url,W]),ex=(0,y.useCallback)(e=>{e&&S(e)},[S]),eb=(0,y.useCallback)(e=>{let t=eh[e];t&&(q&&S({key:t.id}),S({key:t.id,assetKey:t.id,url:t.url,isModerated:t.isModerated,progress:(null==t?void 0:t.progressMap)?Math.max(...Object.keys(t.progressMap).map(Number)):1}))},[eh,q,S]),eI=(0,y.useCallback)(async e=>(et(!0),e().finally(()=>{et(!1)})),[]),eS=(0,a.useHandleAbort)("image-workbench:handleAbort",eI),ej=(0,y.useCallback)(async(e,t)=>{if(!e.trim()||!(null==b?void 0:b.url))throw Error("No message or image");let a=i.useChatPageStore.getState(),s=F.useSettingsStore.getState(),r=w.useResponseStore.getState(),o=z.useFileStore.getState(),l=t.replace(/^https?:\/\/[^/]+\/?/,"");K(""),o.removeByConversationId(a.conversationId||"no_conversation_id"),o.removeAttachByConversationId(a.conversationId||"no_conversation_id"),await d();let c=a.lastMessageId?r.byId[a.lastMessageId]:void 0;if(a.lastMessageId&&!c)throw Error("Last message is missing");if((null==c?void 0:c.sender)==="human")throw Error("Last message is human");"none"!==a.reasoningMode&&a.setReasoningMode("none");let u={message:e,toolOverrides:{imageGen:!0},imageEditUri:l,enableRetries:!0},p=eu&&b.metadata.fileMetadataId&&!(null==em?void 0:em.message)?[b.metadata.fileMetadataId]:[];if(eu)return a.conversationId?a.sendResponse({...u,parentResponseId:a.lastMessageId,conversationId:a.conversationId,fileAttachmentIds:p,setOpimisticUserResponse:!0,setUserResponse:!0,ff:n}):a.establishNewConversation({...u,fileAttachmentIds:[b.metadata.fileMetadataId],temporary:s.isIncognito,ff:n});if(!a.conversationId)throw Error("No conversation id");return a.sendResponse({...u,parentResponseId:a.lastMessageId,conversationId:a.conversationId,fileAttachmentIds:p,setOpimisticUserResponse:!0,setUserResponse:!0,ff:n})},[b,d,eu,em,n]),ek=(0,y.useCallback)(async(e,t)=>{let a=i.useChatPageStore.getState(),s=w.useResponseStore.getState(),r=a.streamedMessageId?s.byId[a.streamedMessageId]:void 0;return["streaming","optimistic","reconnecting"].includes((null==r?void 0:r.state)||"closed")&&await eS(),V(!0),ej(e,t).catch(()=>{D.useImageEditorStore.getState().close()})},[ej,eS]),e_=(0,y.useCallback)(async(e,t)=>{if(e.trim()&&(null==ef?void 0:ef.url))return(o("edit_image_start",(0,A.formatImageEditUri)(ef.url),{queryType:t?"preset":"manual",location:"image-editor",presetId:t||"",message:e,messageLength:String(e.length),timeToSendMs:String(p())}),"make-video"===t)?ey():ek(e,ef.url).catch(e=>{(0,h.logError)("image-viewer:ImageEditor:handleEditCurrentImage",e)})},[ek,ef,o,p,ey]),eC=(0,y.useCallback)(()=>{if((null==em?void 0:em.message)&&eg)return o("edit_image_start",(0,A.formatImageEditUri)(eg),{queryType:"regenerate",location:"image-editor",presetId:"",message:null==em?void 0:em.message,messageLength:String(null==em?void 0:em.message),timeToSendMs:String(p())}),ek(em.message,eg).catch(e=>{(0,h.logError)("image-viewer:ImageEditor:handleRegenerate",e)})},[em,eg,ek,o,p]);(0,y.useEffect)(()=>{q&&eh.length&&eh[0]&&!eh.find(e=>e.id===b.key)&&S({key:eh[0].id})},[eh,q,b,S]),(0,y.useEffect)(()=>{let t=D.useImageEditorStore.getState();if(q&&E&&"error"===E.state)return t.close();if(q&&X&&E&&"closed"===E.state){var i,a,s,r;if(V(!1),Q(null),!C)return t.close();let n=B[C];if(!n)return t.close();let l=null==(s=n.streamingImageById)||null==(a=s[null!=(r=null==b?void 0:b.key)?r:""])||null==(i=a[100])?void 0:i.imageUrl;if(!l)return t.close();o("edit_image_end",(0,A.formatImageEditUri)((null==em?void 0:em.imageEditUri)||""),{location:"image-editor"}),S({key:l,assetKey:l,url:(0,T.getAssetUrl)(e,l),progress:100,isModerated:!1})}},[em,E,q,X,C,B,e,o,S]),(0,y.useEffect)(()=>{q||ee||void 0!==u||c()},[p,c,q,ee,u]),(0,y.useEffect)(()=>{if(null==ef?void 0:ef.url){el(!1);let e=new Image;e.onload=()=>el(!0),e.src=ef.url}},[null==ef?void 0:ef.url]),(0,y.useEffect)(()=>{if(eg){ea(!1),en(!1);let e=new Image;e.onload=()=>ea(!0),e.onerror=()=>en(!0),e.src=eg}},[eg]),(0,y.useEffect)(()=>{m&&v&&(g(!1),O.toast.message((0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-fg-primary font-bold",children:l("image-editor-welcome.title","Welcome to Image Editor")}),(0,t.jsx)("p",{className:"text-fg-secondary",children:l("image-editor-welcome.description","A focused space for you to transform images with Grok to anything you can imagine.")})]}),{duration:7e3}))},[m,v,g,l]);let ew=(0,D.useImageEditorStore)(N.prop("close"));return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-between gap-6 sm:gap-20 w-full h-full",children:[(0,t.jsx)(I,{hasImage:ed,prompt:eg?null==em?void 0:em.message:void 0,focusedImageUrl:null==ef?void 0:ef.url,parentImageUrl:er?void 0:eg,isStreaming:q||ee,onParentPeek:e=>J(e),onClose:ew,onRegenerate:eC}),ed?ev:v&&(0,t.jsx)(es,{onUploadImage:ex}),(0,t.jsx)("footer",{className:"relative w-full max-w-2xl h-16 flex-shrink-0 mt-12 sm:mt-0",children:(0,t.jsxs)("div",{className:"absolute bottom-0 inset-x-0 flex flex-col gap-4",children:[(0,t.jsx)(f.AnimatePresence,{mode:"popLayout",children:ed&&eh&&eh.length>1&&(0,t.jsx)(k,{isStreaming:q||ee,images:eh,focusedOption:eh.findIndex(e=>e.id===(null==ef?void 0:ef.id))||0,onSelect:eb})}),(0,t.jsx)($,{hasImage:ed,isStreaming:q||ee,onSend:e_}),(0,t.jsx)(P,{hasImage:ed,inputValue:Y,isStreaming:q||ee,onInputValueChange:K,onSend:e_,onAbort:eS})]})})]})};var en=e.i(687712),eo=e.i(913106),el=e.i(942938);let ed=()=>{let{t:e}=(0,x.useTranslation)("base"),a=(0,U.useLogEvent)(),s=(0,D.useImageEditorStore)(N.prop("isOpen")),r=(0,D.useImageEditorStore)(N.prop("close")),n=(0,i.useChatPageStore)(N.prop("conversationId")),[o,l]=(0,y.useState)(void 0),{handleEditorOpen:d,consumeEditorTimeMs:c,editorOpenTime:u}=(0,A.useImageEditingMetrics)();return(0,y.useEffect)(()=>{s&&void 0===u?d():s||void 0===u||a("image_editor_close",void 0,{timeInEditorMs:String(c()),location:"image-editor-dialog"})},[s,d,c,a,u]),(0,y.useEffect)(()=>{n!==o&&(o&&r(),l(n))},[n,r,o]),(0,t.jsx)(eo.Dialog,{open:s,onOpenChange:e=>{e||r()},children:(0,t.jsxs)(en.DialogPortal,{children:[(0,t.jsx)(eo.DialogOverlay,{className:"fixed inset-0 z-50 bg-overlay duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,t.jsxs)(eo.DialogContent,{"aria-describedby":e("image-editor.title","Image editor"),className:(0,j.cn)("fixed z-50 inset-0 bg-background duration-200 focus:outline-none","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 p-2 lg:p-6"),onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:[(0,t.jsx)(el.VisuallyHidden,{children:(0,t.jsx)(en.DialogTitle,{children:e("image-editor.title","Image editor")})}),(0,t.jsx)(er,{})]})]})})}},315302,e=>{"use strict";e.s(["useGetConnectorsAuthUrl",()=>c],315302);var t=e.i(939042),i=(0,t.createServerReference)("6072bac29387a1d7c92c4846f6988d595213efc1ee",t.callServer,void 0,t.findSourceMapURL,"setConnectorsOAuthCookie");e.i(690654);var a=e.i(129876),s=e.i(72290);e.i(916390);var r=e.i(572848),n=e.i(134507);e.i(254854);var o=e.i(310366),l=e.i(805995);e.i(298616);var d=e.i(969286);function c(){var e;let{currentTeam:t}=(0,a.useEnterprise)(),c=(0,o.useTransport)(),u=null!=(e=null==t?void 0:t.teamId)?e:"",{user:p}=(0,r.useSession)(),{GROK_COM_URL:m}=(0,s.useEnvironment)(),{mutateAsync:g}=(0,l.useMutation)((0,n.getConnectorAuthUrlMutation)({transport:c}));return(0,d.useMutation)({mutationKey:["connectors-get-auth-url",u],mutationFn:async e=>{if(!u||!p)return null;let{authUrl:t,oauthCookie:a}=await g({connectorType:e,teamId:u,redirectUrl:"".concat(m,"/connectors-oauth-exchange-code/")});if(!t||!a)throw Error("Invalid response: missing authUrl or oauthCookie");return await i(e,a),t}})}},432286,495794,e=>{"use strict";e.s(["startOfMonth",()=>i],432286);var t=e.i(516467);function i(e,i){let a=(0,t.toDate)(e,null==i?void 0:i.in);return a.setDate(1),a.setHours(0,0,0,0),a}e.s(["addMonths",()=>s],495794);var a=e.i(487122);function s(e,i,s){let r=(0,t.toDate)(e,null==s?void 0:s.in);if(isNaN(i))return(0,a.constructFrom)((null==s?void 0:s.in)||e,NaN);if(!i)return r;let n=r.getDate(),o=(0,a.constructFrom)((null==s?void 0:s.in)||e,r.getTime());return(o.setMonth(r.getMonth()+i+1,0),n>=o.getDate())?o:(r.setFullYear(o.getFullYear(),o.getMonth(),n),r)}},295451,e=>{"use strict";e.s(["useCollectionsStore",()=>s]);var t=e.i(868275),i=e.i(564448);let a={collectionIdsByConversationId:{}},s=(0,i.createStore)(class{constructor(e,s){(0,t._)(this,"set",void 0),(0,t._)(this,"get",void 0),(0,t._)(this,"collectionIdsByConversationId",void 0),(0,t._)(this,"setCollectionIds",void 0),(0,t._)(this,"toggleCollectionId",void 0),(0,t._)(this,"getCollectionIds",void 0),(0,t._)(this,"removeCollectionIds",void 0),(0,t._)(this,"clear",void 0),this.set=e,this.get=s,this.collectionIdsByConversationId=a.collectionIdsByConversationId,this.setCollectionIds=(e,t)=>{(0,i.idsert)(this.set,"collectionIdsByConversationId")(e,t)},this.toggleCollectionId=(e,t)=>{let i=this.getCollectionIds(t),a=i.includes(e)?i.filter(t=>t!==e):[...i,e];this.setCollectionIds(a,t)},this.getCollectionIds=e=>this.get().collectionIdsByConversationId[e]||[],this.removeCollectionIds=e=>{(0,i.remove)(this.set,"collectionIdsByConversationId")(e)},this.clear=()=>{this.set(a)}}},"useCollectionsStore")}]);

//# sourceMappingURL=26a89666a3126fbd.js.map
//# debugId=88692d2a-3632-568f-bda6-6b4d23fa6301
