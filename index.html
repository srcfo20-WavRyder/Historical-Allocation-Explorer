<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Performance Comparison Tool</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
        </head>
<body>

<!-- Sticky Disclaimer Banner -->
<div style="position: sticky; top: 0; z-index: 9999; background: #856404; color: white; 
            padding: 8px; text-align: center; font-size: 12px; font-weight: 600;">
    ‚ö†Ô∏è Educational Tool Only ‚Ä¢ Past Performance ‚â† Future Results ‚Ä¢ Not Financial Advice
</div>

<div class="update-data-section" id="updateDataSection" style="text-align: center; margin: 20px 0px; padding: 20px; background: rgb(248, 249, 250); border-radius: 8px;">
            <h3 style="color: #495057; margin-bottom: 15px;">Update Tool Data</h3>
            <p style="color: #6c757d; margin-bottom: 15px;">Upload a new Excel file to update all models and data in this tool</p>
            
            <!-- Quick Navigation -->
            <div style="background: #e7f3ff; border: 2px solid #0366d6; border-radius: 8px; padding: 12px; margin-bottom: 20px; display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                <a href="#exportGitHub" style="color: #0366d6; text-decoration: none; font-weight: 600; font-size: 14px;">üì§ Jump to GitHub Export</a>
                <span style="color: #dee2e6;">|</span>
                <a href="#scenarioConfig" style="color: #0366d6; text-decoration: none; font-weight: 600; font-size: 14px;">üéØ Jump to Scenarios</a>
                <span style="color: #dee2e6;">|</span>
                <a href="#modelConfig" style="color: #0366d6; text-decoration: none; font-weight: 600; font-size: 14px;">üîß Jump to Models</a>
            </div>
            
            <!-- Date Range Inputs -->
            <div style="margin-bottom: 20px; display: flex; justify-content: center; align-items: center; gap: 15px; flex-wrap: wrap;">
                <div style="display: flex; flex-direction: column; align-items: flex-start;">
                    <label for="startDateInput" style="font-size: 14px; font-weight: 600; color: #495057; margin-bottom: 5px;">Start Date:</label>
                    <input type="date" id="startDateInput" value="2005-12-30" style="padding: 8px 12px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px;">
                </div>
                <div style="display: flex; flex-direction: column; align-items: flex-start;">
                    <label for="endDateInput" style="font-size: 14px; font-weight: 600; color: #495057; margin-bottom: 5px;">End Date:</label>
                    <input type="date" id="endDateInput" value="2025-12-31" style="padding: 8px 12px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px;">
                </div>
            </div>
            
            <input type="file" id="updateDataInput" accept=".xlsx,.xls" style="display: none;">
            <button onclick="document.getElementById('updateDataInput').click()" class="btn-primary">
                üìä Upload New Data File
            </button>
            <div id="updateStatus" style="margin-top: 15px; font-weight: bold; display: none;"></div>
            
            <!-- Default Portfolio Allocations Configuration -->
            <div style="margin-top: 30px; padding-top: 30px; border-top: 2px solid #dee2e6;">
                <h4 style="color: #495057; margin-bottom: 20px;">üìä Default Portfolio Allocations</h4>
                <p style="color: #6c757d; margin-bottom: 15px; font-size: 14px;">Define what portfolios are pre-loaded when users first open the tool</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; max-width: 1200px; margin: 0 auto;">
                    
                    <!-- Current (Current) Defaults -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border: 2px solid #e9ecef;">
                        <h5 style="color: #1565c0; margin: 0 0 15px 0; font-size: 16px; text-align: center;">
                            Current (Current) - Default Allocation
                        </h5>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row A - Model:</label>
                            <select id="default_p1_row_a_model" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 5px;">
                                <option value="">-- None --</option>
                            </select>
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row A - Allocation %:</label>
                            <input type="number" id="default_p1_row_a_alloc" min="0" max="100" value="0" 
                                   style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row B - Model:</label>
                            <select id="default_p1_row_b_model" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 5px;">
                                <option value="">-- None --</option>
                            </select>
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row B - Allocation %:</label>
                            <input type="number" id="default_p1_row_b_alloc" min="0" max="100" value="0" 
                                   style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row C - Model:</label>
                            <select id="default_p1_row_c_model" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 5px;">
                                <option value="">-- None --</option>
                            </select>
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row C - Allocation %:</label>
                            <input type="number" id="default_p1_row_c_alloc" min="0" max="100" value="0" 
                                   style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row D - Model:</label>
                            <select id="default_p1_row_d_model" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 5px;">
                                <option value="">-- None --</option>
                            </select>
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row D - Allocation %:</label>
                            <input type="number" id="default_p1_row_d_alloc" min="0" max="100" value="0" 
                                   style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px;">
                        </div>
                        
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 6px; text-align: center; margin-top: 10px;">
                            <strong style="color: #1565c0;">Total: <span id="p1_total">0</span>%</strong>
                        </div>
                    </div>
                    
                    <!-- Modeled (Modeled) Defaults -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border: 2px solid #e9ecef;">
                        <h5 style="color: #2e7d32; margin: 0 0 15px 0; font-size: 16px; text-align: center;">
                            Modeled (Modeled) - Default Allocation
                        </h5>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row A - Model:</label>
                            <select id="default_p2_row_a_model" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 5px;">
                                <option value="">-- None --</option>
                            </select>
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row A - Allocation %:</label>
                            <input type="number" id="default_p2_row_a_alloc" min="0" max="100" value="0" 
                                   style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row B - Model:</label>
                            <select id="default_p2_row_b_model" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 5px;">
                                <option value="">-- None --</option>
                            </select>
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row B - Allocation %:</label>
                            <input type="number" id="default_p2_row_b_alloc" min="0" max="100" value="0" 
                                   style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row C - Model:</label>
                            <select id="default_p2_row_c_model" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 5px;">
                                <option value="">-- None --</option>
                            </select>
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row C - Allocation %:</label>
                            <input type="number" id="default_p2_row_c_alloc" min="0" max="100" value="0" 
                                   style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row D - Model:</label>
                            <select id="default_p2_row_d_model" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 5px;">
                                <option value="">-- None --</option>
                            </select>
                            <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #495057; font-size: 13px;">Row D - Allocation %:</label>
                            <input type="number" id="default_p2_row_d_alloc" min="0" max="100" value="0" 
                                   style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px;">
                        </div>
                        
                        <div style="background: #e8f5e9; padding: 10px; border-radius: 6px; text-align: center; margin-top: 10px;">
                            <strong style="color: #2e7d32;">Total: <span id="p2_total">0</span>%</strong>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 25px;">
                    <button onclick="saveDefaultAllocations()" style="padding: 12px 32px; background: #ff9800; color: white; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 15px; box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);">
                        üíæ Save Default Allocations
                    </button>
                </div>
                <div id="defaultAllocStatus" style="margin-top: 15px; text-align: center; font-weight: bold;"></div>
            </div>
            
            <!-- Scenario Configuration (Editable in #update mode) -->
            <div id="scenarioConfig" style="margin-top: 30px; padding-top: 30px; border-top: 2px solid #dee2e6;">
                <h4 style="color: #495057; margin-bottom: 10px;">‚ö° Scenario Button Configuration</h4>
                <p style="color: #6c757d; margin-bottom: 20px; font-size: 14px;">
                    Define what the 4 scenario buttons load. Enter column numbers and percentages (leave blank for 0).
                </p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; max-width: 1200px; margin: 0 auto;">
                    
                    <!-- Scenario 1 -->
                    <div style="background: #fff3e0; padding: 20px; border-radius: 10px; border: 2px solid #ff9800;">
                        <h5 style="color: #e65100; margin: 0 0 15px 0; font-size: 14px; font-weight: 700;">
                            Scenario 1 (Top Left Button)
                        </h5>
                        
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 12px; font-weight: 600; color: #e65100;">Button Title:</label>
                            <input type="text" id="s1_title" placeholder="üõ°Ô∏è Conservative 60/40" 
                                   style="width: 100%; padding: 6px; border: 1px solid #ffb74d; border-radius: 4px; margin-top: 3px;">
                        </div>
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 12px; font-weight: 600; color: #e65100;">Description:</label>
                            <input type="text" id="s1_desc" placeholder="Traditional 60/40 vs WavRyder" 
                                   style="width: 100%; padding: 6px; border: 1px solid #ffb74d; border-radius: 4px; margin-top: 3px;">
                        </div>
                        
                        <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                            <div style="font-size: 11px; font-weight: 700; color: #1565c0; margin-bottom: 5px;">Current (Current):</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px;">
                                <input type="text" id="s1_p1_a" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s1_p1_a_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s1_p1_b" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s1_p1_b_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                            </div>
                        </div>
                        
                        <div style="background: white; padding: 10px; border-radius: 6px;">
                            <div style="font-size: 11px; font-weight: 700; color: #2e7d32; margin-bottom: 5px;">Modeled (Modeled):</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px;">
                                <input type="text" id="s1_p2_a" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s1_p2_a_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s1_p2_b" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s1_p2_b_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Scenario 2 -->
                    <div style="background: #fff3e0; padding: 20px; border-radius: 10px; border: 2px solid #ff9800;">
                        <h5 style="color: #e65100; margin: 0 0 15px 0; font-size: 14px; font-weight: 700;">
                            Scenario 2 (Top Right Button)
                        </h5>
                        
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 12px; font-weight: 600; color: #e65100;">Button Title:</label>
                            <input type="text" id="s2_title" placeholder="üöÄ 100% S&P500 Defense" 
                                   style="width: 100%; padding: 6px; border: 1px solid #ffb74d; border-radius: 4px; margin-top: 3px;">
                        </div>
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 12px; font-weight: 600; color: #e65100;">Description:</label>
                            <input type="text" id="s2_desc" placeholder="S&P500 vs WavRyder Moderate" 
                                   style="width: 100%; padding: 6px; border: 1px solid #ffb74d; border-radius: 4px; margin-top: 3px;">
                        </div>
                        
                        <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                            <div style="font-size: 11px; font-weight: 700; color: #1565c0; margin-bottom: 5px;">Current (Current):</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px;">
                                <input type="text" id="s2_p1_a" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s2_p1_a_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s2_p1_b" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s2_p1_b_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                            </div>
                        </div>
                        
                        <div style="background: white; padding: 10px; border-radius: 6px;">
                            <div style="font-size: 11px; font-weight: 700; color: #2e7d32; margin-bottom: 5px;">Modeled (Modeled):</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px;">
                                <input type="text" id="s2_p2_a" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s2_p2_a_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s2_p2_b" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s2_p2_b_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Scenario 3 -->
                    <div style="background: #fff3e0; padding: 20px; border-radius: 10px; border: 2px solid #ff9800;">
                        <h5 style="color: #e65100; margin: 0 0 15px 0; font-size: 14px; font-weight: 700;">
                            Scenario 3 (Bottom Left Button)
                        </h5>
                        
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 12px; font-weight: 600; color: #e65100;">Button Title:</label>
                            <input type="text" id="s3_title" placeholder="üìâ Balanced Growth" 
                                   style="width: 100%; padding: 6px; border: 1px solid #ffb74d; border-radius: 4px; margin-top: 3px;">
                        </div>
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 12px; font-weight: 600; color: #e65100;">Description:</label>
                            <input type="text" id="s3_desc" placeholder="Traditional vs WavRyder Aggressive" 
                                   style="width: 100%; padding: 6px; border: 1px solid #ffb74d; border-radius: 4px; margin-top: 3px;">
                        </div>
                        
                        <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                            <div style="font-size: 11px; font-weight: 700; color: #1565c0; margin-bottom: 5px;">Current (Current):</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px;">
                                <input type="text" id="s3_p1_a" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s3_p1_a_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s3_p1_b" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s3_p1_b_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                            </div>
                        </div>
                        
                        <div style="background: white; padding: 10px; border-radius: 6px;">
                            <div style="font-size: 11px; font-weight: 700; color: #2e7d32; margin-bottom: 5px;">Modeled (Modeled):</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px;">
                                <input type="text" id="s3_p2_a" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s3_p2_a_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s3_p2_b" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s3_p2_b_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Scenario 4 -->
                    <div style="background: #fff3e0; padding: 20px; border-radius: 10px; border: 2px solid #ff9800;">
                        <h5 style="color: #e65100; margin: 0 0 15px 0; font-size: 14px; font-weight: 700;">
                            Scenario 4 (Bottom Right Button)
                        </h5>
                        
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 12px; font-weight: 600; color: #e65100;">Button Title:</label>
                            <input type="text" id="s4_title" placeholder="üíº Growth Portfolio" 
                                   style="width: 100%; padding: 6px; border: 1px solid #ffb74d; border-radius: 4px; margin-top: 3px;">
                        </div>
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 12px; font-weight: 600; color: #e65100;">Description:</label>
                            <input type="text" id="s4_desc" placeholder="Custom comparison" 
                                   style="width: 100%; padding: 6px; border: 1px solid #ffb74d; border-radius: 4px; margin-top: 3px;">
                        </div>
                        
                        <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                            <div style="font-size: 11px; font-weight: 700; color: #1565c0; margin-bottom: 5px;">Current (Current):</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px;">
                                <input type="text" id="s4_p1_a" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s4_p1_a_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s4_p1_b" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s4_p1_b_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                            </div>
                        </div>
                        
                        <div style="background: white; padding: 10px; border-radius: 6px;">
                            <div style="font-size: 11px; font-weight: 700; color: #2e7d32; margin-bottom: 5px;">Modeled (Modeled):</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px;">
                                <input type="text" id="s4_p2_a" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s4_p2_a_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s4_p2_b" placeholder="Col" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                                <input type="text" id="s4_p2_b_pct" placeholder="%" style="width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px;">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="saveScenarios()" style="padding: 12px 32px; background: #ff9800; color: white; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 15px; box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);">
                        üíæ Update Scenarios
                    </button>
                </div>
                <div id="scenarioStatus" style="margin-top: 15px; text-align: center; font-weight: bold;"></div>
                <div style="margin-top: 10px; text-align: center; font-size: 13px; color: #6c757d; font-style: italic;">
                    Changes are temporary. Export HTML below to make permanent.
                </div>
            </div>
            
            <!-- Model Selection Configuration -->
            <div id="modelConfig" style="margin-top: 30px; padding-top: 30px; border-top: 2px solid #dee2e6;">
                <h4 style="color: #495057; margin-bottom: 20px;">Portfolio Model Availability Configuration</h4>
                <p style="color: #6c757d; margin-bottom: 15px; font-size: 14px;">Select which models should be available in each portfolio selector</p>
                
                <div style="max-width: 800px; margin: 0 auto; overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <thead>
                            <tr style="background: #2196f3; color: white;">
                                <th style="padding: 12px; text-align: left; font-weight: 600;">Model Name</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">Column Index</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">Portfolio 1<br>(Current)</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">Portfolio 2<br>(Modeled)</th>
                            </tr>
                        </thead>
                        <tbody id="modelConfigTable">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <button onclick="saveModelConfig()" style="margin-top: 20px; padding: 10px 24px; background: #28a745; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 14px;">
                    üíæ Update Model Configuration
                </button>
                <div id="configStatus" style="margin-top: 10px; font-weight: bold;"></div>
                <div style="margin-top: 10px; text-align: center; font-size: 13px; color: #6c757d; font-style: italic;">
                    Changes are temporary. Export HTML below to make permanent.
                </div>
            </div>
            
            <!-- Advanced Metrics Visibility Toggle -->
            <div id="advancedMetricsConfig" style="margin-top: 30px; padding-top: 30px; border-top: 2px solid #dee2e6;">
                <h4 style="color: #495057; margin-bottom: 15px;">üìä Advanced Risk Metrics Visibility</h4>
                <p style="color: #6c757d; margin-bottom: 15px; font-size: 14px;">
                    Control whether Advanced Risk Metrics are visible to end users. These metrics may be too technical for average users.
                </p>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; max-width: 600px; margin: 0 auto;">
                    <label style="display: flex; align-items: center; cursor: pointer; font-size: 15px; font-weight: 600;">
                        <input type="checkbox" id="showAdvancedMetrics" onchange="toggleAdvancedMetricsVisibility()" 
                               style="width: 20px; height: 20px; margin-right: 12px; cursor: pointer;">
                        <span>Show Advanced Risk Metrics to end users</span>
                    </label>
                    <div style="margin-top: 10px; font-size: 13px; color: #666; font-style: italic;">
                        Default: Hidden (unchecked). Change will be saved when you export HTML.
                    </div>
                </div>
                
                <div id="advancedMetricsStatus" style="margin-top: 15px; text-align: center; font-weight: bold;"></div>
            </div>
                
                <!-- Export for GitHub Section -->
                <div id="exportGitHub" style="margin-top: 40px; padding-top: 30px; border-top: 3px solid #0366d6;">
                    <h4 style="color: #0366d6; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 24px;">üì§</span>
                        Export for GitHub Deployment
                    </h4>
                    
                    <div style="background: #d1ecf1; border: 2px solid #0c5460; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                        <div style="color: #0c5460; font-size: 13px; line-height: 1.6; font-weight: 600;">
                            üìã <strong>WORKFLOW:</strong><br>
                            1. Upload your Excel file at the top (performance_data_with_config.xlsx)<br>
                            2. Verify scenarios and models loaded correctly<br>
                            3. (Optional) Make quick edits using Update buttons above<br>
                            4. Export HTML - this captures EVERYTHING from Excel<br>
                            5. Upload to GitHub
                        </div>
                    </div>
                    
                    <div style="background: #e7f3ff; border-left: 4px solid #0366d6; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
                        <div style="color: #004085; font-size: 13px; line-height: 1.6;">
                            <strong>‚ú® Excel is Your Master File</strong><br>
                            ‚Ä¢ Performance data comes from Excel<br>
                            ‚Ä¢ Scenario configurations come from Excel rows 48-51<br>
                            ‚Ä¢ Model availability comes from Excel rows 57+<br>
                            ‚Ä¢ Export captures everything and bakes it into HTML<br>
                            ‚Ä¢ No localStorage, no confusion - just Excel ‚Üí HTML ‚Üí GitHub
                        </div>
                    </div>
                    
                    <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                        <div style="color: #856404; font-size: 13px; line-height: 1.6;">
                            ‚ö†Ô∏è <strong>When others open your GitHub link:</strong><br>
                            ‚Ä¢ They see exactly what was in your Excel file<br>
                            ‚Ä¢ No Excel upload needed by them<br>
                            ‚Ä¢ Dropdowns show only the models you configured<br>
                            ‚Ä¢ Scenario buttons have your titles and allocations
                        </div>
                    </div>
                    <button onclick="showExportPreview()" style="padding: 14px 32px; background: linear-gradient(135deg, #0366d6, #0056b3); color: white; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 16px; box-shadow: 0 4px 12px rgba(3, 102, 214, 0.3); transition: all 0.3s;">
                        üì§ Export for GitHub (Preview & Download)
                    </button>
                </div>
            </div>
        </div>

        <!-- Export Preview Modal -->
        <div id="exportPreviewModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; overflow-y: auto;">
            <div style="background: white; max-width: 800px; margin: 50px auto; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); overflow: hidden;">
                <!-- Modal Header -->
                <div style="background: linear-gradient(135deg, #0366d6, #0056b3); color: white; padding: 24px 32px; display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="margin: 0; font-size: 20px; font-weight: 700;">üì§ Export Preview - What Will Be in Your GitHub HTML</h3>
                    <button onclick="closeExportPreview()" style="background: none; border: none; color: white; font-size: 28px; cursor: pointer; line-height: 1; padding: 0; width: 32px; height: 32px;">&times;</button>
                </div>
                
                <!-- Modal Body -->
                <div style="padding: 32px; max-height: 70vh; overflow-y: auto;">
                    <div style="background: #e7f3ff; border-left: 4px solid #0366d6; padding: 16px; margin-bottom: 24px; border-radius: 4px;">
                        <div style="color: #004085; font-weight: 600; margin-bottom: 8px;">‚úÖ These settings will be permanently saved in the HTML file:</div>
                        <div style="color: #004085; font-size: 13px;">Other users who open your GitHub link will see exactly this configuration.</div>
                    </div>
                    
                    <!-- Scenario Preview -->
                    <div style="margin-bottom: 28px;">
                        <h4 style="color: #495057; margin-bottom: 16px; font-size: 16px; border-bottom: 2px solid #dee2e6; padding-bottom: 8px;">
                            üéØ Scenario Buttons (4)
                        </h4>
                        <div id="scenarioPreviewContent" style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Model Config Preview -->
                    <div style="margin-bottom: 28px;">
                        <h4 style="color: #495057; margin-bottom: 16px; font-size: 16px; border-bottom: 2px solid #dee2e6; padding-bottom: 8px;">
                            üîß Model Availability
                        </h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <div style="font-weight: 600; color: #6c757d; margin-bottom: 8px; font-size: 13px;">Current Portfolio (Row 1-2):</div>
                                <div id="portfolio1PreviewContent" style="font-size: 12px; line-height: 1.8; color: #495057;">
                                    <!-- Will be populated by JavaScript -->
                                </div>
                            </div>
                            <div>
                                <div style="font-weight: 600; color: #6c757d; margin-bottom: 8px; font-size: 13px;">Modeled Portfolio (Row 3-4):</div>
                                <div id="portfolio2PreviewContent" style="font-size: 12px; line-height: 1.8; color: #495057;">
                                    <!-- Will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Warning Box -->
                    <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 16px; margin-top: 24px;">
                        <div style="color: #856404; font-size: 13px; line-height: 1.6;">
                            <strong>‚ö†Ô∏è Remember:</strong><br>
                            ‚Ä¢ This HTML file will have these as the DEFAULT settings<br>
                            ‚Ä¢ Other users can still upload their own Excel to override<br>
                            ‚Ä¢ Update and re-export whenever you want to change the defaults
                        </div>
                    </div>
                </div>
                
                <!-- Modal Footer -->
                <div style="background: #f8f9fa; padding: 20px 32px; display: flex; gap: 12px; justify-content: flex-end; border-top: 1px solid #dee2e6;">
                    <button onclick="closeExportPreview()" style="padding: 10px 24px; background: #6c757d; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                        Cancel
                    </button>
                    <button onclick="downloadForGitHub()" style="padding: 10px 32px; background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; border-radius: 6px; font-weight: 700; cursor: pointer; font-size: 15px; box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);">
                        ‚úÖ Looks Good - Download HTML
                    </button>
                </div>
            </div>
        </div>


    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;600;700&amp;display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Load performance data from external file -->
    <script>
// Date range configuration - will be updated when data is refreshed
const DATA_START_DATE = "December 30, 2005";
const DATA_END_DATE = "December 31, 2025";
const DATA_START_DATE_SHORT = "12/30/2005";
const DATA_END_DATE_SHORT = "12/31/2025";
const DATA_YEAR_RANGE = "2005-2025";
const DATA_YEARS_COUNT = 20;

// Auto-generated from performance_data.xlsx
// NOTE: "20 Year" labels in default data are sample values only.
// Actual calculations use dynamic year values based on uploaded data (see line ~4780)
const EXCEL_DATA = [
  [
    "Option",
    null,
    "A",
    "B",
    "C",
    "D",
    "E",
    "F",
    "G",
    "H",
    "I",
    "J",
    "K",
    "L",
    "M",
    "N",
    "O",
    "P",
    "Q",
    "R"
  ],
  [
    "Performance Measure",
    null,
    "60/40",
    "WavRyder QQQ",
    "WavRyder SP500",
    "Aggressive WR Adj",
    "Moderate WR Adj",
    "Conservative WR Adj",
    "Leveraged Nasdaq",
    "Leveraged S&P500",
    "WavRyder QQQ/SP500 Leveraged)",
    "QQQ (Leveraged) W/O WavRyder",
    "SP 500",
    "Bond",
    "WavRyder AGG",
    "International",
    "WavRyder VEA",
    "QQQ",
    "S&P500",
    "WavRyder SPY"
  ],
  [
    "Total Return",
    "1 year",
    0.15943797807806193,
    0.1755558345823689,
    0.1500984966064436,
    0.14446026845364224,
    0.16306143835477638,
    0.15533947507090806,
    0.3600802462787316,
    0.3600802462787316,
    0.3600802462787316,
    0.2638826792924889,
    0.21075548930533694,
    0.0743001063121318,
    0.07204148844041747,
    0.3474626822676845,
    0.23492556670435416,
    0.1840145170095442,
    0.16143345656192087,
    0.1500984966064436
  ],
  [
    "Total Return",
    "YTD",
    0.012033409943059459,
    0.17490936156735293,
    0.14946602333652814,
    0.0002859475348011564,
    0.1624218363787724,
    0.15470411963151198,
    0.3593322978175786,
    0.3593322978175786,
    0.3593322978175786,
    0.4095494272678759,
    0.017817339277334865,
    0.07363484433270728,
    0.07145194103410457,
    0.3590157170341228,
    0.23424644451301124,
    0.2265596637279068,
    0.19167417738414572,
    0.14946602333652814
  ],
  [
    "CAGR",
    "5 Year",
    0.08839290373714581,
    0.10452174579562423,
    0.09778825230799693,
    0.10246994140123711,
    0.10168211138720884,
    0.099473155483087,
    0.20583394573438207,
    0.20583394573438207,
    0.20583394573438207,
    0.20787345614101205,
    0.1454794826110346,
    -0.003341552200764264,
    0.02483725167382067,
    0.09410402157004549,
    0.052638021631999266,
    0.15507161028161898,
    0.14720198027767672,
    0.09778825230799693
  ],
  [
    "CAGR",
    "10 Year",
    0.10280793223370233,
    0.1514020320183065,
    0.12067335018460312,
    0.14472912965606533,
    0.13636857488789333,
    0.12702990217666899,
    0.36408155855902913,
    0.36408155855902913,
    0.36408155855902913,
    0.3734403360399954,
    0.1562781365939605,
    0.019912976507280744,
    0.038779274086202076,
    0.08715480173850243,
    0.08040465034534994,
    0.19544936041992722,
    0.14780635737728853,
    0.12067335018460312
  ],
  [
    "CAGR",
    "15 Year",
    0.0950789142003372,
    0.12807838607348154,
    0.10092326392916484,
    0.12089101435539074,
    0.11477927616801487,
    0.10653174331546889,
    0.3075958747086125,
    0.3075958747086125,
    0.3075958747086125,
    0.3954994701202532,
    0.14123129973937631,
    0.02400024610020135,
    0.034956859343680646,
    0.07069442459595554,
    0.0547897766452341,
    0.1864064668867551,
    0.14046367211624777,
    0.10092326392916484
  ],
  [
    "CAGR",
    "20 Year",
    0.0814670041020702,
    0.12427253755029244,
    0.0953211493896522,
    0.111765397375006,
    0.11008882126271935,
    0.10129718649640762,
    0.2783300098727388,
    0.2783300098727388,
    0.2783300098727388,
    0.3469592078853829,
    0.10914961894543973,
    0.03141720097010392,
    0.04204064362146509,
    0.05404327478725124,
    0.06076962850322465,
    0.15471284756328063,
    0.10936063754732261,
    0.0953211493896522
  ],
  [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    "$100K Investment Growth",
    "20 Year",
    478922.753025214,
    1040955.2187866488,
    617773.7768892092,
    832267.7348264777,
    807522.4136532838,
    688795.9652679005,
    13578746.773944806,
    13578746.773944806,
    13578746.773944806,
    38644604.751598254,
    793967.4290669175,
    185646.76996576786,
    227873.15702203056,
    286529.1639806508,
    325402.98622521135,
    1776151.2988027819,
    796993.9830156679,
    617773.7768892092
  ],
  [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    "Worst Annual Drawdown%",
    "20 Year",
    -0.19061453613527835,
    -0.09572172918412059,
    -0.08463731735187463,
    -0.09031353870693348,
    -0.08217694754550631,
    -0.08146880362524733,
    -0.2618634015601986,
    -0.2618634015601986,
    -0.2618634015601986,
    -0.7909001278779242,
    -0.36997611132718566,
    -0.13021651691583458,
    -0.033208122709457166,
    -0.40623204383435196,
    -0.15020561241625574,
    -0.4172716255522949,
    -0.3679500303113997,
    -0.08463731735187463
  ],
  [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    100000,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    20,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    null,
    "Year",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  [
    "Total Return",
    1,
    0.11039403783585588,
    0.14283881637958684,
    0.16423536018966356,
    0.022948335634813022,
    0.15430656346437943,
    0.16044909477256764,
    0.1588216757855454,
    0.1588216757855454,
    0.1588216757855454,
    0.1150192778810828,
    0.15794461193725562,
    0.0389650907962078,
    0.05753085698825666,
    0.1696127967415515,
    0.16442822599454554,
    0.07144044374185077,
    0.15845259514833843,
    0.16423536018966356
  ],
  [
    "Total Return",
    2,
    0.057082190428648705,
    0.19256594171615782,
    0.03559244690897145,
    0.1580699189960051,
    0.11182016705577658,
    0.06555461887426417,
    0.20854254569951913,
    0.20854254569951913,
    0.20854254569951913,
    0.12066537916995723,
    0.05493731118195888,
    0.06594822173447668,
    0.07139015216818279,
    0.08923609792958342,
    0.11682289683516478,
    0.19027997796682605,
    0.051462156336747444,
    0.03559244690897145
  ],
  [
    "Total Return",
    3,
    -0.19061453613527835,
    0.1498029927279101,
    0.0872030849356289,
    0.1370430162403533,
    0.1183904672527687,
    0.09965036746424838,
    0.16304845541853452,
    0.16304845541853452,
    0.16304845541853452,
    -0.39282170027907437,
    -0.36997611132718566,
    0.07900006306508467,
    0.17689350858521036,
    -0.40623204383435196,
    0.09869966679707765,
    -0.4172716255522949,
    -0.3679500303113997,
    0.0872030849356289
  ],
  [
    "Total Return",
    4,
    0.16303867134354477,
    -0.0185300909582935,
    0.034524320114372564,
    -0.010178438464917727,
    0.00806981004897045,
    0.023962626763297745,
    -0.004514816331647742,
    -0.004514816331647742,
    -0.004514816331647742,
    0.4040000388004261,
    0.264642338297876,
    0.029693929804595065,
    0.005255944335200269,
    0.27507327304801943,
    0.04868736318732947,
    0.5468405175753084,
    0.2635173081475055,
    0.034524320114372564
  ],
  [
    "Total Return",
    5,
    0.11624689959080481,
    0.12105797297878929,
    0.08611033279024793,
    0.10119535929040313,
    0.1037095453998147,
    0.09317937202805404,
    0.49944746071607926,
    0.49944746071607926,
    0.49944746071607926,
    0.1759039547473844,
    0.1506340348639459,
    0.06362036229624168,
    0.021578615221991226,
    0.08354358718490418,
    -0.00851190705534155,
    0.2014384230365669,
    0.15056174792422494,
    0.08611033279024793
  ],
  [
    "Total Return",
    6,
    0.042462825447058705,
    0.04814215624201701,
    0.0570870296680166,
    0.050049747135175515,
    0.0527068482037476,
    0.055357280823195465,
    -0.008236796723226303,
    -0.008236796723226303,
    -0.008236796723226303,
    0.026901004754602775,
    0.021118153857238253,
    0.07696712084053026,
    0.09706457046610462,
    -0.12314572230261056,
    0.0010752326237901677,
    0.03475766098084043,
    0.018949928514852665,
    0.0570870296680166
  ],
  [
    "Total Return",
    7,
    0.1102160797991456,
    0.15551414997120228,
    0.13617666387598693,
    0.15187320770273494,
    0.14623601995752122,
    0.14029344955916634,
    0.27692032146189116,
    0.27692032146189116,
    0.27692032146189116,
    0.17050978218817048,
    0.16003224238602765,
    0.03754892670638044,
    0.09684341500834992,
    0.1856053052527893,
    0.12166817724917012,
    0.18112548698889497,
    0.1599029285130973,
    0.13617666387598693
  ],
  [
    "Total Return",
    8,
    0.18465075090714222,
    0.292764017775748,
    0.26080510265980816,
    0.28649707010734904,
    0.27710634315196714,
    0.2674008870965081,
    1.143566785241899,
    1.143566785241899,
    1.143566785241899,
    0.3446876391344167,
    0.3238848466970623,
    -0.019776787112616656,
    -0.033208122709457166,
    0.2180651123012045,
    0.18282810446590303,
    0.36634180917950654,
    0.3230786471313738,
    0.26080510265980816
  ],
  [
    "Total Return",
    9,
    0.1042517064486359,
    0.026872124168275002,
    -0.02404169974907766,
    0.016604564018459556,
    0.0012799527142683953,
    -0.013945890944580985,
    0.15819977416437792,
    0.15819977416437792,
    0.15819977416437792,
    0.1632151568545468,
    0.13688358376182075,
    0.05998575399926809,
    -0.020629371376090777,
    -0.0596740621783014,
    -0.15020561241625574,
    0.19181409801244942,
    0.13463785464442046,
    -0.02404169974907766
  ],
  [
    "Total Return",
    10,
    0.009384163962939507,
    -0.06875823796704572,
    -0.08463731735187463,
    -0.0719712015484294,
    -0.07670916317846221,
    -0.08146880362524733,
    -0.19126874920449666,
    -0.19126874920449666,
    -0.19126874920449666,
    0.05337263021974459,
    0.013837640885861369,
    0.004807529874164551,
    5.480856025252834e-06,
    -0.003731686170505122,
    -0.0987580854176413,
    0.09435945660210376,
    0.012342937428686751,
    -0.08463731735187463
  ],
  [
    "Total Return",
    11,
    0.0819911416073209,
    -0.0008905988514329444,
    0.0016488605404514356,
    -0.0003597900240145391,
    0.00040962705829405976,
    0.0011605015440672162,
    -0.03469655918615988,
    -0.03469655918615988,
    -0.03469655918615988,
    0.09524485743532929,
    0.11959913306315295,
    0.024137948970977208,
    0.011062759863883942,
    0.026340064463413748,
    0.06474504245040835,
    0.0709786180948071,
    0.1199786573675592,
    0.0016488605404514356
  ],
  [
    "Total Return",
    12,
    0.14432943721549019,
    0.2984309693345417,
    0.18653367166480161,
    0.27548084361229175,
    0.2416013228940621,
    0.20835151671784513,
    1.1082585418480155,
    1.1082585418480155,
    1.1082585418480155,
    0.2717948315480272,
    0.21831591555840868,
    0.0355271535359738,
    0.021736243529953292,
    0.2642050582339448,
    0.19332981151141837,
    0.32663541332799406,
    0.21705430268489923,
    0.18653367166480161
  ],
  [
    "Total Return",
    13,
    -0.026540367217998573,
    0.05763779780682232,
    0.06624045019195823,
    0.06194614474958837,
    0.062305799239056325,
    0.06475547865673636,
    0.024165129683128672,
    0.024165129683128672,
    0.024165129683128672,
    -0.023352004143146976,
    -0.043842333247032905,
    0.003407565345097119,
    0.03349550264437284,
    -0.1474532662537571,
    -0.04167095047975666,
    -0.0012619253233363548,
    -0.04569022272848022,
    0.06624045019195823
  ],
  [
    "Total Return",
    14,
    0.2211324209987624,
    0.23879180541511924,
    0.17432524132453397,
    0.2256656507941066,
    0.20628085092416315,
    0.18704100755190511,
    0.556188877477886,
    0.556188877477886,
    0.556188877477886,
    0.35090802412032707,
    0.3148636179238715,
    0.08455644431316389,
    0.1065779092265351,
    0.2262117470601237,
    0.12055955905511428,
    0.38961544865598197,
    0.31223883174763056,
    0.17432524132453397
  ],
  [
    "Total Return",
    15,
    0.14032135463687068,
    0.4669429079542302,
    0.31438372890572164,
    0.43244029946314977,
    0.3894257884703023,
    0.34410254195834034,
    1.7053069122550153,
    1.7053069122550153,
    1.7053069122550153,
    0.33329219844253055,
    0.18398831564768492,
    0.07476090042475958,
    0.09551295485360534,
    0.09713838640624717,
    0.23853336627781951,
    0.48406086417127137,
    0.18331629868868005,
    0.31438372890572164
  ],
  [
    "Total Return",
    16,
    0.1660288621521957,
    0.04061675606806747,
    0.07366548213266078,
    0.047785725602705886,
    0.057965364027131816,
    0.06758853553290445,
    0.0803695935334181,
    0.0803695935334181,
    0.0803695935334181,
    0.28070493528718576,
    0.28705369259328073,
    -0.017660378398383303,
    -0.03119830723582484,
    0.1166407749905305,
    -0.04720009518805979,
    0.27419733789440026,
    0.28728740938940045,
    0.07366548213266078
  ],
  [
    "Total Return",
    17,
    -0.1602470542058062,
    -0.09572172918412059,
    -0.06855377204992374,
    -0.09031353870693348,
    -0.08217694754550631,
    -0.07401243774277833,
    -0.2618634015601986,
    -0.2618634015601986,
    -0.2618634015601986,
    -0.2536289362862124,
    -0.18110888886303056,
    -0.13021651691583458,
    -0.02012605943820811,
    -0.15341864638316305,
    -0.04015918172731581,
    -0.32577005901822353,
    -0.18175359611134545,
    -0.06855377204992374
  ],
  [
    "Total Return",
    18,
    0.1804838434194902,
    0.22156177601373916,
    0.16594603064765456,
    0.2107451189067462,
    0.19421592758891038,
    0.1773642464713019,
    0.5689517091686349,
    0.5689517091686349,
    0.5689517091686349,
    0.40552035833500977,
    0.26287659524670337,
    0.0565530750370844,
    0.07127871491392757,
    0.17933365081746167,
    0.1373274335967798,
    0.548556055008738,
    0.26175794848840206,
    0.16594603064765456
  ],
  [
    "Total Return",
    19,
    0.15454644818603303,
    0.21609543256174124,
    0.19184189001727714,
    0.21160461258843255,
    0.2045161079048896,
    0.19704266104117796,
    0.49456006935294905,
    0.49456006935294905,
    0.49456006935294905,
    0.25164338808851805,
    0.25019681916030745,
    0.013092501993107186,
    0.037333329898712186,
    0.03149637874015632,
    -0.0011424346169758293,
    0.2557826053805423,
    0.24886459611702305,
    0.19184189001727714
  ],
  [
    "Total Return",
    20,
    0.13441444186193752,
    0.17490936156735293,
    0.14946602333652814,
    0.16216191327418095,
    0.1624218363787724,
    0.15470411963151198,
    0.3593322978175786,
    0.3593322978175786,
    0.3593322978175786,
    0.20906973265254902,
    0.1787997220328026,
    0.07363484433270728,
    0.07145194103410457,
    0.3590157170341228,
    0.23424644451301124,
    0.2265596637279068,
    0.19167417738414572,
    0.14946602333652814
  ]
];

// Model configuration - which models are available in each portfolio
// Current = Current portfolio (limited options, was Portfolio 2)
// Modeled = Modeled portfolio (all options, was Portfolio 1)
const MODEL_CONFIG = {
    portfolio1: [2, 13, 15, 18], // Current portfolio - from Excel config
    portfolio2: [3, 5, 6, 7, 8, 16, 19] // Modeled - from Excel config
};

// ADVANCED METRICS VISIBILITY - Controls whether Advanced Risk Metrics section is shown
// Default: false (hidden for end users, shown in #update mode only)
let SHOW_ADVANCED_METRICS = false;

</script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
            -moz-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-size-adjust: 100%;
        }
        
        body {
            font-family: 'Roboto Slab', serif;
            background: #F9FBF7;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .upload-section {
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 2px dashed #dee2e6;
        }
        
        .upload-row {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        
        /* Portfolio Container Styles */
        .portfolio-container {
            border: 3px solid #4472C4;
            border-radius: 0px;
            padding: 20px;
            background: #F0F4FF;
            box-shadow: none;
            max-width: 400px;
            width: 100%;
            box-sizing: border-box;
            margin: 0 auto 25px auto;
        }
        
        .portfolio-container.portfolio-2 {
            border-color: #28a745;
            background: #F0FFF4;
            box-shadow: none;
        }
        
        .portfolio-header {
            font-size: 16px;
            font-weight: 700;
            color: #000000;
            margin-bottom: 12px;
            text-align: center;
        }
        
        .portfolio-container.portfolio-2 .portfolio-header {
            color: #000000;
            font-weight: 700;
        }
        
        
        /* Models Label */
        .models-label {
            font-size: 12px;
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }
        
        /* Selector row - model (70%) + allocation (30%) pairs */
        .selector-row-even {
            display: grid;
            grid-template-columns: 2.3fr 1fr 2.3fr 1fr 2.3fr 1fr 2.3fr 1fr;
            gap: 8px;
            align-items: end;
        }
        
        /* Even selector groups - all same width */
        .selector-group-even {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        /* Even labels - compact */
        .selector-label-even {
            font-size: 11px;
            font-weight: 600;
            color: #495057;
        }
        
        /* Even selects - all same size */
        .select-even {
            width: 100%;
            padding: 8px;
            border: 1.5px solid #ced4da;
            border-radius: 6px;
            font-size: 13px;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s ease;
        }
        
        
        /* Smaller allocation selects */
        .select-alloc {
            font-size: 12px;
            padding: 6px 4px;
            text-align: center;
        }

        .select-even:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .portfolio-container.portfolio-2 .select-even:focus {
            border-color: #28a745;
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
        }

        
        /* 2-column layout - 2 models per row */
        
        /* Stacked layout - one row per model */
        .selector-row-stack {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            margin-left: 5px;
            margin-right: 5px;
        }
        
        .selector-label-stack {
            font-size: 14px;
            font-weight: 600;
            color: #000000;
            white-space: nowrap;
            text-align: left;
            width: 20px;
            flex-shrink: 0;
        }
        
        .select-stack {
            padding: 6px 8px;
            border: 1px solid #000000;
            border-radius: 0px;
            font-size: 16px;
            font-weight: 700;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s ease;
            box-sizing: border-box;
            flex: 1;
            min-width: 0;
            max-width: 180px;
            text-align: left;
        }
        
        .select-alloc-stack {
            flex: 0 0 55px;
            width: 55px;
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            padding: 6px 4px;
            box-sizing: border-box;
        }
        
        .select-stack:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .portfolio-container.portfolio-2 .select-stack:focus {
            border-color: #28a745;
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
        }

        .selector-row-2col {
            display: grid;
            grid-template-columns: 15ch 8ch 15ch 8ch;
            gap: 1ch;
            align-items: end;
            max-width: 100%;
            margin-bottom: 20px;
        }
        
        .selector-group-2col {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .selector-label-2col {
            font-size: 11px;
            font-weight: 600;
            color: #495057;
        }
        
        .select-2col {
            width: 15ch;
            max-width: 15ch;
            padding: 6px 4px;
            border: 1.5px solid #ced4da;
            border-radius: 6px;
            font-size: 13px;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s ease;
            box-sizing: border-box;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .select-alloc-2col {
            font-size: 13px;
            text-align: center;
            padding: 4px 2px;
            width: 8ch;
            max-width: 8ch;
        }
        
        .select-2col:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .portfolio-container.portfolio-2 .select-2col:focus {
            border-color: #28a745;
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
        }

        .selector-group-compact {
            display: flex;
            flex-direction: column;
            gap: 3px;
            min-width: 80px;
        }
        
        /* Make model selectors wider than allocation dropdowns */
        .selector-group-compact:nth-child(odd) {
            flex: 2;
        }
        
        .selector-group-compact:nth-child(even) {
            flex: 1;
            max-width: 70px;
        }
        
        .selector-label-compact {
            font-size: 11px;
            font-weight: 600;
            color: #495057;
        }
        
        .select-compact {
            padding: 6px 8px;
            border: 1.5px solid #ced4da;
            border-radius: 6px;
            font-size: 12px;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s ease;
        }
        
        .select-compact:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .portfolio-container.portfolio-2 .select-compact:focus {
            border-color: #28a745;
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
        }
        
.selector-row {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .selector-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .selector-label {
            font-weight: 600;
            color: #495057;
            font-size: 13px;
        }
        
        select {
            padding: 8px 12px;
            font-size: 14px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            font-family: 'Roboto Slab', serif;
            min-width: 250px;
        }
        
        select:focus {
            outline: none;
            border-color: #007bff;
        }
        
        .upload-button {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .upload-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
        }
        
        .learn-more-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 123, 255, 0.4) !important;
            background: linear-gradient(135deg, #0056b3, #004085) !important;
        }
        
        .learn-more-button:active {
            transform: translateY(0);
        }
        
        #fileInput {
            display: none;
        }
        
        .message {
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            display: none;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
        }
        
        #reportContent {
            display: none;
        }
        
        .copy-button-container {
            text-align: center;
            margin: 20px 0 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .copy-button {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .copy-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40,167,69,0.3);
        }
        
        .copy-status {
            margin-top: 10px;
            font-size: 14px;
            color: #28a745;
            font-weight: 600;
            display: none;
        }
        
        #presentationContent {
            width: 60%;
            margin: 0 auto;
        }
        
        .header {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 15px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }
        
        .header > div:first-child {
            flex-shrink: 0;
        }
        
        .header > div:last-child {
            flex: 1;
        }
        
        h1 {
            font-size: 34px;
            color: #1a1a1a;
            margin-bottom: 3px;
            font-weight: 900;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: none;
            max-width: 240px;
            line-height: 1.1;
        }
        
        .subtitle {
            font-size: 16px;
            color: #666;
            font-style: italic;
        }
        
        .section-header {
            font-size: 20px;
            font-weight: 700;
            color: #1a1a1a;
            margin: 10px 0 6px 0;
            padding-bottom: 4px;
            border-bottom: 3px solid #007bff;
            text-align: center;
        }
        
        .performance-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px auto;
        }
        
        .performance-table thead tr {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }
        
        .performance-table th {
            padding: 4px 5px;
            text-align: center;
            font-weight: 600;
            font-size: 17px;
        }
        
        .performance-table th:nth-child(2),
        .performance-table td:nth-child(2) {
            width: 80px;
            white-space: nowrap;
        }
        
        .performance-table th:first-child {
            border-top-left-radius: 8px;
        }
        
        .performance-table th:last-child {
            border-top-right-radius: 8px;
        }
        
        .performance-table td {
            padding: 3px 5px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
            font-size: 17px;
        }
        
        .performance-table tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        .performance-table tbody tr:nth-child(even) {
            background-color: #f5f6f7;
        }
        
        .performance-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .performance-table tbody tr:last-child td:first-child {
            border-bottom-left-radius: 8px;
        }
        
        .performance-table tbody tr:last-child td:last-child {
            border-bottom-right-radius: 8px;
        }
        
        .performance-table td:nth-child(3),
        .performance-table td:nth-child(4),
        .performance-table td:nth-child(5) {
            font-weight: 600;
        }
        
        .performance-table .positive {
            color: #28a745;
        }
        
        .performance-table .negative {
            color: #dc3545;
        }
        
        .metrics-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin: 8px 0;
            max-width: 100%;
        }
        
        .metric-card {
            background: #f8f9fa;
            padding: 6px 8px;
            border-radius: 8px;
            text-align: center;
        }
        
        .metric-title {
            font-size: 15px;
            color: #666;
            margin-bottom: 3px;
            font-weight: 700;
        }
        
        .metric-table {
            width: 100%;
            margin-top: 2px;
        }
        
        .metric-table td {
            padding: 1px 4px;
            font-size: 14px;
            text-align: left;
        }
        
        .metric-table td:first-child {
            color: #666;
            font-weight: 500;
        }
        
        .metric-table td:last-child {
            font-weight: 700;
            text-align: right;
        }
        
        .metric-table .positive {
            color: #28a745;
        }
        
        .metric-table .negative {
            color: #dc3545;
        }
        
        .metric-table .neutral {
            color: #1a1a1a;
        }
    
        /* Update Data Section Styles */
        .update-data-section {
            display: none; /* Hide by default */
            animation: fadeIn 0.5s ease-in;
        }
        
        .update-data-section.visible {
            display: block !important; /* Show when visible class is added */
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(40, 167, 69, 0.3);
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(40, 167, 69, 0.4);
        }
        
        .btn-secondary:active {
            transform: translateY(0);
        }
        
        #updateStatus {
            min-height: 24px;
            font-size: 14px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }


        /* LOCAL TESTING BANNER */
        .testing-banner {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid #e91e63;
        }
        
        .testing-banner-subtitle {
            font-size: 14px;
            margin-top: 5px;
            opacity: 0.95;
        }

        /* Modal Disclaimer Overlay */
        #disclaimerModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            overflow-y: auto;
            padding: 40px 20px;
            animation: modalFadeIn 0.3s ease-in-out;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: white;
            max-width: 900px;
            margin: 0 auto;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: slideDown 0.5s ease-out;
            overflow: hidden;
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .modal-header {
            background: linear-gradient(135deg, #1565c0, #1976d2, #2196f3);
            color: white;
            padding: 40px 45px;
            text-align: center;
            border-bottom: 4px solid #0d47a1;
        }
        
        .modal-header h2 {
            margin: 0;
            font-size: 28px;
            font-weight: 700;
            line-height: 1.4;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .modal-body {
            padding: 45px 50px 50px 50px;
            color: #333;
            line-height: 1.8;
            background: #f8f9fa;
        }
        
        .modal-section {
            margin-bottom: 30px;
            background: white;
            padding: 25px 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.06);
            border-left: 5px solid #2196f3;
            transition: all 0.3s ease;
        }
        
        .modal-section:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .modal-section-title {
            font-size: 19px;
            font-weight: 700;
            color: #1565c0;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e3f2fd;
            display: flex;
            align-items: center;
        }
        
        .modal-section-title::before {
            content: "‚ñ∂";
            margin-right: 12px;
            font-size: 14px;
            color: #2196f3;
        }
        
        .modal-text {
            font-size: 16px;
            line-height: 1.8;
            color: #444;
        }
        
        .modal-list {
            margin: 15px 0;
            padding-left: 28px;
            font-size: 16px;
            line-height: 1.9;
            color: #444;
        }
        
        .modal-list li {
            margin-bottom: 12px;
            padding-left: 8px;
        }
        
        .modal-list li strong {
            color: #1565c0;
            font-weight: 600;
        }
        
        /* Legal disclosure section special styling */
        .modal-section:last-of-type {
            background: linear-gradient(135deg, #fff9e6, #fffbf0);
            border-left: 5px solid #ffc107;
        }
        
        .modal-section:last-of-type .modal-section-title {
            color: #856404;
            border-bottom-color: #ffeaa7;
        }
        
        .modal-section:last-of-type .modal-section-title::before {
            color: #ffc107;
        }
        
        #acceptDisclaimerBtn {
            background: linear-gradient(135deg, #1976d2, #2196f3);
            color: white;
            border: none;
            padding: 18px 70px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.4);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        #acceptDisclaimerBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(33, 150, 243, 0.5);
            background: linear-gradient(135deg, #1565c0, #1976d2);
        }
        
        #acceptDisclaimerBtn:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }
        
        /* Responsive Modal Styles */
        @media screen and (max-width: 768px) {
            #disclaimerModal {
                padding: 15px;
            }
            
            .modal-content {
                margin: 0 auto;
                border-radius: 12px;
            }
            
            .modal-header {
                padding: 28px 20px;
            }
            
            .modal-header h2 {
                font-size: 20px !important;
            }
            
            .modal-body {
                padding: 25px 20px 30px 20px;
            }
            
            .modal-section {
                padding: 18px 20px;
                margin-bottom: 20px;
            }
            
            .modal-section-title {
                font-size: 16px;
            }
            
            .modal-text {
                font-size: 14px;
            }
            
            .modal-list {
                font-size: 14px;
                padding-left: 22px;
                line-height: 1.7;
            }
            
            .modal-list li {
                margin-bottom: 10px;
            }
            
            #acceptDisclaimerBtn {
                padding: 15px 45px !important;
                font-size: 16px !important;
                width: 100%;
            }
        }
        
        @media screen and (max-width: 480px) {
            .modal-header h2 {
                font-size: 18px !important;
            }
            
            .modal-section {
                padding: 15px 16px;
            }
            
            .modal-section-title {
                font-size: 15px;
            }
            
            .modal-text, .modal-list {
                font-size: 13px;
            }
            
            #acceptDisclaimerBtn {
                padding: 10px 30px !important;
                font-size: 14px !important;
            }
        }

        /* Pie Chart Container */
        .pie-charts-container {
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            margin: 20px 0 30px 0;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .pie-chart-wrapper {
            flex: 1;
            min-width: 280px;
            max-width: 400px;
            text-align: center;
        }
        
        .pie-chart-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 10px;
            color: #333;
        }
        
        .pie-chart-canvas {
            max-width: 100%;
            height: auto;
        }

        /* PDF Download Button - inline styles in HTML for simplicity */
        #pdfDownloadButton:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(231, 76, 60, 0.4) !important;
        }
        
        #pdfDownloadButton:active {
            transform: translateY(0);
        }

        /* Mobile Responsive Styles */
        @media screen and (max-width: 768px) {
            body {
                font-size: 15px;
                padding: 15px 10px;
            }
            
            .container {
                padding: 20px 15px;
                margin: 10px auto;
            }
            
            #presentationContent {
                width: 100% !important;
                margin: 0 auto;
                padding: 0;
            }
            
            .header h1 {
                font-size: 22px;
                line-height: 1.2;
                max-width: none;
            }
            
            .portfolio-container {
                padding: 15px;
                margin: 10px auto;
                max-width: 100%;
            }
            
            .portfolio-header {
                font-size: 18px;
                padding: 12px;
            }
            
            /* Keep horizontal layout on mobile - same as desktop */
            .selector-row-stack {
                gap: 6px;
                margin-left: 3px;
                margin-right: 3px;
            }
            
            .selector-label-stack {
                font-size: 14px;
            }
            
            .select-stack {
                font-size: 14px;
                padding: 6px 6px;
            }
            
            .select-alloc-stack {
                font-size: 14px;
                padding: 6px 3px;
            }
            
            .update-button {
                width: 100%;
                padding: 15px;
                font-size: 16px;
            }
            
            .performance-table {
                font-size: 11px;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                width: 100%;
                margin: 0 auto;
            }
            
            .performance-table th,
            .performance-table td {
                padding: 6px 4px;
            }
            
            #growthChartContent {
                padding: 15px 10px 3px 10px !important;
            }
            
            #growthChartContent > div:nth-child(2) {
                height: 300px !important;
            }
            
            #growthChartContent > div:nth-child(3) {
                margin-top: -10px !important;
            }
            
            .section-header {
                font-size: 18px;
                padding: 8px 5px;
                margin: 0 auto;
                text-align: center;
            }
            
            #portfolioKey {
                padding: 0 5px;
                text-align: center;
            }
            
            .metrics-container {
                flex-direction: column;
            }
            
            .metric-card {
                margin: 10px 0;
            }
            
            .chart-container {
                padding: 15px;
            }
            
            canvas {
                max-height: 250px !important;
            }
            
            .copy-button {
                padding: 10px 16px;
                font-size: 14px;
                margin: 5px;
            }
            
            .pie-charts-container {
                flex-direction: column;
                align-items: center;
            }
            
            .pie-chart-wrapper {
                width: 100%;
                max-width: 320px;
            }
        }
        
        @media screen and (max-width: 480px) {
            body {
                font-size: 14px;
            }
            
            .container {
                padding: 15px 10px;
                margin: 5px auto;
            }
            
            .header h1 {
                font-size: 20px;
                line-height: 1.2;
                max-width: none;
            }
            
            .performance-table {
                font-size: 11px;
            }
            
            .performance-table th,
            .performance-table td {
                padding: 6px 4px;
            }
            
            #growthChartContent {
                padding: 10px 8px 2px 8px !important;
            }
            
            #growthChartContent > div:nth-child(2) {
                height: 250px !important;
            }
            
            #growthChartContent > div:nth-child(3) {
                margin-top: -15px !important;
            }
            
            .section-header {
                font-size: 17px;
                padding: 8px 5px;
            }
            
            .metric-title {
                font-size: 15px;
            }
            
            .metric-table {
                font-size: 12px;
            }
        }
        
        /* Landscape orientation on phones - ensure content fills screen */
        @media screen and (max-height: 500px) and (orientation: landscape) {
            .performance-table {
                margin-left: auto;
                margin-right: auto;
                display: table;
            }
            
            .header {
                justify-content: center;
                margin-left: auto;
                margin-right: auto;
                width: fit-content;
            }
            
            .header h1 {
                text-align: left;
            }
            
            .metrics-container {
                width: 100% !important;
                max-width: 100% !important;
            }
            
            #growthChartContent {
                width: 100% !important;
                max-width: 100% !important;
                padding: 10px 5px 3px 5px !important;
            }
            
            #growthChartContent > div:nth-child(2) {
                width: 100% !important;
            }
            
            #presentationContent {
                width: 100% !important;
                max-width: 100% !important;
            }
        }
        
        /* Tooltip Styles for Metric Definitions - Phase 2 Priority 5 */
        .metric-term {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted #666;
            cursor: help;
            color: #0066cc;
        }
        
        .metric-term:hover {
            color: #004499;
            border-bottom-color: #004499;
        }
        
        .tooltip {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #2c3e50;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.5;
            width: 280px;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: opacity 0.3s, visibility 0.3s;
            text-align: left;
            font-weight: 400;
        }
        
        .tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: #2c3e50;
        }
        
        .metric-term:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
        
        /* Mobile adjustments for tooltips */
        @media (max-width: 768px) {
            .tooltip {
                width: 220px;
                font-size: 12px;
                padding: 10px 12px;
            }
        }
        
        /* Click-to-expand style for mobile */
        .metric-term.active .tooltip {
            visibility: visible;
            opacity: 1;
        }

</style>


    <div class="container">
        <div class="upload-section">
            <div class="upload-row" style="display: none;">
                <button class="upload-button" onclick="document.getElementById('fileInput').click()">
                    üìÅ Select Excel File
                </button>
                <input type="file" id="fileInput" accept=".xlsx, .xls">
            </div>
            
            
            <!-- MODAL DISCLAIMER (First Visit Only) -->
            <div id="disclaimerModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 style="margin: 0; font-size: 24px; font-weight: 700;">
                            üî¨ Hypothetical Historical Comparison ‚Äî Important Information
                        </h2>
                    </div>
                    
                    <div class="modal-body">
                        <div class="modal-section">
                            <div class="modal-section-title">What This Tool Shows</div>
                            <div class="modal-text">
                                This calculator illustrates how selected, rules-based portfolio models and strategies would have performed historically over the period <span id="modalStartDate">December 30, 2005</span> through <span id="modalEndDate">December 31, 2025</span>, using hypothetical and backtested data. The results shown are not predictions, projections, or forecasts of future investment performance.
                            </div>
                        </div>
                        
                        <div class="modal-section">
                            <div class="modal-section-title">Key Limitations</div>
                            <ul class="modal-list">
                                <li><strong>Historical hindsight:</strong> Backtested results are developed using historical data and benefit from hindsight.</li>
                                <li><strong>Simplified assumptions:</strong> Results do not include fees, expenses, taxes, commissions, or transaction costs.</li>
                                <li><strong>Idealized execution:</strong> Assumes consistent application of the strategy without behavioral, timing, or implementation errors.</li>
                                <li><strong>Period sensitivity:</strong> Results are specific to the selected time period; different time periods may produce materially different outcomes.</li>
                                <li><strong>Survivorship considerations:</strong> Strategies and data reflect instruments available during the analyzed period.</li>
                            </ul>
                        </div>
                        
                        <div class="modal-section">
                            <div class="modal-section-title">Appropriate Uses</div>
                            <ul class="modal-list">
                                <li>Educational illustration of historical market behavior</li>
                                <li>Comparative analysis of different portfolio constructions and rules-based strategies</li>
                                <li>Understanding concepts such as volatility, drawdowns, and risk-adjusted returns</li>
                                <li>Informational reference for discussion with a qualified financial professional</li>
                            </ul>
                        </div>
                        
                        <div class="modal-section">
                            <div class="modal-section-title" style="color: #d32f2f;">Inappropriate Uses</div>
                            <ul class="modal-list">
                                <li>Making investment decisions without professional guidance</li>
                                <li>Expecting future results to resemble historical outcomes</li>
                                <li>Treating hypothetical results as actual performance</li>
                                <li>Relying on this tool as a substitute for individualized financial advice</li>
                            </ul>
                        </div>
                        
                        <div class="modal-section" style="background: #fff9e6; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
                            <div class="modal-section-title" style="color: #856404;">Legal Disclosure</div>
                            <div class="modal-text" style="font-size: 13px; color: #856404;">
                                This tool is provided for educational and informational purposes only and does not constitute investment advice, a recommendation, or an offer to buy or sell any security. Past performance is not indicative of future results. All investments involve risk, including the possible loss of principal. Market conditions change, and future outcomes may differ materially from historical scenarios.
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button id="acceptDisclaimerBtn" style="background: linear-gradient(135deg, #1976d2, #2196f3); 
                                    color: white; border: none; padding: 15px 50px; font-size: 16px; font-weight: 600; 
                                    border-radius: 8px; cursor: pointer; box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
                                    transition: all 0.3s ease;">
                                I Understand
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- LEAD CAPTURE MODAL -->
            <div id="leadCaptureModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                                              background: rgba(0,0,0,0.8); z-index: 10000; overflow-y: auto;">
                <div style="min-height: 100%; display: flex; align-items: center; justify-content: center; padding: 20px;">
                    <div style="background: white; border-radius: 16px; max-width: 600px; width: 100%; 
                               box-shadow: 0 20px 60px rgba(0,0,0,0.3); position: relative;">
                        <div style="background: linear-gradient(135deg, #1e3a8a, #3b82f6); padding: 30px; border-radius: 16px 16px 0 0; text-align: center;">
                            <div style="font-size: 48px; margin-bottom: 15px;">üìä</div>
                            <h3 style="color: white; margin: 0 0 10px 0; font-size: 24px; font-weight: 700;">
                                Get Your Detailed Analysis
                            </h3>
                            <p style="color: #bfdbfe; margin: 0; font-size: 15px;">
                                Enter your email to receive a comprehensive PDF report of this comparison
                            </p>
                        </div>
                        
                        <div style="padding: 30px;">
                            <form id="leadCaptureForm" onsubmit="submitLeadCapture(event)">
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #1e3a8a;">
                                        Email Address *
                                    </label>
                                    <input type="email" id="leadEmail" required 
                                           style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 15px;"
                                           placeholder="your.email@example.com">
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #1e3a8a;">
                                        Name (Optional)
                                    </label>
                                    <input type="text" id="leadName" 
                                           style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 15px;"
                                           placeholder="Your name">
                                </div>
                                
                                <div style="background: #eff6ff; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; color: #1e40af;">
                                    ‚úÖ Instant email delivery<br>
                                    ‚úÖ No spam, unsubscribe anytime<br>
                                    ‚úÖ Free consultation available
                                </div>
                                
                                <button type="submit" style="width: 100%; padding: 14px; background: #fbbf24; color: #1e3a8a; 
                                        border: none; border-radius: 8px; font-size: 16px; font-weight: 700; cursor: pointer;
                                        box-shadow: 0 4px 14px rgba(251, 191, 36, 0.4);">
                                    üìß Email Me the Results
                                </button>
                                
                                <button type="button" onclick="closeLeadCaptureModal()" 
                                        style="width: 100%; padding: 12px; background: white; color: #6b7280; 
                                        border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; font-weight: 600; 
                                        cursor: pointer; margin-top: 10px;">
                                    Maybe Later
                                </button>
                            </form>
                            
                            <div id="leadCaptureStatus" style="margin-top: 15px; text-align: center; font-weight: 600;"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- SCHEDULE MODAL -->
            <div id="scheduleModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                                          background: rgba(0,0,0,0.8); z-index: 10000; overflow-y: auto;">
                <div style="min-height: 100%; display: flex; align-items: center; justify-content: center; padding: 20px;">
                    <div style="background: white; border-radius: 16px; max-width: 600px; width: 100%; 
                               box-shadow: 0 20px 60px rgba(0,0,0,0.3); position: relative;">
                        <div style="background: linear-gradient(135deg, #059669, #10b981); padding: 30px; border-radius: 16px 16px 0 0; text-align: center;">
                            <div style="font-size: 48px; margin-bottom: 15px;">üìÖ</div>
                            <h3 style="color: white; margin: 0 0 10px 0; font-size: 24px; font-weight: 700;">
                                Schedule Your Free Consultation
                            </h3>
                            <p style="color: #d1fae5; margin: 0; font-size: 15px;">
                                Talk to a WavRyder specialist about optimizing your portfolio
                            </p>
                        </div>
                        
                        <div style="padding: 30px; text-align: center;">
                            <div style="margin-bottom: 25px;">
                                <div style="background: #ecfdf5; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                                    <h4 style="color: #059669; margin: 0 0 15px 0; font-size: 18px;">What to Expect:</h4>
                                    <div style="text-align: left; color: #047857; font-size: 14px; line-height: 1.8;">
                                        ‚úì 15-minute complimentary consultation<br>
                                        ‚úì Personalized portfolio review<br>
                                        ‚úì WavRyder methodology explanation<br>
                                        ‚úì Answer all your questions<br>
                                        ‚úì No obligation or pressure
                                    </div>
                                </div>
                            </div>
                            
                            <a href="https://wavryder.com/contact" target="_blank"
                               style="display: inline-block; padding: 16px 40px; background: #10b981; color: white; 
                                      text-decoration: none; border-radius: 10px; font-size: 17px; font-weight: 700;
                                      box-shadow: 0 4px 14px rgba(16, 185, 129, 0.4); margin-bottom: 15px;">
                                üìû Schedule Now
                            </a>
                            
                            <div style="font-size: 13px; color: #6b7280; margin-bottom: 20px;">
                                Or call us: <strong style="color: #059669;">(555) 123-4567</strong>
                            </div>
                            
                            <button type="button" onclick="closeScheduleModal()" 
                                    style="padding: 12px 30px; background: white; color: #6b7280; 
                                    border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; font-weight: 600; 
                                    cursor: pointer;">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- WavRyder Historical Scenario Explorer Header -->
            <div style="text-align: center; margin: 30px auto 40px auto; max-width: 800px; 
                        background: linear-gradient(135deg, #f8f9fa, #ffffff); 
                        border: 2px solid #e3f2fd; border-radius: 16px; 
                        padding: 35px 40px; box-shadow: 0 4px 20px rgba(33, 150, 243, 0.08);">
                
                <!-- Logo + Title Row -->
                <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 20px;">
                    <img src="data:image/png;base64,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" 
                         alt="WavRyder Logo" style="height: 42px; width: auto;">
                    <div style="text-align: left;">
                        <h2 style="margin: 0; font-size: 26px; font-weight: 700; color: #1565c0; line-height: 1.3;">
                            WavRyder Historical Scenario Explorer
                        </h2>
                    </div>
                </div>
                
                <!-- Subtitle -->
                <div style="max-width: 650px; margin: 0 auto; font-size: 15px; color: #6c757d; line-height: 1.7; text-align: center;">
                    An educational tool that illustrates how selected, rules-based portfolio models would have performed historically using hypothetical, backtested data.
                </div>
            </div>
            
            <!-- Select Portfolio Combinations Header -->
            <h3 style="margin: 30px 0 20px 0; color: #495057; text-align: center; font-size: 20px;">Select Portfolio Combinations</h3>
            
            <!-- PRE-BUILT SCENARIOS - One-Click Demonstrations -->
            <div style="max-width: 1000px; margin: 0 auto 30px auto; padding: 25px; background: linear-gradient(135deg, #fef3c7, #fef9c3); 
                        border: 2px solid #fbbf24; border-radius: 12px; box-shadow: 0 4px 12px rgba(251, 191, 36, 0.2);">
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 24px; margin-bottom: 10px;">‚ö°</div>
                    <h4 style="margin: 0 0 8px 0; color: #92400e; font-size: 18px; font-weight: 700;">
                        See WavRyder in Action - Try These Scenarios
                    </h4>
                    <p style="margin: 0; color: #b45309; font-size: 14px;">
                        Click any button below to instantly compare portfolios and see the difference WavRyder makes
                    </p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                    <button onclick="loadScenario('scenario1')" 
                            style="padding: 15px 20px; background: white; border: 2px solid #f59e0b; border-radius: 10px; 
                                   cursor: pointer; text-align: left; transition: all 0.3s; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(245, 158, 11, 0.25)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(245, 158, 11, 0.15)';">
                        <div style="font-weight: 700; color: #92400e; margin-bottom: 5px; font-size: 15px;" id="scenario1_title">
                            üõ°Ô∏è Conservative
                        </div>
                        <div style="font-size: 12px; color: #b45309;" id="scenario1_desc">
                            Traditional 60/40 vs Conservative + WR Adj
                        </div>
                    </button>
                    
                    <button onclick="loadScenario('scenario2')" 
                            style="padding: 15px 20px; background: white; border: 2px solid #f59e0b; border-radius: 10px; 
                                   cursor: pointer; text-align: left; transition: all 0.3s; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(245, 158, 11, 0.25)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(245, 158, 11, 0.15)';">
                        <div style="font-weight: 700; color: #92400e; margin-bottom: 5px; font-size: 15px;" id="scenario2_title">
                            üöÄ Aggressive Growth
                        </div>
                        <div style="font-size: 12px; color: #b45309;" id="scenario2_desc">
                            Traditional Aggressive 80/20 vs Aggressive + WR Adj / Lev Nasdaq + WR Adj
                        </div>
                    </button>
                    
                    <button onclick="loadScenario('scenario3')" 
                            style="padding: 15px 20px; background: white; border: 2px solid #f59e0b; border-radius: 10px; 
                                   cursor: pointer; text-align: left; transition: all 0.3s; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(245, 158, 11, 0.25)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(245, 158, 11, 0.15)';">
                        <div style="font-weight: 700; color: #92400e; margin-bottom: 5px; font-size: 15px;" id="scenario3_title">
                            üìâ Balanced Growth
                        </div>
                        <div style="font-size: 12px; color: #b45309;" id="scenario3_desc">
                            Traditional balanced vs Aggressive + WR Adj
                        </div>
                    </button>
                    
                    <button onclick="loadScenario('scenario4')" 
                            style="padding: 15px 20px; background: white; border: 2px solid #f59e0b; border-radius: 10px; 
                                   cursor: pointer; text-align: left; transition: all 0.3s; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(245, 158, 11, 0.25)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(245, 158, 11, 0.15)';">
                        <div style="font-weight: 700; color: #92400e; margin-bottom: 5px; font-size: 15px;" id="scenario4_title">
                            üíº Moderate Growth
                        </div>
                        <div style="font-size: 12px; color: #b45309;" id="scenario4_desc">
                            Traditional Moderate 50/50 vs Moderate + WR Adj
                        </div>
                    </button>
                </div>
                
                <div style="text-align: center; margin-top: 15px; font-size: 12px; color: #92400e; font-style: italic;">
                    Or build your own custom comparison below ‚Üì
                </div>
            </div>
            
            <!-- How to Use Instructions - Collapsible -->
            <div style="max-width: 900px; margin: 0 auto 30px auto;">
                <div style="background: #e7f3ff; border: 2px solid #2196f3; border-radius: 10px; overflow: hidden;">
                    <!-- Header - Always Visible -->
                    <div onclick="toggleInstructions()" style="padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: linear-gradient(135deg, #2196f3, #1976d2);">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <span style="font-size: 24px;">üìñ</span>
                            <span style="font-size: 16px; font-weight: 700; color: white;">How to Use This Tool</span>
                        </div>
                        <span id="instructionsToggle" style="font-size: 24px; color: white; transition: transform 0.3s;">‚ñº</span>
                    </div>
                    
                    <!-- Collapsible Content -->
                    <div id="instructionsContent" style="display: none; padding: 20px; background: white;">
                        <div id="instructionsText" style="line-height: 1.8; color: #333;">
                            <!-- Default Instructions -->
                            <h4 style="color: #2196f3; margin: 0 0 15px 0; font-size: 16px;">üìä Quick Start Guide</h4>
                            
                            <div style="margin-bottom: 20px;">
                                <strong style="color: #1976d2;">STEP 1: Current Portfolio</strong> (What you have today)
                                <ul style="margin: 8px 0 0 20px;">
                                    <li><strong>Quick Templates:</strong> Select a preset allocation (Conservative, Moderate, Balanced, etc.)</li>
                                    <li><strong>Custom Build:</strong> Use rows A-D to select models and allocation percentages</li>
                                    <li><strong>Must total 100%</strong></li>
                                </ul>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <strong style="color: #1976d2;">STEP 2: Modeled Portfolio</strong> (What you're considering)
                                <ul style="margin: 8px 0 0 20px;">
                                    <li>Scroll down to the second portfolio section</li>
                                    <li>Build your proposed allocation using rows A-D</li>
                                    <li>More model options available</li>
                                    <li><strong>Must total 100%</strong></li>
                                </ul>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <strong style="color: #1976d2;">STEP 3: Compare</strong>
                                <ul style="margin: 8px 0 0 20px;">
                                    <li>Click <strong>"Compare Portfolios"</strong> button</li>
                                    <li>View historical performance comparison</li>
                                    <li>See growth charts, metrics, and risk analysis</li>
                                </ul>
                            </div>
                            
                            <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 12px; margin-top: 15px; border-radius: 4px;">
                                <strong>üí° Tip:</strong> Use Quick Templates to load common allocations instantly, then customize as needed!
                            </div>
                            
                            <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 12px; margin-top: 10px; border-radius: 4px; font-size: 13px;">
                                <strong>‚ö†Ô∏è Important:</strong> This tool shows hypothetical historical performance. Past results do not guarantee future returns. For educational purposes only.
                            </div>
                        </div>
                        
                        <!-- Edit Button (only visible in #update mode) -->
                        <div id="editInstructionsBtn" style="display: none; margin-top: 20px; text-align: center;">
                            <button onclick="editInstructions()" style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 14px;">
                                ‚úèÔ∏è Edit Instructions
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
                        <!-- Current Container -->

            <!-- Current Portfolio (Portfolio 1) -->
            <div class="portfolio-container" id="portfolio1Container" style="display: block;">
                <div class="portfolio-header">Current Portfolio</div>
                

                <!-- Quick Templates -->
                <div style="text-align: center; margin: 10px 0 15px 0; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 2px solid #e9ecef;">
                    <label style="font-size: 13px; font-weight: 600; color: #495057; display: block; margin-bottom: 8px;">
                        ‚ö° Quick Templates - Load Common Allocations:
                    </label>
                    <select id="templateSelect" onchange="loadTemplate()" style="padding: 8px 12px; font-size: 14px; font-weight: 600; border: 2px solid #007bff; 
                                                     border-radius: 6px; background: white; cursor: pointer; min-width: 200px;">
                        <option value="">-- Select a Template --</option>
                        <option value="conservative">üõ°Ô∏è Conservative (40/60 Stocks/Bonds)</option>
                        <option value="moderate">‚öñÔ∏è Moderate (50/50 Stocks/Bonds)</option>
                        <option value="balanced">üìä Balanced (60/40 Stocks/Bonds)</option>
                        <option value="growth">üìà Growth (70/30 Stocks/Bonds)</option>
                        <option value="aggressive">üöÄ Aggressive (80/20 Stocks/Bonds)</option>
                        <option value="global">üåç Global Balanced (60/30/10 SPY/AGG/VEA)</option>
                    </select>
                    <div style="font-size: 11px; color: #6c757d; margin-top: 6px; font-style: italic;">
                        Or build custom portfolio below
                    </div>
                </div>

                <!-- A row -->
                <div class="selector-row-stack">
                    <label class="selector-label-stack">A:</label>
                    <select id="option1Select" class="select-stack"><option value="">--</option><option value="5">Aggressive WR Adj</option><option value="6">Moderate WR Adj</option><option value="7">Conservative WR Adj</option><option value="8">Leveraged Nasdaq</option><option value="9">Leveraged S&P500</option><option value="13">Bond</option><option value="15">International</option><option value="18">S&P500</option></select>
                    <label class="selector-label-stack">%:</label>
                    <select id="allocation1Select" class="select-stack select-alloc-stack">
                        <option value="0">0</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                    </select>
                </div>
                
                <!-- B row -->
                <div class="selector-row-stack">
                    <label class="selector-label-stack">B:</label>
                    <select id="option2Select" class="select-stack"><option value="">--</option><option value="5">Aggressive WR Adj</option><option value="6">Moderate WR Adj</option><option value="7">Conservative WR Adj</option><option value="8">Leveraged Nasdaq</option><option value="9">Leveraged S&P500</option><option value="13">Bond</option><option value="15">International</option><option value="18">S&P500</option></select>
                    <label class="selector-label-stack">%:</label>
                    <select id="allocation2Select" class="select-stack select-alloc-stack">
                        <option value="0">0</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                    </select>
                </div>
                
                <!-- C row -->
                <div class="selector-row-stack">
                    <label class="selector-label-stack">C:</label>
                    <select id="option5Select" class="select-stack"><option value="">--</option><option value="5">Aggressive WR Adj</option><option value="6">Moderate WR Adj</option><option value="7">Conservative WR Adj</option><option value="8">Leveraged Nasdaq</option><option value="9">Leveraged S&P500</option><option value="13">Bond</option><option value="15">International</option><option value="18">S&P500</option></select>
                    <label class="selector-label-stack">%:</label>
                    <select id="allocation5Select" class="select-stack select-alloc-stack">
                        <option value="0">0</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                    </select>
                </div>
                
                <!-- D row -->
                <div class="selector-row-stack">
                    <label class="selector-label-stack">D:</label>
                    <select id="option6Select" class="select-stack"><option value="">--</option><option value="5">Aggressive WR Adj</option><option value="6">Moderate WR Adj</option><option value="7">Conservative WR Adj</option><option value="8">Leveraged Nasdaq</option><option value="9">Leveraged S&P500</option><option value="13">Bond</option><option value="15">International</option><option value="18">S&P500</option></select>
                    <label class="selector-label-stack">%:</label>
                    <select id="allocation6Select" class="select-stack select-alloc-stack">
                        <option value="0">0</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                    </select>
                </div>
            </div>

            <!-- Modeled Portfolio (Portfolio 2) -->
            <div class="portfolio-container portfolio-2" id="portfolio2Container" style="display: block;">
                <div class="portfolio-header">Modeled Portfolio</div>
                
                
                <!-- Regular Model Selection Section -->
                <div id="regularInputSection">
                <!-- A row -->
                <div class="selector-row-stack">
                    <label class="selector-label-stack">A:</label>
                    <select id="option3Select" class="select-stack"><option value="">--</option><option value="2">60/40</option><option value="3">WavRyder QQQ</option><option value="4">WavRyder SP500</option><option value="5">WavRyder(H)</option><option value="6">WavRyder(M)</option><option value="7">WavRyder(L)</option><option value="8">WavRyder QQQ (Leveraged)</option><option value="9">WavRyder SP500 (Leveraged)</option><option value="10">WavRyder QQQ/SP500 Leveraged)</option><option value="11">QQQ (Leveraged) W/O WavRyder</option><option value="12">SP 500</option><option value="13">AGG</option><option value="14">WavRyder AGG</option><option value="15">VEA</option><option value="16">WavRyder VEA</option><option value="17">QQQ</option><option value="18">SPY</option><option value="19">WavRyder SPY</option></select>
                    <label class="selector-label-stack">%:</label>
                    <select id="allocation3Select" class="select-stack select-alloc-stack">
                        <option value="0">0</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                    </select>
                </div>
                
                <!-- B row -->
                <div class="selector-row-stack">
                    <label class="selector-label-stack">B:</label>
                    <select id="option4Select" class="select-stack"><option value="">--</option><option value="2">60/40</option><option value="3">WavRyder QQQ</option><option value="4">WavRyder SP500</option><option value="5">WavRyder(H)</option><option value="6">WavRyder(M)</option><option value="7">WavRyder(L)</option><option value="8">WavRyder QQQ (Leveraged)</option><option value="9">WavRyder SP500 (Leveraged)</option><option value="10">WavRyder QQQ/SP500 Leveraged)</option><option value="11">QQQ (Leveraged) W/O WavRyder</option><option value="12">SP 500</option><option value="13">AGG</option><option value="14">WavRyder AGG</option><option value="15">VEA</option><option value="16">WavRyder VEA</option><option value="17">QQQ</option><option value="18">SPY</option><option value="19">WavRyder SPY</option></select>
                    <label class="selector-label-stack">%:</label>
                    <select id="allocation4Select" class="select-stack select-alloc-stack">
                        <option value="0">0</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                    </select>
                </div>
                
                <!-- C row -->
                <div class="selector-row-stack">
                    <label class="selector-label-stack">C:</label>
                    <select id="option7Select" class="select-stack"><option value="">--</option><option value="2">60/40</option><option value="3">WavRyder QQQ</option><option value="4">WavRyder SP500</option><option value="5">WavRyder(H)</option><option value="6">WavRyder(M)</option><option value="7">WavRyder(L)</option><option value="8">WavRyder QQQ (Leveraged)</option><option value="9">WavRyder SP500 (Leveraged)</option><option value="10">WavRyder QQQ/SP500 Leveraged)</option><option value="11">QQQ (Leveraged) W/O WavRyder</option><option value="12">SP 500</option><option value="13">AGG</option><option value="14">WavRyder AGG</option><option value="15">VEA</option><option value="16">WavRyder VEA</option><option value="17">QQQ</option><option value="18">SPY</option><option value="19">WavRyder SPY</option></select>
                    <label class="selector-label-stack">%:</label>
                    <select id="allocation7Select" class="select-stack select-alloc-stack">
                        <option value="0">0</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                    </select>
                </div>
                
                <!-- D row -->
                <div class="selector-row-stack">
                    <label class="selector-label-stack">D:</label>
                    <select id="option8Select" class="select-stack"><option value="">--</option><option value="2">60/40</option><option value="3">WavRyder QQQ</option><option value="4">WavRyder SP500</option><option value="5">WavRyder(H)</option><option value="6">WavRyder(M)</option><option value="7">WavRyder(L)</option><option value="8">WavRyder QQQ (Leveraged)</option><option value="9">WavRyder SP500 (Leveraged)</option><option value="10">WavRyder QQQ/SP500 Leveraged)</option><option value="11">QQQ (Leveraged) W/O WavRyder</option><option value="12">SP 500</option><option value="13">AGG</option><option value="14">WavRyder AGG</option><option value="15">VEA</option><option value="16">WavRyder VEA</option><option value="17">QQQ</option><option value="18">SPY</option><option value="19">WavRyder SPY</option></select>
                    <label class="selector-label-stack">%:</label>
                    <select id="allocation8Select" class="select-stack select-alloc-stack">
                        <option value="0">0</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                    </select>
                </div>
                </div>
                <!-- End Regular Input Section -->
                
                <button class="upload-button" style="padding: 8px 20px; font-size: 14px; margin-top: 15px;" onclick="updateComparison()">
                    üìä View Historical Comparison Analysis
                </button>
            </div>
            
            <div class="error-message" id="errorMessage"></div>
            <div class="success-message" id="successMessage" style="display: block;">‚úì Performance data loaded successfully!</div>
        </div>

        <div id="reportContent" style="display: none;">
            
            <!-- AHA MOMENT SUMMARY CARD - High-Impact Results Summary -->
            <div id="ahaCard" style="display: none; max-width: 900px; margin: 30px auto 40px auto; 
                                     background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); 
                                     border-radius: 16px; padding: 40px 30px; box-shadow: 0 10px 40px rgba(30, 58, 138, 0.3);
                                     border: 3px solid #60a5fa;">
                <div style="text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 15px;">üí°</div>
                    <h2 style="color: white; font-size: 28px; font-weight: 700; margin: 0 0 20px 0; line-height: 1.3;">
                        Here's What the Data Shows
                    </h2>
                    <div id="ahaMessage" style="font-size: 20px; color: #bfdbfe; line-height: 1.6; margin-bottom: 25px; font-weight: 500;">
                        <!-- Dynamic message inserted here -->
                    </div>
                    
                    <!-- Dollar Impact -->
                    <div id="dollarImpact" style="background: rgba(255,255,255,0.15); border-radius: 12px; padding: 25px; margin: 25px 0;">
                        <div style="color: #bfdbfe; font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">
                            üí∞ Real Dollar Impact
                        </div>
                        <div id="dollarImpactAmount" style="font-size: 42px; font-weight: 800; color: #fbbf24; margin-bottom: 8px;">
                            <!-- $ amount inserted here -->
                        </div>
                        <div style="color: #e0e7ff; font-size: 15px;">
                            Based on a $100,000 investment over 20 years
                        </div>
                    </div>
                    
                    <!-- CTA Buttons -->
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 30px;">
                        <button onclick="showLeadCaptureModal()" style="padding: 16px 32px; background: #fbbf24; color: #1e3a8a; 
                                border: none; border-radius: 10px; font-size: 17px; font-weight: 700; cursor: pointer;
                                box-shadow: 0 4px 14px rgba(251, 191, 36, 0.4); transition: all 0.3s;
                                display: flex; align-items: center; gap: 10px;"
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(251, 191, 36, 0.5)';"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 14px rgba(251, 191, 36, 0.4)';">
                            üìß Email Me These Results
                        </button>
                        <button onclick="showScheduleModal()" style="padding: 16px 32px; background: white; color: #1e3a8a; 
                                border: 2px solid white; border-radius: 10px; font-size: 17px; font-weight: 700; cursor: pointer;
                                box-shadow: 0 4px 14px rgba(255, 255, 255, 0.3); transition: all 0.3s;
                                display: flex; align-items: center; gap: 10px;"
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255, 255, 255, 0.4)';"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 14px rgba(255, 255, 255, 0.3)';">
                            üìÖ Talk to a WavRyder Advisor
                        </button>
                    </div>
                    
                    <div style="margin-top: 20px; font-size: 13px; color: #cbd5e1;">
                        Free consultation ‚Ä¢ No obligation ‚Ä¢ See if WavRyder is right for you
                    </div>
                </div>
            </div>
            
            <div class="copy-button-container" id="copyButtonsContainer" style="display: none;">
                <button class="copy-button" onclick="copyAllAsImage()" style="background: linear-gradient(135deg, #28a745, #218838);">
                    üìë Copy All
                </button>
                <button class="copy-button" onclick="copyReportAsImage()">
                    üìã Copy Performance Report
                </button>
                <button class="copy-button" onclick="copyGrowthChartAsImage()" style="background: linear-gradient(135deg, #17a2b8, #138496);">
                    üìà Copy Growth Chart
                </button>
                <button class="copy-button" onclick="copyRiskMetricsAsImage()" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                    üìä Copy Risk Metrics
                </button>
                <button class="copy-button" onclick="generateAuditReport()" style="background: linear-gradient(135deg, #6c757d, #545b62);">
                    üìÑ Generate Audit Report
                </button>
                <div class="copy-status" id="copyStatus"></div>
            </div>

            <div id="presentationContent">
                <div class="header">
                    <div style="text-align: center; margin-bottom: 15px;">
                        <img src="data:image/png;base64,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" alt="WavRyder Logo" style="max-width: 180px; height: auto;">
                    </div>
                    <h1>Hypothetical Historical Comparison</h1>
                    <div style="font-size: 14px; color: #6c757d; font-style: italic; margin-top: 5px; text-align: center;" id="mainSubtitle">
                        "What If You Had Invested in <span id="subtitleYear">2005</span>?"
                    </div>
                </div>
                
                <!-- Data Period Notice -->
                <div style="text-align: center; font-size: 12px; color: #6c757d; margin: 10px 0; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                    üìÖ Hypothetical Scenario Period: <strong><span id="headerStartDate">December 30, 2005</span> - <span id="headerEndDate">December 31, 2025</span></strong> (<span id="headerYearsCount">20</span> years) | Last Updated: January 10, 2025
                </div>

                <div class="section-header" style="margin-top: 5px;">Hypothetical Portfolio Growth Over Time</div>
                <div id="growthChartContent" style="background: #ffffff; padding: 15px 15px 5px 15px; border-radius: 8px; margin-top: 6px;">
                    <div style="text-align: center; margin-bottom: 10px;">
                        <h3 style="font-size: 18px; color: #1a1a1a; font-weight: 600; margin-bottom: 3px;">Hypothetical $100K Growth (<span id="chartYearRange">2005-2025</span>)</h3>
                        <div id="chartSubtitle" style="font-size: 13px; color: #666; font-style: italic;">Portfolio Comparison</div>
                    </div>
                    <div style="position: relative; height: 400px;">
                        <canvas id="growthChart"></canvas>
                    </div>
                    <div style="text-align: center; font-size: 11px; color: #999; font-style: italic; margin-top: 0px; margin-bottom: 0px;">
                        Hypothetical growth calculated from annual returns with annual rebalancing. This is not a prediction of future results.
                    </div>
                </div>
                
                
                <div class="section-header">Hypothetical <span id="sectionYearsCount">20</span>-Year Investment Lookback (<span id="sectionYearRange">2005-2025</span>)</div>
                <div class="metrics-container">
                    <div class="metric-card">
                        <div class="metric-title"><span class="metric-term">$100k Investment Growth<span class="tooltip">Shows how a hypothetical $100,000 investment would have grown over the specified period, assuming reinvestment of all returns.</span></span></div>
                        <table class="metric-table">
                            <tbody><tr>
                                <td id="col2Label1">Modeled:</td>
                                <td class="neutral" id="option2_100k">$0</td>
                            </tr>
                            <tr>
                                <td id="col1Label1">Current:</td>
                                <td class="neutral" id="option1_100k">$0</td>
                            </tr>
                            <tr>
                                <td>Difference:</td>
                                <td class="positive" id="diff100k">$0</td>
                            </tr>
                        </tbody></table>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title"><span class="metric-term">Max Annual Drawdown<span class="tooltip">The largest peak-to-trough decline experienced by the portfolio during any calendar year. Lower is better, indicating more downside protection.</span></span></div>
                        <table class="metric-table">
                            <tbody><tr>
                                <td id="col2Label2">Modeled:</td>
                                <td class="neutral" id="option2Drawdown">0%</td>
                            </tr>
                            <tr>
                                <td id="col1Label2">Current:</td>
                                <td class="neutral" id="option1Drawdown">0%</td>
                            </tr>
                            <tr>
                                <td>Difference:</td>
                                <td class="positive" id="drawdownDiff">0%</td>
                            </tr>
                        </tbody></table>
                    </div>
                </div>
                <div style="text-align: center; font-size: 11px; color: #999; font-style: italic; margin-top: 6px;">
                    <div style="font-weight: 600; font-size: 12px; color: #1565c0; margin-bottom: 8px;">
                        üìã Hypothetical Scenario Methodology (<span id="methodologyYearRange">2005-2025</span>)
                    </div>
                    <ul style="text-align: left; display: inline-block; margin: 5px 0;">
                        <li>Hypothetical back-test CAGRs and growth from daily model (Jan 2006 - Dec 2024)</li>
                        <li><strong>Multi-model portfolios assume annual rebalancing to target allocations</strong></li>
                        <li>Max annual drawdown based on year-end values</li>
                        <li>Transaction costs, taxes, and slippage not included</li>
                        <li><strong>This is a hypothetical historical scenario - past performance ‚â† future results</strong></li>
                    </ul>
                </div>
                
                
                <!-- WavRyder Learn More Button #1 -->
                <div style="text-align: center; margin: 40px 0;">
                    <a href="https://wavryder.com" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
                        <div style="display: inline-flex; align-items: center; gap: 12px; 
                                    background: linear-gradient(135deg, #ffffff, #f8f9fa); 
                                    border: 2px solid #2196f3; border-radius: 12px; 
                                    padding: 16px 32px; transition: all 0.3s ease;
                                    box-shadow: 0 4px 12px rgba(33, 150, 243, 0.15);
                                    cursor: pointer;"
                             onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 6px 20px rgba(33, 150, 243, 0.25)';"
                             onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(33, 150, 243, 0.15)';">
                            <img src="data:image/png;base64,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" 
                                 alt="WavRyder Logo" style="height: 24px; width: auto;">
                            <span style="font-size: 15px; font-weight: 600; color: #1565c0;">
                                Want to learn more about WavRyder's methodology? Visit WavRyder.com
                            </span>
                        </div>
                    </a>
                </div>

                <div class="section-header">Hypothetical Performance Metrics</div>
                <div id="portfolioKey" style="text-align: center; font-size: 13px; color: #666; font-style: italic; margin-top: 3px; margin-bottom: 8px;">
                    <span id="portfolio1Description">Current Portfolio</span> vs <span id="portfolio2Description">Modeled Portfolio</span>
                </div>
                
                <!-- Portfolio Allocation Header with Tooltip -->
                <div style="text-align: center; margin: 25px 0 15px 0;">
                    <h3 style="font-size: 18px; color: #2c3e50; font-weight: 600;">
                        <span class="metric-term">Portfolio Allocation<span class="tooltip">The distribution of investments across different asset classes (stocks, bonds, alternatives, etc.) that make up a portfolio. Proper allocation is key to managing risk and return.</span></span>
                    </h3>
                </div>
                
                <!-- Pie Charts for Portfolio Allocation -->
                <div id="pieChartsSection" class="pie-charts-container" style="display: none;">
                    <div class="pie-chart-wrapper">
                        <div class="pie-chart-title" id="pieChart1Title">Current Allocation</div>
                        <canvas id="pieChart1" class="pie-chart-canvas"></canvas>
                    </div>
                    <div class="pie-chart-wrapper">
                        <div class="pie-chart-title" id="pieChart2Title">Modeled Allocation</div>
                        <canvas id="pieChart2" class="pie-chart-canvas"></canvas>
                    </div>
                </div>
                
                <table class="performance-table">
                    <thead>
                        <tr>
                            <th>Return Type</th>
                            <th>Period</th>
                            <th id="col1HeaderTable">Option 1</th>
                            <th id="col2HeaderTable">Option 2</th>
                            <th>Difference</th>
                        </tr>
                    </thead>
                    <tbody id="performanceTableBody">
                    </tbody>
                </table>

                <!-- Interpretation Commentary Block -->
                <div id="interpretationBlock" style="max-width: 800px; margin: 35px auto 30px auto; 
                                                      background: linear-gradient(135deg, #f0f7ff, #ffffff); 
                                                      border-left: 4px solid #2196f3; border-radius: 10px; 
                                                      padding: 20px 28px; box-shadow: 0 3px 15px rgba(33, 150, 243, 0.1);
                                                      transition: all 0.4s ease;">
                    <div style="display: flex; align-items: flex-start; gap: 15px;">
                        <div style="font-size: 28px; line-height: 1; color: #2196f3; flex-shrink: 0; margin-top: 2px;">
                            üí°
                        </div>
                        <div>
                            <div style="font-size: 13px; font-weight: 700; color: #1565c0; text-transform: uppercase; 
                                        letter-spacing: 0.5px; margin-bottom: 8px;">
                                Historical Interpretation
                            </div>
                            <div id="commentaryText" style="font-size: 15px; line-height: 1.7; color: #444; font-style: italic;">
                                Historically, portfolios with more stocks went up more but also fell harder, while conservative portfolios were steadier. WavRyder-adjusted portfolios used a defense-first approach that, in past periods, helped limit the biggest annual drops.
                            </div>
                        </div>
                    </div>
                </div>

            <!-- WavRyder Learn More Button #2 -->
            <div style="text-align: center; margin: 40px auto 50px auto;">
                <a href="https://wavryder.com" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
                    <div style="display: inline-flex; align-items: center; gap: 12px; 
                                background: linear-gradient(135deg, #ffffff, #f8f9fa); 
                                border: 2px solid #2196f3; border-radius: 12px; 
                                padding: 16px 32px; transition: all 0.3s ease;
                                box-shadow: 0 4px 12px rgba(33, 150, 243, 0.15);
                                cursor: pointer;"
                         onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 6px 20px rgba(33, 150, 243, 0.25)';"
                         onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(33, 150, 243, 0.15)';">
                        <img src="data:image/png;base64,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" 
                             alt="WavRyder Logo" style="height: 24px; width: auto;">
                        <span style="font-size: 15px; font-weight: 600; color: #1565c0;">
                            Want to learn more about WavRyder's methodology? Visit WavRyder.com
                        </span>
                    </div>
                </a>
            </div>
            
                <!-- Advanced Risk Metrics - Collapsible Section -->
                <div style="text-align: center; margin: 30px 0 15px 0;">
                    <button onclick="toggleRiskMetrics()" id="riskMetricsToggleBtn" 
                            style="padding: 12px 28px; background: linear-gradient(135deg, #667eea, #764ba2); 
                                   color: white; border: none; border-radius: 8px; font-size: 15px; 
                                   font-weight: 600; cursor: pointer; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
                                   transition: all 0.3s;">
                        üìä Show Advanced Risk Metrics
                    </button>
                </div>
                
                <div id="riskMetricsSection" style="display: none;">
                    <div class="section-header" style="margin-top: 5px;">Hypothetical Advanced Risk Metrics</div>
                <div style="text-align: center; font-size: 13px; color: #666; font-style: italic; margin-top: 3px; margin-bottom: 8px;">
                    <span id="portfolio1DescriptionRisk">Current Portfolio</span> vs <span id="portfolio2DescriptionRisk">Modeled Portfolio</span>
                </div>
                <div id="riskMetricsContent" style="background: #fafbfc; padding: 12px; border-radius: 8px; margin-top: 6px;">
                    <div class="metrics-container">
                        <div class="metric-card">
                            <div class="metric-title">Beta (vs S&amp;P 500)</div>
                            <table class="metric-table">
                                <tbody><tr>
                                    <td id="col2Label3">Modeled:</td>
                                    <td class="neutral" id="option2Beta">0.00</td>
                                </tr><tr>
                                    <td id="col1Label3">Current:</td>
                                    <td class="neutral" id="option1Beta">0.00</td>
                                </tr>
                                
                                <tr>
                                    <td>Difference:</td>
                                    <td class="positive" id="betaDiff">0.00</td>
                                </tr>
                            </tbody></table>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title">Expected Return</div>
                            <table class="metric-table">
                                <tbody><tr>
                                    <td id="col2Label4">Modeled:</td>
                                    <td class="neutral" id="option2ExpReturn">0.0%</td>
                                </tr><tr>
                                    <td id="col1Label4">Current:</td>
                                    <td class="neutral" id="option1ExpReturn">0.0%</td>
                                </tr>
                                
                                <tr>
                                    <td>Difference:</td>
                                    <td class="positive" id="expReturnDiff">0.0%</td>
                                </tr>
                            </tbody></table>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title">Alpha (vs S&amp;P 500)</div>
                            <table class="metric-table">
                                <tbody><tr>
                                    <td id="col2Label5">Modeled:</td>
                                    <td class="neutral" id="option2Alpha">0.0%</td>
                                </tr><tr>
                                    <td id="col1Label5">Current:</td>
                                    <td class="neutral" id="option1Alpha">0.0%</td>
                                </tr>
                                
                                <tr>
                                    <td>Difference:</td>
                                    <td class="positive" id="alphaDiff">0.0%</td>
                                </tr>
                            </tbody></table>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title">Sharpe Ratio</div>
                            <table class="metric-table">
                                <tbody><tr>
                                    <td id="col2Label6">Modeled:</td>
                                    <td class="neutral" id="option2Sharpe">0.00</td>
                                </tr><tr>
                                    <td id="col1Label6">Current:</td>
                                    <td class="neutral" id="option1Sharpe">0.00</td>
                                </tr>
                                
                                <tr>
                                    <td>Difference:</td>
                                    <td class="positive" id="sharpeDiff">0.00</td>
                                </tr>
                            </tbody></table>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title">Sortino Ratio</div>
                            <table class="metric-table">
                                <tbody><tr>
                                    <td id="col2Label7">Modeled:</td>
                                    <td class="neutral" id="option2Sortino">0.00</td>
                                </tr><tr>
                                    <td id="col1Label7">Current:</td>
                                    <td class="neutral" id="option1Sortino">0.00</td>
                                </tr>
                                
                                <tr>
                                    <td>Difference:</td>
                                    <td class="positive" id="sortinoDiff">0.00</td>
                                </tr>
                            </tbody></table>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title">Treynor Ratio</div>
                            <table class="metric-table">
                                <tbody><tr>
                                    <td id="col2Label8">Modeled:</td>
                                    <td class="neutral" id="option2Treynor">0.000</td>
                                </tr><tr>
                                    <td id="col1Label8">Current:</td>
                                    <td class="neutral" id="option1Treynor">0.000</td>
                                </tr>
                                
                                <tr>
                                    <td>Difference:</td>
                                    <td class="positive" id="treynorDiff">0.000</td>
                                </tr>
                            </tbody></table>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title">Volatility (Std Dev)</div>
                            <table class="metric-table">
                                <tbody><tr>
                                    <td id="col2Label9">Modeled:</td>
                                    <td class="neutral" id="option2Vol">0.00%</td>
                                </tr><tr>
                                    <td id="col1Label9">Current:</td>
                                    <td class="neutral" id="option1Vol">0.00%</td>
                                </tr>
                                
                                <tr>
                                    <td>Difference:</td>
                                    <td class="positive" id="volDiff">0.00%</td>
                                </tr>
                            </tbody></table>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title">Win Rate</div>
                            <table class="metric-table">
                                <tbody><tr>
                                    <td id="col2Label10">Modeled:</td>
                                    <td class="neutral" id="option2WinRate">0.0%</td>
                                </tr>
                                <tr>
                                    <td id="col1Label10">Current:</td>
                                    <td class="neutral" id="option1WinRate">0.0%</td>
                                </tr>
                                <tr>
                                    <td>Difference:</td>
                                    <td class="positive" id="winRateDiff">0.0%</td>
                                </tr>
                            </tbody></table>
                        </div>
                    </div>
                    <div style="text-align: center; font-size: 11px; color: #999; font-style: italic; margin-top: 6px;">
                        Sharpe, Sortino, Alpha &amp; Beta use 3% risk-free rate. S&amp;P 500 benchmark. Calculated from annual returns.
                    </div>
                    
                    <div style="margin-top: 12px; padding: 10px; background: #f8f9fa; border-radius: 6px; font-size: 12px; line-height: 1.5;">
                        <div style="font-weight: 600; color: #1a1a1a; margin-bottom: 6px;">Ratio Definitions:</div>
                        <div style="color: #495057;">
                            <strong>Beta:</strong> Volatility vs S&amp;P 500; &lt;1.0 = less volatile, &gt;1.0 = more volatile.<br>
                            <strong>Expected Return:</strong> Return predicted by CAPM given the portfolio's risk level (Beta).<br>
                            <strong>Alpha:</strong> Excess return vs risk-adjusted benchmark; positive means outperformance.<br>
                            <strong>Sharpe:</strong> Risk-adjusted return using total volatility; higher is better.<br>
                            <strong>Sortino:</strong> Like Sharpe but only penalizes downside volatility; higher is better.<br>
                            <strong>Treynor:</strong> Return per unit of market risk (Beta); higher is better.<br>
                            <strong>Volatility:</strong> Standard deviation of returns; lower means more stable.<br>
                            <strong>Win Rate:</strong> Percentage of positive years; higher means more consistent gains.
                        </div>
                    </div>
                    
                    <!-- Risk Metrics Disclaimer -->
                    <div style="margin-top: 12px; padding: 12px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 6px; font-size: 12px; line-height: 1.5;">
                        <div style="font-weight: 600; color: #856404; margin-bottom: 6px;">‚ö†Ô∏è Risk Metrics Disclaimer:</div>
                        <div style="color: #856404;">
                            All risk metrics are calculated from historical data (<span id="riskMetricsYearRange">2005-2025</span>) and may not reflect future performance. 
                            Actual risk and returns will vary based on market conditions, fees, taxes, and individual circumstances. 
                            These metrics are for educational comparison purposes only.
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Risk Metrics Collapsible Section -->
            
            <!-- Footnotes Section - Phase 2 Priority 6 -->
            <div id="footnotesSection" style="display: none; margin: 30px auto 20px auto; padding: 20px; background: #f0f7ff; border-radius: 10px; border-left: 4px solid #2196f3; max-width: 900px;">
                <h4 style="color: #1565c0; font-size: 16px; font-weight: 700; margin: 0 0 15px 0;">
                    üìå Footnotes
                </h4>
                <div id="footnotesContent" style="color: #495057; font-size: 13px; line-height: 1.8;">
                    <!-- Footnotes will be dynamically inserted here -->
                </div>
            </div>
            
            <!-- Final Comprehensive Disclaimer -->
            <div style="margin: 30px auto 20px auto; padding: 20px; background: #f8f9fa; border-radius: 10px; border: 2px solid #dee2e6; max-width: 900px;">
                <h4 style="color: #495057; font-size: 16px; font-weight: 700; margin: 0 0 12px 0; text-align: center;">
                    üìã COMPREHENSIVE DISCLOSURE
                </h4>
                <div style="color: #6c757d; font-size: 12px; line-height: 1.6; text-align: left;">
                    <p style="margin: 0 0 10px 0;">
                        <strong>Hypothetical and Backtested Results:</strong> The performance data presented is based on hypothetical, backtested historical analysis and does not represent actual trading results. Backtested performance is developed with the benefit of hindsight and has inherent limitations. No representation is being made that any account will or is likely to achieve profits or losses similar to those shown.
                    </p>
                    <p style="margin: 0 0 10px 0;">
                        <strong>Investment Risk:</strong> All investments involve risk, including the potential loss of principal. Different investment strategies and asset classes involve varying levels of risk. There can be no assurance that any strategy or portfolio model will be profitable or appropriate for any particular individual.
                    </p>
                    <p style="margin: 0 0 10px 0;">
                        <strong>No Guarantee of Results:</strong> Past performance is not indicative of future results. Market conditions change over time, and historical returns may not be repeated. Actual results will vary based on market conditions, timing, fees, taxes, and other factors.
                    </p>
                    <p style="margin: 0 0 10px 0;">
                        <strong>Fees and Expenses:</strong> The results shown do not reflect the impact of management fees, advisory fees, trading costs, or other expenses that would reduce returns. Fees and expenses have a compounding effect and can significantly reduce investment returns over time.
                    </p>
                    <p style="margin: 0 0 10px 0;">
                        <strong>Tax Considerations:</strong> Results do not reflect the impact of taxes. Tax consequences can materially affect investment outcomes and vary based on individual circumstances and account type.
                    </p>
                    <p style="margin: 0 0 0 0;">
                        <strong>No Investment Advice:</strong> This tool is provided solely for educational and informational purposes and should not be construed as investment advice or a recommendation. Users should consider consulting a qualified financial advisor or other professional before making investment decisions. WavRyder and its affiliates are not responsible for investment decisions made based on information presented by this tool.
                    </p>
                </div>
            </div>
            
            <!-- WavRyder Learn More Button #3 -->
            <div style="text-align: center; margin: 40px auto 50px auto;">
                <a href="https://wavryder.com" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
                    <div style="display: inline-flex; align-items: center; gap: 12px; 
                                background: linear-gradient(135deg, #ffffff, #f8f9fa); 
                                border: 2px solid #2196f3; border-radius: 12px; 
                                padding: 16px 32px; transition: all 0.3s ease;
                                box-shadow: 0 4px 12px rgba(33, 150, 243, 0.15);
                                cursor: pointer;"
                         onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 6px 20px rgba(33, 150, 243, 0.25)';"
                         onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(33, 150, 243, 0.15)';">
                        <img src="data:image/png;base64,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" 
                             alt="WavRyder Logo" style="height: 24px; width: auto;">
                        <span style="font-size: 15px; font-weight: 600; color: #1565c0;">
                            Want to learn more about WavRyder's methodology? Visit WavRyder.com
                        </span>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <script>
        // ============================================================================
        // DATA FLOW EXPLANATION (SIMPLIFIED):
        // 1. On page load: excelData is initialized from EXCEL_DATA (hard-coded in HTML)
        // 2. User visits URL#update: "Update Tool Data" section becomes visible
        // 3. User uploads new Excel: 
        //    - File is parsed and validated
        //    - New EXCEL_DATA is immediately baked into HTML code
        //    - Updated index.html auto-downloads
        //    - User replaces file and refreshes
        // 4. Page reloads with new EXCEL_DATA baked in
        // 
        // KEY POINT: No temporary memory storage - data goes straight into HTML code!
        // ============================================================================
        
        const DATA_FILE_LOADED = typeof EXCEL_DATA !== 'undefined';
        
        // Commentary cycling system
        let commentaryIndex = 0;
        const commentaryVersions = [
            "Historically, portfolios with more stocks went up more but also fell harder, while conservative portfolios were steadier. WavRyder-adjusted portfolios used a defense-first approach that, in past periods, was associated with smaller worst annual declines.",
            "Over the years, riskier portfolios had bigger swings, while conservative ones were more stable. WavRyder-adjusted portfolios applied a defense-first strategy that historically was associated with smaller worst yearly losses.",
            "Portfolios with more equity generally grew faster but were more volatile. In these examples, WavRyder-adjusted portfolios focused on defense-first allocation, which in past periods corresponded with reduced largest annual declines.",
            "Historically, more aggressive portfolios earned more but bounced around a lot. In these examples, WavRyder's defense-first methodology was historically associated with smaller worst yearly declines.",
            "High-stock portfolios had bigger ups and downs, and conservative portfolios were calmer. WavRyder-adjusted portfolios used a defense-first approach that, historically, was associated with moderated worst annual drawdowns."
        ];
        
        function cycleCommentary() {
            commentaryIndex = (commentaryIndex + 1) % commentaryVersions.length;
            const commentaryText = document.getElementById('commentaryText');
            const commentaryBlock = document.getElementById('interpretationBlock');
            
            if (commentaryText && commentaryBlock) {
                // Fade out
                commentaryBlock.style.opacity = '0.3';
                commentaryBlock.style.transform = 'translateY(-5px)';
                
                setTimeout(() => {
                    commentaryText.textContent = commentaryVersions[commentaryIndex];
                    // Fade in
                    commentaryBlock.style.opacity = '1';
                    commentaryBlock.style.transform = 'translateY(0)';
                }, 300);
            }
        }
        
        // ============================================================================
        // ENHANCED DYNAMIC COMMENTARY - Phase 2 Priority 4
        // ============================================================================
        
        function generateEnhancedCommentary(performance, portfolios, years) {
            const commentaryText = document.getElementById('commentaryText');
            const commentaryBlock = document.getElementById('interpretationBlock');
            
            if (!commentaryText || !commentaryBlock) return;
            
            // Calculate performance differences
            const cagrDiff = ((performance.cagr2 - performance.cagr1) * 100).toFixed(2);
            const fvDiff = performance.fv2 - performance.fv1;
            const ddDiff = ((performance.dd2 - performance.dd1) * 100).toFixed(2);
            
            // Determine performance context
            const modeledOutperformed = performance.cagr2 > performance.cagr1;
            const betterDrawdown = performance.dd2 > performance.dd1; // Higher (less negative) is better
            
            // Build contextual narrative
            let narrative = '';
            
            // Performance comparison
            if (modeledOutperformed) {
                narrative += `Over the ${years}-year period, the Modeled portfolio outperformed the Current portfolio with a CAGR of ${(performance.cagr2 * 100).toFixed(2)}% compared to ${(performance.cagr1 * 100).toFixed(2)}%, a difference of ${cagrDiff} percentage points annually. `;
            } else {
                narrative += `Over the ${years}-year period, the Current portfolio achieved a CAGR of ${(performance.cagr1 * 100).toFixed(2)}% compared to the Modeled portfolio's ${(performance.cagr2 * 100).toFixed(2)}%. `;
            }
            
            // Investment growth context
            const fvDiffFormatted = Math.abs(fvDiff).toLocaleString('en-US', {style: 'currency', currency: 'USD', maximumFractionDigits: 0});
            if (fvDiff > 0) {
                narrative += `A $100,000 investment in the Modeled portfolio would have grown to ${performance.fv2.toLocaleString('en-US', {style: 'currency', currency: 'USD', maximumFractionDigits: 0})}, ${fvDiffFormatted} more than the Current portfolio. `;
            } else if (fvDiff < 0) {
                narrative += `The Current portfolio showed stronger absolute growth. `;
            }
            
            // Drawdown / risk context
            if (betterDrawdown) {
                narrative += `Notably, the Modeled portfolio demonstrated better downside protection with a maximum annual drawdown of ${(performance.dd2 * 100).toFixed(2)}% compared to ${(performance.dd1 * 100).toFixed(2)}% for the Current portfolio, suggesting more effective risk management during market downturns.`;
            } else {
                narrative += `The Current portfolio experienced a maximum annual drawdown of ${(performance.dd1 * 100).toFixed(2)}% compared to ${(performance.dd2 * 100).toFixed(2)}% for the Modeled portfolio.`;
            }
            
            // Fade out and update
            commentaryBlock.style.opacity = '0.3';
            commentaryBlock.style.transform = 'translateY(-5px)';
            
            setTimeout(() => {
                commentaryText.textContent = narrative;
                // Fade in
                commentaryBlock.style.opacity = '1';
                commentaryBlock.style.transform = 'translateY(0)';
            }, 300);
        }
        
        // ============================================================================
        // FOOTNOTES PARSING AND DISPLAY - Phase 2 Priority 6
        // ============================================================================
        
        /**
         * Parse footnotes from Excel data
         * Expects a "Footnotes" sheet or special rows at the end of main sheet
         * Format: Column A = Footnote text, or row starting with "Footnote:"
         */
        function parseAndDisplayFootnotes(workbook) {
            const footnotes = [];
            
            // Try to find Footnotes sheet
            if (workbook && workbook.SheetNames.includes('Footnotes')) {
                const footnotesSheet = workbook.Sheets['Footnotes'];
                const footnotesData = XLSX.utils.sheet_to_json(footnotesSheet, {header: 1});
                
                footnotesData.forEach((row, index) => {
                    if (row && row[0] && row[0].toString().trim()) {
                        footnotes.push({
                            number: index + 1,
                            text: row[0].toString().trim()
                        });
                    }
                });
            }
            
            // Display footnotes if any found
            if (footnotes.length > 0) {
                const footnotesSection = document.getElementById('footnotesSection');
                const footnotesContent = document.getElementById('footnotesContent');
                
                let footnotesHTML = '';
                footnotes.forEach(fn => {
                    footnotesHTML += `
                        <p style="margin: 0 0 10px 0;">
                            <sup style="font-weight: 700; color: #2196f3; margin-right: 6px;">[${fn.number}]</sup>
                            <span>${fn.text}</span>
                        </p>
                    `;
                });
                
                footnotesContent.innerHTML = footnotesHTML;
                footnotesSection.style.display = 'block';
            }
        }
        
        // Initialize working data from hard-coded EXCEL_DATA
        let excelData = EXCEL_DATA;
        let columnHeaders = [];
        let yearsValue = 20; // Default, will be read from A17
        let growthChart = null; // Chart.js instance
        
        // Aha Card configuration (can be overridden from Excel)
        let ahaCardConfig = {
            title: "Here's What the Data Shows",
            button1: "üìß Email Me These Results",
            button2: "üìÖ Talk to a WavRyder Advisor",
            subtext: "Free consultation ‚Ä¢ No obligation ‚Ä¢ See if WavRyder is right for you"
        };
        
        // Function to process Excel data (used by both file upload and data file)
        function processExcelData(jsonData) {
            excelData = jsonData;
            
            // Read years value from A17 (row 17, column 0)
            if (jsonData[16] && jsonData[16][0]) {
                yearsValue = parseFloat(jsonData[16][0]);
            }
            
            // Parse headers - create array of objects with index and name
            columnHeaders = [];
            const letterRow = jsonData[0]; // Row with letters like "A", "B", "C", etc.
            const nameRow = jsonData[1]; // Row with names like "60/40", "WavRyder QQQ", etc.
            
            // Add options from column headers (skip first two: "Performance Measure" and empty)
            for (let i = 2; i < nameRow.length; i++) {
                if (nameRow[i]) {
                    columnHeaders.push({
                        letter: letterRow[i] || `Col${i}`,
                        index: i,
                        name: nameRow[i]
                    });
                }
            }
            
            // Parse Aha Card configuration from Excel (rows 82-86)
            // Row 82: Header "AHA CARD CONFIG"
            // Row 83: Section Title (Column B)
            // Row 84: Button 1 Text (Column B)
            // Row 85: Button 2 Text (Column B)
            // Row 86: Subtext (Column B)
            if (jsonData.length > 86) {
                if (jsonData[82] && jsonData[82][1]) {
                    ahaCardConfig.title = jsonData[82][1];
                }
                if (jsonData[83] && jsonData[83][1]) {
                    ahaCardConfig.button1 = jsonData[83][1];
                }
                if (jsonData[84] && jsonData[84][1]) {
                    ahaCardConfig.button2 = jsonData[84][1];
                }
                if (jsonData[85] && jsonData[85][1]) {
                    ahaCardConfig.subtext = jsonData[85][1];
                }
                console.log('‚úì Loaded Aha Card config from Excel:', ahaCardConfig);
            }
            
            // Parse Model Availability Settings from Excel (rows 56+)
            if (jsonData.length >= 57) {
                try {
                    MODEL_CONFIG.portfolio1 = [];
                    MODEL_CONFIG.portfolio2 = [];
                    
                    let configRow = 56; // Excel row 57 = JS index 56
                    while (configRow < jsonData.length && jsonData[configRow]) {
                        const modelName = jsonData[configRow][0];
                        const showInCurrent = (jsonData[configRow][1] || '').toString().toUpperCase();
                        const showInModeled = (jsonData[configRow][2] || '').toString().toUpperCase();
                        
                        // Stop if we hit empty row or next section
                        if (!modelName || modelName.toString().includes('USER INSTRUCTIONS') || 
                            modelName.toString().includes('AHA CARD')) {
                            break;
                        }
                        
                        // Find this model's column index
                        const header = columnHeaders.find(h => h.name === modelName);
                        if (header) {
                            if (showInCurrent === 'YES') {
                                MODEL_CONFIG.portfolio1.push(header.index);
                            }
                            if (showInModeled === 'YES') {
                                MODEL_CONFIG.portfolio2.push(header.index);
                            }
                        }
                        
                        configRow++;
                    }
                    console.log('‚úÖ Loaded model availability from Excel');
                    console.log('Current portfolio models:', MODEL_CONFIG.portfolio1);
                    console.log('Modeled portfolio models:', MODEL_CONFIG.portfolio2);
                } catch (e) {
                    console.error('Error reading model config:', e);
                }
            }
            
            // Populate dropdowns with filtering based on MODEL_CONFIG
            populateSelectors();
        }
        
        // Auto-load data from performance_data.js if available
        if (DATA_FILE_LOADED) {
            window.addEventListener('DOMContentLoaded', () => {
                // Update all date displays on page load
                updateDateDisplays();
                
                processExcelData(EXCEL_DATA);
                
                // Show portfolio containers since data is loaded
                document.getElementById('portfolio1Container').style.display = 'block';
                document.getElementById('portfolio2Container').style.display = 'block';
                
                // Hide the upload button since data is already loaded
                const uploadRow = document.querySelector('.upload-row');
                if (uploadRow) {
                    uploadRow.style.display = 'none';
                }
                
                // Check if URL has #update - show update section only for admin
                const updateSection = document.getElementById('updateDataSection');
                if (updateSection) {
                    if (window.location.hash === '#update') {
                        updateSection.classList.add('visible');
                    } else {
                        updateSection.classList.remove('visible');
                    }
                }
                
                // Also listen for hash changes to hide/show dynamically
                window.addEventListener('hashchange', function() {
                    const updateSection = document.getElementById('updateDataSection');
                    if (updateSection) {
                        if (window.location.hash === '#update') {
                            updateSection.classList.add('visible');
                        } else {
                            updateSection.classList.remove('visible');
                        }
                    }
                });
                
                // Initialize Advanced Metrics visibility
                initializeAdvancedMetricsVisibility();
                
                // Check if URL has #local - show copy buttons for local testing
                if (window.location.hash === '#local') {
                    const copyButtons = document.getElementById('copyButtonsContainer');
                    if (copyButtons) {
                        copyButtons.style.display = 'block';
                    }
                }
                
                // Check disclaimer acceptance - show modal if not accepted or if #show-disclaimer in URL
                const disclaimerAccepted = localStorage.getItem('disclaimerAccepted');
                const forceShowDisclaimer = window.location.hash === '#show-disclaimer';
                
                if (!disclaimerAccepted || forceShowDisclaimer) {
                    showDisclaimerModal();
                }
                
                const successMsg = document.getElementById('successMessage');
                successMsg.textContent = '‚úì Performance data loaded successfully!';
                successMsg.style.display = 'block';
            });
            
            // Function to show disclaimer modal
            function showDisclaimerModal() {
                const modal = document.getElementById('disclaimerModal');
                if (modal) {
                    // Update modal dates
                    const modalStartDate = document.getElementById('modalStartDate');
                    const modalEndDate = document.getElementById('modalEndDate');
                    if (modalStartDate) modalStartDate.textContent = DATA_START_DATE;
                    if (modalEndDate) modalEndDate.textContent = DATA_END_DATE;
                    
                    modal.style.display = 'block';
                    document.body.style.overflow = 'hidden'; // Prevent scrolling behind modal
                }
            }
            
            // Function to hide disclaimer modal
            function hideDisclaimerModal() {
                const modal = document.getElementById('disclaimerModal');
                if (modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = ''; // Restore scrolling
                }
            }
            
            // Accept disclaimer button handler
            document.getElementById('acceptDisclaimerBtn').addEventListener('click', function() {
                // Save acceptance to localStorage
                localStorage.setItem('disclaimerAccepted', 'true');
                localStorage.setItem('disclaimerAcceptedDate', new Date().toISOString());
                
                // Hide modal
                hideDisclaimerModal();
            });
            
            // Function to update all date displays throughout the page
            function updateDateDisplays() {
                // Extract start year from DATA_YEAR_RANGE (e.g., "2005-2025" -> "2005")
                const startYear = DATA_YEAR_RANGE.split('-')[0];
                
                // Update all dynamic date spans
                const dateElements = [
                    { id: 'modalStartDate', value: DATA_START_DATE },
                    { id: 'modalEndDate', value: DATA_END_DATE },
                    { id: 'headerStartDate', value: DATA_START_DATE },
                    { id: 'headerEndDate', value: DATA_END_DATE },
                    { id: 'headerYearsCount', value: DATA_YEARS_COUNT },
                    { id: 'sectionYearsCount', value: DATA_YEARS_COUNT },
                    { id: 'sectionYearRange', value: DATA_YEAR_RANGE },
                    { id: 'methodologyYearRange', value: DATA_YEAR_RANGE },
                    { id: 'chartYearRange', value: DATA_YEAR_RANGE },
                    { id: 'riskMetricsYearRange', value: DATA_YEAR_RANGE },
                    { id: 'subtitleYear', value: startYear }
                ];
                
                dateElements.forEach(elem => {
                    const element = document.getElementById(elem.id);
                    if (element) {
                        element.textContent = elem.value;
                    }
                });
            }
        }
        
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const errorMsg = document.getElementById('errorMessage');
            const successMsg = document.getElementById('successMessage');
            
            errorMsg.style.display = 'none';
            successMsg.style.display = 'none';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, {header: 1});
                    
                    if (jsonData.length < 2) {
                        throw new Error('Excel file must have at least 2 rows');
                    }
                    
                    excelData = jsonData;
                    
                    // Read years value from A17 (row 17, column A = index [16][0])
                    if (jsonData[16] && jsonData[16][0]) {
                        yearsValue = parseFloat(jsonData[16][0]);
                        if (isNaN(yearsValue) || yearsValue <= 0) {
                            yearsValue = 20; // Fallback to 20 if invalid
                        }
                    }
                    
                    // Parse headers - automatically detect all available columns
                    columnHeaders = [];
                    const letterRow = jsonData[0];
                    const nameRow = jsonData[1];
                    
                    // Start from column 2 (index 2) and check all columns until we hit empty ones
                    for (let i = 2; i < letterRow.length; i++) {
                        // Include column if it has either a letter OR a name (more flexible)
                        if (letterRow[i] || nameRow[i]) {
                            columnHeaders.push({
                                letter: letterRow[i] || `Col${i}`,
                                name: nameRow[i] || letterRow[i] || `Column ${i}`,
                                index: i
                            });
                        }
                    }
                    
                    // Also check if there are more columns beyond the current length
                    // by looking at the data rows to find the actual last column with data
                    let maxCol = letterRow.length;
                    for (let rowIdx = 2; rowIdx < Math.min(15, jsonData.length); rowIdx++) {
                        if (jsonData[rowIdx] && jsonData[rowIdx].length > maxCol) {
                            maxCol = jsonData[rowIdx].length;
                        }
                    }
                    
                    // Add any additional columns found in data rows
                    for (let i = letterRow.length; i < maxCol; i++) {
                        // Check if this column has data in any of the first few data rows
                        let hasData = false;
                        for (let rowIdx = 2; rowIdx < Math.min(15, jsonData.length); rowIdx++) {
                            if (jsonData[rowIdx] && jsonData[rowIdx][i]) {
                                hasData = true;
                                break;
                            }
                        }
                        
                        if (hasData) {
                            columnHeaders.push({
                                letter: `Col${String.fromCharCode(65 + i - 2)}`,
                                name: `Column ${String.fromCharCode(65 + i - 2)}`,
                                index: i
                            });
                        }
                    }
                    
                    if (columnHeaders.length === 0) {
                        throw new Error('No valid options found in Excel file');
                    }
                    
                    // Note: populateSelectors() is called AFTER MODEL_CONFIG loads from Excel (see below)
                    // This ensures dropdowns are filtered correctly
                    
                    // ==========================================
                    // READ CONFIGURATION SECTIONS (Row 45+)
                    // ==========================================
                    
                    // SECTION 1: Scenario Configurations (Rows 48-51 in Excel = indices 47-50 in JS)
                    if (jsonData.length >= 51) {
                        try {
                            for (let i = 0; i < 4; i++) {
                                const rowIndex = 47 + i; // Excel rows 48-51 = JS indices 47-50
                                const row = jsonData[rowIndex];
                                if (row && row[1] && row[2]) { // Has title and description
                                    const scenarioNum = i + 1;
                                    const scenarioKey = `scenario${scenarioNum}`;
                                    
                                    // Find column indices by name
                                    function findColumnIndex(colName) {
                                        if (!colName || colName === 'None' || colName === '') return null;
                                        // Trim whitespace and do case-insensitive search
                                        const cleanName = colName.toString().trim();
                                        const header = columnHeaders.find(h => 
                                            h.name.toString().trim().toLowerCase() === cleanName.toLowerCase()
                                        );
                                        if (!header) {
                                            console.warn(`‚ö†Ô∏è Column "${cleanName}" not found in headers`);
                                        }
                                        return header ? header.index : null;
                                    }
                                    
                                    const newConfig = {
                                        title: row[1],
                                        desc: row[2],
                                        portfolio1: {
                                            option1: findColumnIndex(row[3]),
                                            alloc1: parseInt(row[4]) || 0,
                                            option2: findColumnIndex(row[5]),
                                            alloc2: parseInt(row[6]) || 0,
                                            option5: null,
                                            alloc5: 0,
                                            option6: null,
                                            alloc6: 0
                                        },
                                        portfolio2: {
                                            option3: findColumnIndex(row[7]),
                                            alloc3: parseInt(row[8]) || 0,
                                            option4: findColumnIndex(row[9]),
                                            alloc4: parseInt(row[10]) || 0,
                                            option7: null,
                                            alloc7: 0,
                                            option8: null,
                                            alloc8: 0
                                        }
                                    };
                                    
                                    SCENARIO_CONFIG[scenarioKey] = newConfig;
                                    
                                    // Update button text in DOM
                                    const titleEl = document.getElementById(`${scenarioKey}_title`);
                                    const descEl = document.getElementById(`${scenarioKey}_desc`);
                                    if (titleEl) titleEl.textContent = row[1];
                                    if (descEl) descEl.textContent = row[2];
                                    
                                    console.log(`‚úÖ Loaded ${scenarioKey}:`, newConfig);
                                }
                            }
                            
                            // Note: No localStorage - Excel is the single source of truth
                            // To persist changes, export HTML after uploading Excel
                        } catch (e) {
                            console.error('Error reading scenario config:', e);
                        }
                    }
                    
                    // SECTION 2: Model Availability (Row 57+ in Excel = index 56+ in JS, after header at index 55)
                    if (jsonData.length >= 57) {
                        try {
                            MODEL_CONFIG.portfolio1 = [];
                            MODEL_CONFIG.portfolio2 = [];
                            
                            let configRow = 56; // Excel row 57 = JS index 56
                            while (configRow < jsonData.length && jsonData[configRow]) {
                                const modelName = jsonData[configRow][0];
                                const showInCurrent = (jsonData[configRow][1] || '').toString().toUpperCase();
                                const showInModeled = (jsonData[configRow][2] || '').toString().toUpperCase();
                                
                                // Stop if we hit empty row or next section
                                if (!modelName || modelName.toString().includes('USER INSTRUCTIONS')) {
                                    break;
                                }
                                
                                // Find this model's column index
                                const header = columnHeaders.find(h => h.name === modelName);
                                if (header) {
                                    if (showInCurrent === 'YES') {
                                        MODEL_CONFIG.portfolio1.push(header.index);
                                    }
                                    if (showInModeled === 'YES') {
                                        MODEL_CONFIG.portfolio2.push(header.index);
                                    }
                                }
                                
                                configRow++;
                            }
                            console.log('‚úÖ Loaded model availability from Excel');
                            console.log('Current models:', MODEL_CONFIG.portfolio1);
                            console.log('Modeled models:', MODEL_CONFIG.portfolio2);
                            
                            // Update checkboxes in #update section to match Excel config
                            columnHeaders.forEach(header => {
                                const p1Checkbox = document.getElementById(`p1_${header.index}`);
                                const p2Checkbox = document.getElementById(`p2_${header.index}`);
                                
                                if (p1Checkbox) {
                                    p1Checkbox.checked = MODEL_CONFIG.portfolio1.includes(header.index);
                                }
                                if (p2Checkbox) {
                                    p2Checkbox.checked = MODEL_CONFIG.portfolio2.includes(header.index);
                                }
                            });
                            console.log('‚úÖ Updated checkboxes to match Excel config');
                            
                            // Note: No localStorage - Excel is the single source of truth
                            // To persist changes, export HTML after uploading Excel
                            
                            // Re-populate selectors with new model config
                            populateSelectors();
                        } catch (e) {
                            console.error('Error reading model config:', e);
                            // If config reading failed, still populate with defaults
                            populateSelectors();
                        }
                    } else {
                        // No MODEL_CONFIG section in Excel, use defaults
                        console.log('‚ö†Ô∏è No MODEL_CONFIG section found in Excel, using defaults');
                        populateSelectors();
                    }
                    
                    // SECTION 3: User Instructions (Row 79 in Excel = index 78 in JS)
                    if (jsonData.length >= 79 && jsonData[78] && jsonData[78][0]) {
                        try {
                            const instructionsText = jsonData[78][0];
                            const instructionsEl = document.getElementById('customInstructions');
                            if (instructionsEl && instructionsText) {
                                instructionsEl.innerHTML = instructionsText;
                                console.log('‚úÖ Loaded custom instructions from Excel');
                            }
                        } catch (e) {
                            console.error('Error reading instructions:', e);
                        }
                    }
                    
                    // SECTION 4: Refresh #update UI to show loaded configurations
                    if (window.location.hash === '#update') {
                        // Refresh scenario input boxes
                        setTimeout(() => {
                            loadScenarioInputs();
                        }, 100);
                        
                        // Refresh model checkbox table
                        setTimeout(() => {
                            populateModelConfigTable();
                        }, 150);
                        
                        // Update Advanced Metrics visibility checkbox
                        setTimeout(() => {
                            const checkbox = document.getElementById('showAdvancedMetrics');
                            if (checkbox) {
                                checkbox.checked = SHOW_ADVANCED_METRICS;
                            }
                        }, 200);
                    }
                    
                    // Also update scenario button texts in main interface
                    Object.keys(SCENARIO_CONFIG).forEach(key => {
                        const titleEl = document.getElementById(`${key}_title`);
                        const descEl = document.getElementById(`${key}_desc`);
                        if (titleEl) titleEl.textContent = SCENARIO_CONFIG[key].title;
                        if (descEl) descEl.textContent = SCENARIO_CONFIG[key].desc;
                    });
                    
                    successMsg.textContent = `‚úì File loaded! Found ${columnHeaders.length} options.`;
                    successMsg.style.display = 'block';
                    document.getElementById('selectorRow').style.display = 'flex';
                    document.getElementById('selectorRow2').style.display = 'flex';
                    
                    setTimeout(() => {
                        successMsg.style.display = 'none';
                    }, 3000);
                    
                } catch (error) {
                    errorMsg.textContent = '‚ùå Error: ' + error.message;
                    errorMsg.style.display = 'block';
                }
            };
            
            reader.onerror = function() {
                errorMsg.textContent = '‚ùå Error reading file';
                errorMsg.style.display = 'block';
            };
            
            reader.readAsArrayBuffer(file);
        });
        
        function populateSelectors() {
            const option1Select = document.getElementById('option1Select');
            const option2Select = document.getElementById('option2Select');
            const option3Select = document.getElementById('option3Select');
            const option4Select = document.getElementById('option4Select');
            const option5Select = document.getElementById('option5Select');
            const option6Select = document.getElementById('option6Select');
            const option7Select = document.getElementById('option7Select');
            const option8Select = document.getElementById('option8Select');
            
            option1Select.innerHTML = '<option value="">-- Select --</option>';
            option2Select.innerHTML = '<option value="">-- Select --</option>';
            option3Select.innerHTML = '<option value="">-- Select --</option>';
            option4Select.innerHTML = '<option value="">-- Select --</option>';
            option5Select.innerHTML = '<option value="">-- Select --</option>';
            option6Select.innerHTML = '<option value="">-- Select --</option>';
            option7Select.innerHTML = '<option value="">-- Select --</option>';
            option8Select.innerHTML = '<option value="">-- Select --</option>';
            
            columnHeaders.forEach((header) => {
                // Portfolio 1 rows (option1, option2, option5, option6) - filter by MODEL_CONFIG.portfolio1
                if (MODEL_CONFIG.portfolio1.includes(header.index)) {
                    const opt1 = document.createElement('option');
                    opt1.value = header.index;
                    opt1.textContent = header.name;
                    option1Select.appendChild(opt1);
                    
                    const opt2 = document.createElement('option');
                    opt2.value = header.index;
                    opt2.textContent = header.name;
                    option2Select.appendChild(opt2);
                    
                    const opt5 = document.createElement('option');
                    opt5.value = header.index;
                    opt5.textContent = header.name;
                    option5Select.appendChild(opt5);
                    
                    const opt6 = document.createElement('option');
                    opt6.value = header.index;
                    opt6.textContent = header.name;
                    option6Select.appendChild(opt6);
                }
                
                // Portfolio 2 rows (option3, option4, option7, option8) - filter by MODEL_CONFIG.portfolio2
                if (MODEL_CONFIG.portfolio2.includes(header.index)) {
                    const opt3 = document.createElement('option');
                    opt3.value = header.index;
                    opt3.textContent = header.name;
                    option3Select.appendChild(opt3);
                    
                    const opt4 = document.createElement('option');
                    opt4.value = header.index;
                    opt4.textContent = header.name;
                    option4Select.appendChild(opt4);
                    
                    const opt7 = document.createElement('option');
                    opt7.value = header.index;
                    opt7.textContent = header.name;
                    option7Select.appendChild(opt7);
                    
                    const opt8 = document.createElement('option');
                    opt8.value = header.index;
                    opt8.textContent = header.name;
                    option8Select.appendChild(opt8);
                }
            });
        }
        
        function calculateCAGRFromAnnualReturns(colIndex, startYear, endYear) {
            // Annual returns start at row 21 (index 20) for Year 1
            // Calculate compound annual growth rate from individual year returns
            let compoundedValue = 1.0;
            
            for (let year = startYear; year <= endYear; year++) {
                const rowIndex = 19 + year; // Row 21 = Year 1, so index 20 = 19 + 1
                const row = excelData[rowIndex];
                if (row && row[colIndex] !== null && row[colIndex] !== undefined) {
                    const yearReturn = typeof row[colIndex] === 'number' ? row[colIndex] : parseValue(row[colIndex]);
                    compoundedValue *= (1 + yearReturn);
                }
            }
            
            // Convert to CAGR: (Final/Initial)^(1/years) - 1
            const years = endYear - startYear + 1;
            const cagr = Math.pow(compoundedValue, 1/years) - 1;
            return cagr;
        }
        
        function calculateBlendedCAGR(col1, alloc1, col2, alloc2, col3, alloc3, col4, alloc4, col5, alloc5, col6, alloc6, col7, alloc7, col8, alloc8, startYear, endYear) {
            // Calculate blended annual returns year by year, then derive CAGR
            let compoundedValue = 1.0;
            
            for (let year = startYear; year <= endYear; year++) {
                const rowIndex = 19 + year;
                const row = excelData[rowIndex];
                
                let blendedReturn = 0;
                if (col1 && alloc1 > 0 && row && row[col1] !== null) {
                    const ret1 = typeof row[col1] === 'number' ? row[col1] : parseValue(row[col1]);
                    blendedReturn += ret1 * (alloc1 / 100);
                }
                if (col2 && alloc2 > 0 && row && row[col2] !== null) {
                    const ret2 = typeof row[col2] === 'number' ? row[col2] : parseValue(row[col2]);
                    blendedReturn += ret2 * (alloc2 / 100);
                }
                if (col3 && alloc3 > 0 && row && row[col3] !== null) {
                    const ret3 = typeof row[col3] === 'number' ? row[col3] : parseValue(row[col3]);
                    blendedReturn += ret3 * (alloc3 / 100);
                }
                if (col4 && alloc4 > 0 && row && row[col4] !== null) {
                    const ret4 = typeof row[col4] === 'number' ? row[col4] : parseValue(row[col4]);
                    blendedReturn += ret4 * (alloc4 / 100);
                }
                if (col5 && alloc5 > 0 && row && row[col5] !== null) {
                    const ret5 = typeof row[col5] === 'number' ? row[col5] : parseValue(row[col5]);
                    blendedReturn += ret5 * (alloc5 / 100);
                }
                if (col6 && alloc6 > 0 && row && row[col6] !== null) {
                    const ret6 = typeof row[col6] === 'number' ? row[col6] : parseValue(row[col6]);
                    blendedReturn += ret6 * (alloc6 / 100);
                }
                if (col7 && alloc7 > 0 && row && row[col7] !== null) {
                    const ret7 = typeof row[col7] === 'number' ? row[col7] : parseValue(row[col7]);
                    blendedReturn += ret7 * (alloc7 / 100);
                }
                if (col8 && alloc8 > 0 && row && row[col8] !== null) {
                    const ret8 = typeof row[col8] === 'number' ? row[col8] : parseValue(row[col8]);
                    blendedReturn += ret8 * (alloc8 / 100);
                }
                
                compoundedValue *= (1 + blendedReturn);
            }
            
            const years = endYear - startYear + 1;
            const cagr = Math.pow(compoundedValue, 1/years) - 1;
            return cagr;
        }
        
        function calculateMaxDrawdown(col1, alloc1, col2, alloc2, col3, alloc3, col4, alloc4) {
            // Calculate true maximum drawdown from annual returns
            let portfolioValue = 100000;
            let peak = portfolioValue;
            let maxDrawdown = 0;
            
            const years = Math.round(yearsValue); // Use value from A17
            
            for (let year = 1; year <= years; year++) {
                const rowIndex = 19 + year;
                const row = excelData[rowIndex];
                
                let blendedReturn = 0;
                if (col1 && alloc1 > 0 && row && row[col1] !== null) {
                    const ret1 = typeof row[col1] === 'number' ? row[col1] : parseValue(row[col1]);
                    blendedReturn += ret1 * (alloc1 / 100);
                }
                if (col2 && alloc2 > 0 && row && row[col2] !== null) {
                    const ret2 = typeof row[col2] === 'number' ? row[col2] : parseValue(row[col2]);
                    blendedReturn += ret2 * (alloc2 / 100);
                }
                if (col3 && alloc3 > 0 && row && row[col3] !== null) {
                    const ret3 = typeof row[col3] === 'number' ? row[col3] : parseValue(row[col3]);
                    blendedReturn += ret3 * (alloc3 / 100);
                }
                if (col4 && alloc4 > 0 && row && row[col4] !== null) {
                    const ret4 = typeof row[col4] === 'number' ? row[col4] : parseValue(row[col4]);
                    blendedReturn += ret4 * (alloc4 / 100);
                }
                
                portfolioValue *= (1 + blendedReturn);
                
                if (portfolioValue > peak) {
                    peak = portfolioValue;
                }
                
                const drawdown = (portfolioValue - peak) / peak;
                if (drawdown < maxDrawdown) {
                    maxDrawdown = drawdown;
                }
            }
            
            return maxDrawdown;
        }
        
        function calculateInvestmentGrowth(col1, alloc1, col2, alloc2, col3, alloc3, col4, alloc4) {
            // Calculate actual compounded growth from annual returns with rebalancing
            let portfolioValue = 100000;
            
            const years = Math.round(yearsValue); // Use value from A17
            
            for (let year = 1; year <= years; year++) {
                const rowIndex = 19 + year;
                const row = excelData[rowIndex];
                
                let blendedReturn = 0;
                if (col1 && alloc1 > 0 && row && row[col1] !== null) {
                    const ret1 = typeof row[col1] === 'number' ? row[col1] : parseValue(row[col1]);
                    blendedReturn += ret1 * (alloc1 / 100);
                }
                if (col2 && alloc2 > 0 && row && row[col2] !== null) {
                    const ret2 = typeof row[col2] === 'number' ? row[col2] : parseValue(row[col2]);
                    blendedReturn += ret2 * (alloc2 / 100);
                }
                if (col3 && alloc3 > 0 && row && row[col3] !== null) {
                    const ret3 = typeof row[col3] === 'number' ? row[col3] : parseValue(row[col3]);
                    blendedReturn += ret3 * (alloc3 / 100);
                }
                if (col4 && alloc4 > 0 && row && row[col4] !== null) {
                    const ret4 = typeof row[col4] === 'number' ? row[col4] : parseValue(row[col4]);
                    blendedReturn += ret4 * (alloc4 / 100);
                }
                
                portfolioValue *= (1 + blendedReturn);
            }
            
            return portfolioValue;
        }

        function calculateRiskMetrics(col1, alloc1, col2, alloc2, col3, alloc3, col4, alloc4) {
            const years = Math.round(yearsValue);
            const returns = [];
            const sp500Returns = [];
            const sp500ColIndex = 12; // Column M (S&P 500) - 0-based index
            
            // Collect blended annual returns and S&P 500 returns
            for (let year = 1; year <= years; year++) {
                const rowIndex = 19 + year;
                const row = excelData[rowIndex];
                
                let blendedReturn = 0;
                if (col1 && alloc1 > 0 && row && row[col1] !== null) {
                    const ret1 = typeof row[col1] === 'number' ? row[col1] : parseValue(row[col1]);
                    blendedReturn += ret1 * (alloc1 / 100);
                }
                if (col2 && alloc2 > 0 && row && row[col2] !== null) {
                    const ret2 = typeof row[col2] === 'number' ? row[col2] : parseValue(row[col2]);
                    blendedReturn += ret2 * (alloc2 / 100);
                }
                if (col3 && alloc3 > 0 && row && row[col3] !== null) {
                    const ret3 = typeof row[col3] === 'number' ? row[col3] : parseValue(row[col3]);
                    blendedReturn += ret3 * (alloc3 / 100);
                }
                if (col4 && alloc4 > 0 && row && row[col4] !== null) {
                    const ret4 = typeof row[col4] === 'number' ? row[col4] : parseValue(row[col4]);
                    blendedReturn += ret4 * (alloc4 / 100);
                }
                
                returns.push(blendedReturn);
                
                // Get S&P 500 return
                if (row && row[sp500ColIndex] !== null && row[sp500ColIndex] !== undefined) {
                    const spRet = typeof row[sp500ColIndex] === 'number' ? row[sp500ColIndex] : parseValue(row[sp500ColIndex]);
                    sp500Returns.push(spRet);
                }
            }
            
            // Calculate mean (Expected Return)
            const mean = returns.reduce((sum, r) => sum + r, 0) / returns.length;
            const sp500Mean = sp500Returns.reduce((sum, r) => sum + r, 0) / sp500Returns.length;
            
            // Calculate standard deviation
            const squaredDiffs = returns.map(r => Math.pow(r - mean, 2));
            const variance = squaredDiffs.reduce((sum, sq) => sum + sq, 0) / (returns.length - 1);
            const stdDev = Math.sqrt(variance);
            
            // Sharpe Ratio (3% risk-free rate)
            const riskFree = 0.03;
            const sharpe = (mean - riskFree) / stdDev;
            
            // Sortino Ratio (downside deviation)
            const downsideReturns = returns.filter(r => r < 0);
            let sortino = 0;
            if (downsideReturns.length > 1) {
                const downsideMean = 0;
                const downsideSquaredDiffs = downsideReturns.map(r => Math.pow(r - downsideMean, 2));
                const downsideVariance = downsideSquaredDiffs.reduce((sum, sq) => sum + sq, 0) / (downsideReturns.length - 1);
                const downsideDev = Math.sqrt(downsideVariance);
                sortino = (mean - riskFree) / downsideDev;
            } else {
                sortino = sharpe; // Fallback if insufficient downside data
            }
            
            // Win Rate
            const positiveYears = returns.filter(r => r > 0).length;
            const winRate = positiveYears / returns.length;
            
            // Calculate CAGR for Alpha (compound annual growth rate)
            let compoundedValue = 1.0;
            for (let i = 0; i < returns.length; i++) {
                compoundedValue *= (1 + returns[i]);
            }
            const cagr = Math.pow(compoundedValue, 1/returns.length) - 1;
            
            // Beta calculation
            const covariance = returns.reduce((sum, ret, i) => 
                sum + (ret - mean) * (sp500Returns[i] - sp500Mean), 0) / (returns.length - 1);
            const sp500Variance = sp500Returns.reduce((sum, ret) => 
                sum + Math.pow(ret - sp500Mean, 2), 0) / (sp500Returns.length - 1);
            const beta = sp500Variance !== 0 ? covariance / sp500Variance : 0;
            
            // Expected Return (CAPM) = Risk-Free + Beta * (Market Return - Risk-Free)
            const expectedReturn = riskFree + beta * (sp500Mean - riskFree);
            
            // Alpha = Arithmetic Mean - Expected Return (not CAGR, because it's based on Beta/regression)
            const alpha = mean - expectedReturn;
            
            // Treynor Ratio = (Arithmetic Mean - Risk-Free) / Beta (uses mean because it's based on Beta)
            const treynor = beta !== 0 ? (mean - riskFree) / beta : 0;
            
            return {
                sharpe: sharpe,
                sortino: sortino,
                volatility: stdDev,
                winRate: winRate,
                expectedReturn: expectedReturn,
                beta: beta,
                alpha: alpha,
                treynor: treynor
            };
        }
        
        // Quick Templates - Load common allocations into Current (Current)
        function loadTemplate() {
            const template = document.getElementById('templateSelect').value;
            
            if (!template) return;
            
            // Template definitions: [Model Index, Allocation %]
            const templates = {
                conservative: {
                    A: [18, 40],  // 40% SPY (index 18)
                    B: [13, 60],  // 60% AGG (index 13)
                    C: [null, 0],
                    D: [null, 0]
                },
                moderate: {
                    A: [18, 50],  // 50% SPY
                    B: [13, 50],  // 50% AGG
                    C: [null, 0],
                    D: [null, 0]
                },
                balanced: {
                    A: [18, 60],  // 60% SPY
                    B: [13, 40],  // 40% AGG
                    C: [null, 0],
                    D: [null, 0]
                },
                growth: {
                    A: [18, 70],  // 70% SPY
                    B: [13, 30],  // 30% AGG
                    C: [null, 0],
                    D: [null, 0]
                },
                aggressive: {
                    A: [18, 80],  // 80% SPY
                    B: [13, 20],  // 20% AGG
                    C: [null, 0],
                    D: [null, 0]
                },
                global: {
                    A: [18, 60],  // 60% SPY
                    B: [13, 30],  // 30% AGG
                    C: [15, 10],  // 10% VEA (index 15)
                    D: [null, 0]
                }
            };
            
            const config = templates[template];
            
            // Load Current (Current) selectors (option1, option2, option5, option6)
            // A row
            document.getElementById('option1Select').value = config.A[0] || '';
            document.getElementById('allocation1Select').value = config.A[1];
            
            // B row
            document.getElementById('option2Select').value = config.B[0] || '';
            document.getElementById('allocation2Select').value = config.B[1];
            
            // C row
            document.getElementById('option5Select').value = config.C[0] || '';
            document.getElementById('allocation5Select').value = config.C[1];
            
            // D row
            document.getElementById('option6Select').value = config.D[0] || '';
            document.getElementById('allocation6Select').value = config.D[1];
            
            // Visual feedback
            const templateSelectBox = document.getElementById('templateSelect');
            templateSelectBox.style.background = '#d4edda';
            templateSelectBox.style.borderColor = '#28a745';
            
            setTimeout(() => {
                templateSelectBox.style.background = 'white';
                templateSelectBox.style.borderColor = '#007bff';
            }, 1000);
        }

        function updateComparison() {
            const option1Index = parseInt(document.getElementById('option1Select').value) || 0;
            const option2Index = parseInt(document.getElementById('option2Select').value) || 0;
            const option3Index = parseInt(document.getElementById('option3Select').value) || 0;
            const option4Index = parseInt(document.getElementById('option4Select').value) || 0;
            const option5Index = parseInt(document.getElementById('option5Select').value) || 0;
            const option6Index = parseInt(document.getElementById('option6Select').value) || 0;
            const option7Index = parseInt(document.getElementById('option7Select').value) || 0;
            const option8Index = parseInt(document.getElementById('option8Select').value) || 0;
            
            const alloc1 = parseInt(document.getElementById('allocation1Select').value);
            const alloc2 = parseInt(document.getElementById('allocation2Select').value);
            const alloc3 = parseInt(document.getElementById('allocation3Select').value);
            const alloc4 = parseInt(document.getElementById('allocation4Select').value);
            const alloc5 = parseInt(document.getElementById('allocation5Select').value);
            const alloc6 = parseInt(document.getElementById('allocation6Select').value);
            const alloc7 = parseInt(document.getElementById('allocation7Select').value);
            const alloc8 = parseInt(document.getElementById('allocation8Select').value);
            
            // Validate Portfolio 1
            if (!option1Index && !option2Index && !option5Index && !option6Index) {
                alert('Please select at least one model for Portfolio 1');
                return;
            }
            
            if (alloc1 + alloc2 + alloc5 + alloc6 !== 100) {
                alert('Current allocations must total 100%');
                return;
            }
            
            // Validate Portfolio 2
            if (!option3Index && !option4Index && !option7Index && !option8Index) {
                alert('Please select at least one model for Portfolio 2');
                return;
            }
            
            if (alloc3 + alloc4 + alloc7 + alloc8 !== 100) {
                alert('Modeled allocations must total 100%');
                return;
            }
            
            generateComparison(option1Index, alloc1, option2Index, alloc2, option5Index, alloc5, option6Index, alloc6,
                             option3Index, alloc3, option4Index, alloc4, option7Index, alloc7, option8Index, alloc8);
        }
        
        function generateComparison(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6, 
                                      col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8) {
            // Calculate years from yearsValue
            const years = Math.round(yearsValue);
            
            // Get headers
            const header1 = col1 ? columnHeaders.find(h => h.index === col1) : null;
            const header2 = col2 ? columnHeaders.find(h => h.index === col2) : null;
            const header3 = col3 ? columnHeaders.find(h => h.index === col3) : null;
            const header4 = col4 ? columnHeaders.find(h => h.index === col4) : null;
            const header5 = col5 ? columnHeaders.find(h => h.index === col5) : null;
            const header6 = col6 ? columnHeaders.find(h => h.index === col6) : null;
            const header7 = col7 ? columnHeaders.find(h => h.index === col7) : null;
            const header8 = col8 ? columnHeaders.find(h => h.index === col8) : null;
            
            // Build portfolio names
            let portfolio1Name = '';
            if (header1 && alloc1 > 0) portfolio1Name += `${alloc1}% ${header1.name}`;
            if (header2 && alloc2 > 0) {
                if (portfolio1Name) portfolio1Name += ' / ';
                portfolio1Name += `${alloc2}% ${header2.name}`;
            }
            if (header5 && alloc5 > 0) {
                if (portfolio1Name) portfolio1Name += ' / ';
                portfolio1Name += `${alloc5}% ${header5.name}`;
            }
            if (header6 && alloc6 > 0) {
                if (portfolio1Name) portfolio1Name += ' / ';
                portfolio1Name += `${alloc6}% ${header6.name}`;
            }
            
            let portfolio2Name = '';
            if (header3 && alloc3 > 0) portfolio2Name += `${alloc3}% ${header3.name}`;
            if (header4 && alloc4 > 0) {
                if (portfolio2Name) portfolio2Name += ' / ';
                portfolio2Name += `${alloc4}% ${header4.name}`;
            }
            if (header7 && alloc7 > 0) {
                if (portfolio2Name) portfolio2Name += ' / ';
                portfolio2Name += `${alloc7}% ${header7.name}`;
            }
            if (header8 && alloc8 > 0) {
                if (portfolio2Name) portfolio2Name += ' / ';
                portfolio2Name += `${alloc8}% ${header8.name}`;
            }
            
            // Update headers - SWAPPED to match new column order (Modeled first, Current second)
            document.getElementById('col1HeaderTable').textContent = 'Modeled'; // First column shows Modeled (Modeled)
            document.getElementById('col2HeaderTable').textContent = 'Current'; // Second column shows Current (Current)
            
            // Update portfolio description keys
            document.getElementById('portfolio1Description').textContent = portfolio1Name;
            document.getElementById('portfolio2Description').textContent = portfolio2Name;
            document.getElementById('portfolio1DescriptionRisk').textContent = portfolio1Name;
            document.getElementById('portfolio2DescriptionRisk').textContent = portfolio2Name;
            
            // Short names for labels (use "Portfolio 1/2" for simplicity)
            const shortName1 = 'Current';
            const shortName2 = 'Modeled';
            
            // Update labels
            document.getElementById('col1Label1').textContent = 'Current:';
            document.getElementById('col1Label2').textContent = 'Current:';
            document.getElementById('col2Label1').textContent = 'Modeled:';
            document.getElementById('col2Label2').textContent = 'Modeled:';
            
            // Generate performance table - calculate CAGRs from annual returns
            const tbody = document.getElementById('performanceTableBody');
            tbody.innerHTML = '';
            
            // Row 3: 1 Year (just year 20)
            const oneYearRow = excelData[2];
            if (oneYearRow && oneYearRow[0] === 'Total Return' && oneYearRow[1] === '1 year') {
                let value1 = 0;
                if (col1 && alloc1 > 0) value1 += parseValue(oneYearRow[col1]) * (alloc1 / 100);
                if (col2 && alloc2 > 0) value1 += parseValue(oneYearRow[col2]) * (alloc2 / 100);
                if (col5 && alloc5 > 0) value1 += parseValue(oneYearRow[col5]) * (alloc5 / 100);
                if (col6 && alloc6 > 0) value1 += parseValue(oneYearRow[col6]) * (alloc6 / 100);
                
                let value2 = 0;
                if (col3 && alloc3 > 0) value2 += parseValue(oneYearRow[col3]) * (alloc3 / 100);
                if (col4 && alloc4 > 0) value2 += parseValue(oneYearRow[col4]) * (alloc4 / 100);
                if (col7 && alloc7 > 0) value2 += parseValue(oneYearRow[col7]) * (alloc7 / 100);
                if (col8 && alloc8 > 0) value2 += parseValue(oneYearRow[col8]) * (alloc8 / 100);
                
                const diff = value2 - value1; // FLIPPED: Modeled minus Current
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><span class="metric-term">Total Return<span class="tooltip">The overall percentage gain or loss of an investment over a specific period, including all income and capital appreciation.</span></span></td>
                    <td>1 year</td>
                    <td>${formatPercent(value2)}</td>
                    <td>${formatPercent(value1)}</td>
                    <td class="${diff >= 0 ? 'positive' : 'negative'}">${formatPercent(diff)}</td>
                `;
                tbody.appendChild(tr);
            }
            
            // YTD row removed per Phase 2 requirements
            
            // Display CAGRs from summary rows (calculated from daily model)
            // Row 5 = 5 Year, Row 6 = 10 Year, Row 7 = 15 Year, Row 8 = Dynamic (based on yearsValue)
            // Calculate true CAGRs from annual returns (not weighted average of pre-calculated CAGRs)
            const cagrPeriods = [
                {label: '5 Year', startYear: Math.round(yearsValue) - 4, endYear: Math.round(yearsValue)},
                {label: '10 Year', startYear: Math.round(yearsValue) - 9, endYear: Math.round(yearsValue)},
                {label: '15 Year', startYear: Math.round(yearsValue) - 14, endYear: Math.round(yearsValue)},
                {label: `${Math.round(yearsValue)} Year`, startYear: 1, endYear: Math.round(yearsValue)}
            ];
            
            cagrPeriods.forEach(period => {
                // Calculate CAGR from actual compounded annual returns
                // Current: slots 1,2,5,6 active, others zero
                const cagr1 = calculateBlendedCAGR(col1, alloc1, col2, alloc2, 0, 0, 0, 0, col5, alloc5, col6, alloc6, 0, 0, 0, 0, period.startYear, period.endYear);
                // Modeled: slots 3,4,7,8 active, others zero
                const cagr2 = calculateBlendedCAGR(0, 0, 0, 0, col3, alloc3, col4, alloc4, 0, 0, 0, 0, col7, alloc7, col8, alloc8, period.startYear, period.endYear);
                
                const diff = cagr2 - cagr1; // FLIPPED: Modeled minus Current
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><span class="metric-term">CAGR<span class="tooltip">Compound Annual Growth Rate - The average annual return of an investment over a specific period, accounting for compounding effects.</span></span></td>
                    <td>${period.label}</td>
                    <td>${formatPercent(cagr2)}</td>
                    <td>${formatPercent(cagr1)}</td>
                    <td class="${diff >= 0 ? 'positive' : 'negative'}">${formatPercent(diff)}</td>
                `;
                tbody.appendChild(tr);
            });
            
            // Calculate $100K Investment Growth using actual year-by-year compounding
            const fv1 = calculateInvestmentGrowth(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6);
            const fv2 = calculateInvestmentGrowth(col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8);
            const fvDiff = fv2 - fv1; // FLIPPED: Modeled minus Current (should be positive for WavRyder)
            
            document.getElementById('option1_100k').textContent = formatCurrency(fv1);
            document.getElementById('option2_100k').textContent = formatCurrency(fv2);
            const diffEl = document.getElementById('diff100k');
            diffEl.textContent = formatCurrency(fvDiff);
            diffEl.className = fvDiff >= 0 ? 'positive' : 'negative';
            
            // Calculate true maximum drawdown from annual returns
            const dd1 = calculateMaxDrawdown(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6);
            const dd2 = calculateMaxDrawdown(col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8);
            const ddDiff = dd2 - dd1; // FLIPPED: Modeled minus Current (negative is better for drawdowns)
            
            document.getElementById('option1Drawdown').textContent = formatPercent(dd1);
            document.getElementById('option2Drawdown').textContent = formatPercent(dd2);
            const ddDiffEl = document.getElementById('drawdownDiff');
            ddDiffEl.textContent = formatPercent(ddDiff);
            // For drawdowns: positive diff means Modeled has less drawdown (better) = green
            // Negative diff means Modeled has more drawdown (worse) = red
            ddDiffEl.className = ddDiff >= 0 ? 'positive' : 'negative';
            
            // Calculate and display risk metrics
            const risk1 = calculateRiskMetrics(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6);
            const risk2 = calculateRiskMetrics(col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8);
            
            // Update labels for risk metrics
            document.getElementById('col1Label3').textContent = shortName1 + ':';
            document.getElementById('col1Label4').textContent = shortName1 + ':';
            document.getElementById('col1Label5').textContent = shortName1 + ':';
            document.getElementById('col1Label6').textContent = shortName1 + ':';
            document.getElementById('col1Label7').textContent = shortName1 + ':';
            document.getElementById('col1Label8').textContent = shortName1 + ':';
            document.getElementById('col1Label9').textContent = shortName1 + ':';
            document.getElementById('col1Label10').textContent = shortName1 + ':';
            document.getElementById('col2Label3').textContent = shortName2 + ':';
            document.getElementById('col2Label4').textContent = shortName2 + ':';
            document.getElementById('col2Label5').textContent = shortName2 + ':';
            document.getElementById('col2Label6').textContent = shortName2 + ':';
            document.getElementById('col2Label7').textContent = shortName2 + ':';
            document.getElementById('col2Label8').textContent = shortName2 + ':';
            document.getElementById('col2Label9').textContent = shortName2 + ':';
            document.getElementById('col2Label10').textContent = shortName2 + ':';
            
            // Beta (now position 3)
            document.getElementById('option1Beta').textContent = risk1.beta.toFixed(3);
            document.getElementById('option2Beta').textContent = risk2.beta.toFixed(3);
            const betaDiff = risk2.beta - risk1.beta; // FLIPPED
            const betaDiffEl = document.getElementById('betaDiff');
            betaDiffEl.textContent = betaDiff.toFixed(3);
            betaDiffEl.className = betaDiff <= 0 ? 'positive' : 'negative'; // Lower beta is better
            
            // Expected Return (now position 4)
            document.getElementById('option1ExpReturn').textContent = formatPercent(risk1.expectedReturn);
            document.getElementById('option2ExpReturn').textContent = formatPercent(risk2.expectedReturn);
            const expReturnDiff = risk2.expectedReturn - risk1.expectedReturn; // FLIPPED
            const expReturnDiffEl = document.getElementById('expReturnDiff');
            expReturnDiffEl.textContent = formatPercent(expReturnDiff);
            expReturnDiffEl.className = expReturnDiff >= 0 ? 'positive' : 'negative'; // Higher return is better
            
            // Alpha (now position 5)
            document.getElementById('option1Alpha').textContent = formatPercent(risk1.alpha);
            document.getElementById('option2Alpha').textContent = formatPercent(risk2.alpha);
            const alphaDiff = risk2.alpha - risk1.alpha; // FLIPPED
            const alphaDiffEl = document.getElementById('alphaDiff');
            alphaDiffEl.textContent = formatPercent(alphaDiff);
            alphaDiffEl.className = alphaDiff >= 0 ? 'positive' : 'negative'; // Higher alpha is better
            
            // Sharpe Ratio (now position 6)
            document.getElementById('option1Sharpe').textContent = risk1.sharpe.toFixed(3);
            document.getElementById('option2Sharpe').textContent = risk2.sharpe.toFixed(3);
            const sharpeDiff = risk2.sharpe - risk1.sharpe; // FLIPPED
            const sharpeDiffEl = document.getElementById('sharpeDiff');
            sharpeDiffEl.textContent = sharpeDiff.toFixed(3);
            sharpeDiffEl.className = sharpeDiff >= 0 ? 'positive' : 'negative'; // Higher Sharpe is better
            
            // Sortino Ratio (now position 7)
            document.getElementById('option1Sortino').textContent = risk1.sortino.toFixed(3);
            document.getElementById('option2Sortino').textContent = risk2.sortino.toFixed(3);
            const sortinoDiff = risk2.sortino - risk1.sortino; // FLIPPED
            const sortinoDiffEl = document.getElementById('sortinoDiff');
            sortinoDiffEl.textContent = sortinoDiff.toFixed(3);
            sortinoDiffEl.className = sortinoDiff >= 0 ? 'positive' : 'negative'; // Higher Sortino is better
            
            // Treynor Ratio (now position 8)
            document.getElementById('option1Treynor').textContent = risk1.treynor.toFixed(3);
            document.getElementById('option2Treynor').textContent = risk2.treynor.toFixed(3);
            const treynorDiff = risk2.treynor - risk1.treynor; // FLIPPED
            const treynorDiffEl = document.getElementById('treynorDiff');
            treynorDiffEl.textContent = treynorDiff.toFixed(3);
            treynorDiffEl.className = treynorDiff >= 0 ? 'positive' : 'negative'; // Higher Treynor is better
            
            // Volatility (now position 9)
            document.getElementById('option1Vol').textContent = formatPercent(risk1.volatility);
            document.getElementById('option2Vol').textContent = formatPercent(risk2.volatility);
            const volDiff = risk2.volatility - risk1.volatility; // FLIPPED
            const volDiffEl = document.getElementById('volDiff');
            volDiffEl.textContent = formatPercent(volDiff);
            volDiffEl.className = volDiff <= 0 ? 'positive' : 'negative'; // Lower volatility is better
            
            // Win Rate (now position 10)
            document.getElementById('option1WinRate').textContent = (risk1.winRate * 100).toFixed(1) + '%';
            document.getElementById('option2WinRate').textContent = (risk2.winRate * 100).toFixed(1) + '%';
            const winRateDiff = risk2.winRate - risk1.winRate; // FLIPPED
            const winRateDiffEl = document.getElementById('winRateDiff');
            winRateDiffEl.textContent = (winRateDiff * 100).toFixed(1) + '%';
            winRateDiffEl.className = winRateDiff >= 0 ? 'positive' : 'negative'; // Higher win rate is better
            
            // Create growth chart
            createGrowthChart(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6, col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8, portfolio1Name, portfolio2Name);
            
            // Create pie charts for allocation visualization (currently hidden)
            // createPieCharts(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6, col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8, portfolio1Name, portfolio2Name);
            
            // Show PDF download button (currently hidden)
            // document.getElementById('pdfDownloadButton').style.display = 'inline-block';
            
            // Calculate full-period CAGRs for commentary
            const p1_fullCAGR = calculateBlendedCAGR(col1, alloc1, col2, alloc2, null, 0, null, 0, col5, alloc5, col6, alloc6, null, 0, null, 0, 1, years);
            const p2_fullCAGR = calculateBlendedCAGR(col3, alloc3, col4, alloc4, null, 0, null, 0, col7, alloc7, col8, alloc8, null, 0, null, 0, 1, years);
            
            // Generate dynamic, context-aware commentary (Phase 2 Priority 4)
            generateEnhancedCommentary(
                {cagr1: p1_fullCAGR, cagr2: p2_fullCAGR, fv1: fv1, fv2: fv2, dd1: dd1, dd2: dd2},
                {name1: portfolio1Name, name2: portfolio2Name},
                years
            );
            
            document.getElementById('reportContent').style.display = 'block';
            
            // Generate compelling Aha Card with key insights
            generateAhaCard(fv1, fv2, dd1, dd2, p1_fullCAGR, p2_fullCAGR);
        }
        
        function createGrowthChart(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6, col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8, portfolio1Name, portfolio2Name) {
            const years = Math.round(yearsValue);
            
            // Calculate year-by-year growth for both portfolios
            const portfolio1Values = [100000]; // Start with $100K
            const portfolio2Values = [100000];
            const labels = ['Year 0'];
            
            let value1 = 100000;
            let value2 = 100000;
            
            for (let year = 1; year <= years; year++) {
                const rowIndex = 19 + year;
                const row = excelData[rowIndex];
                
                // Current blended return
                let return1 = 0;
                if (col1 && alloc1 > 0 && row && row[col1] !== null) {
                    const ret = typeof row[col1] === 'number' ? row[col1] : parseValue(row[col1]);
                    return1 += ret * (alloc1 / 100);
                }
                if (col2 && alloc2 > 0 && row && row[col2] !== null) {
                    const ret = typeof row[col2] === 'number' ? row[col2] : parseValue(row[col2]);
                    return1 += ret * (alloc2 / 100);
                }
                if (col5 && alloc5 > 0 && row && row[col5] !== null) {
                    const ret = typeof row[col5] === 'number' ? row[col5] : parseValue(row[col5]);
                    return1 += ret * (alloc5 / 100);
                }
                if (col6 && alloc6 > 0 && row && row[col6] !== null) {
                    const ret = typeof row[col6] === 'number' ? row[col6] : parseValue(row[col6]);
                    return1 += ret * (alloc6 / 100);
                }
                
                // Modeled blended return
                let return2 = 0;
                if (col3 && alloc3 > 0 && row && row[col3] !== null) {
                    const ret = typeof row[col3] === 'number' ? row[col3] : parseValue(row[col3]);
                    return2 += ret * (alloc3 / 100);
                }
                if (col4 && alloc4 > 0 && row && row[col4] !== null) {
                    const ret = typeof row[col4] === 'number' ? row[col4] : parseValue(row[col4]);
                    return2 += ret * (alloc4 / 100);
                }
                if (col7 && alloc7 > 0 && row && row[col7] !== null) {
                    const ret = typeof row[col7] === 'number' ? row[col7] : parseValue(row[col7]);
                    return2 += ret * (alloc7 / 100);
                }
                if (col8 && alloc8 > 0 && row && row[col8] !== null) {
                    const ret = typeof row[col8] === 'number' ? row[col8] : parseValue(row[col8]);
                    return2 += ret * (alloc8 / 100);
                }
                
                value1 *= (1 + return1);
                value2 *= (1 + return2);
                
                portfolio1Values.push(value1);
                portfolio2Values.push(value2);
                labels.push(`Year ${year}`);
            }
            
            // Update chart subtitle
            document.getElementById('chartSubtitle').textContent = `${portfolio1Name} vs ${portfolio2Name}`;
            
            // Destroy existing chart if it exists
            if (growthChart) {
                growthChart.destroy();
            }
            
            // Create new chart
            const ctx = document.getElementById('growthChart').getContext('2d');
            growthChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: portfolio1Name,
                            data: portfolio1Values,
                            borderColor: '#007bff',
                            backgroundColor: 'rgba(0, 123, 255, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointHoverRadius: 5
                        },
                        {
                            label: portfolio2Name,
                            data: portfolio2Values,
                            borderColor: '#28a745',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointHoverRadius: 5
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 14,
                                    family: "'Roboto Slab', serif",
                                    weight: 600
                                },
                                padding: 15,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 14,
                                family: "'Roboto Slab', serif"
                            },
                            bodyFont: {
                                size: 13,
                                family: "'Roboto Slab', serif"
                            },
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += '$' + Math.round(context.parsed.y).toLocaleString();
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 11,
                                    family: "'Roboto Slab', serif"
                                },
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    family: "'Roboto Slab', serif"
                                },
                                callback: function(value) {
                                    if (value >= 1000000) {
                                        return '$' + (value / 1000000).toFixed(1) + 'M';
                                    }
                                    return '$' + (value / 1000).toFixed(0) + 'K';
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });
        }
        
        function calculateDifference(val1, val2, isCurrency = false) {
            const num1 = parseValue(val1);
            const num2 = parseValue(val2);
            
            if (isNaN(num1) || isNaN(num2)) return 0;
            
            return num1 - num2;
        }
        
        function parseValue(value) {
            if (typeof value === 'number') return value;
            if (typeof value === 'string') {
                const cleaned = value.replace(/[$,%,\s]/g, '');
                const num = parseFloat(cleaned);
                
                if (value.includes('%')) {
                    return num / 100;
                }
                return num;
            }
            return 0;
        }
        
        function formatValue(value) {
            if (value === null || value === undefined) return 'N/A';
            if (typeof value === 'string') return value;
            if (typeof value === 'number') {
                if (Math.abs(value) <= 1) {
                    return formatPercent(value);
                }
                return formatCurrency(value);
            }
            return value;
        }
        
        function formatPercent(value) {
            if (value === null || value === undefined || isNaN(value)) return '0.00%';
            if (typeof value === 'number') {
                return (value * 100).toFixed(2) + '%';
            }
            if (typeof value === 'string' && value.includes('%')) {
                return value;
            }
            return value + '%';
        }
        
        function formatCurrency(value) {
            if (value === null || value === undefined || isNaN(value)) return '$0';
            if (typeof value === 'number') {
                return '$' + value.toLocaleString('en-US', {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                });
            }
            if (typeof value === 'string' && value.includes('$')) {
                return value;
            }
            return '$' + value;
        }
        
        async function copyAllAsImage() {
            const copyStatus = document.getElementById('copyStatus');
            const buttons = document.querySelectorAll('.copy-button');
            
            buttons[0].disabled = true;
            buttons[0].textContent = '‚è≥ Generating...';
            
            try {
                // Create a temporary container with everything
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                tempDiv.style.width = '540px'; // 60% of 900px to match display
                tempDiv.style.background = '#ffffff';
                tempDiv.style.padding = '20px';
                document.body.appendChild(tempDiv);
                
                // Add main header
                const mainHeader = document.createElement('div');
                mainHeader.className = 'header';
                const h1 = document.createElement('h1');
                h1.textContent = 'Performance Comparison';
                h1.style.fontSize = '28px';
                h1.style.fontWeight = '700';
                h1.style.color = '#1a1a1a';
                h1.style.marginBottom = '5px';
                mainHeader.appendChild(h1);
                
                const subtitle = document.createElement('div');
                subtitle.className = 'subtitle';
                const p1 = document.getElementById('portfolio1Description').textContent; const p2 = document.getElementById('portfolio2Description').textContent; subtitle.textContent = `${p1} vs ${p2}`;
                subtitle.style.fontSize = '14px';
                subtitle.style.color = '#666';
                subtitle.style.fontStyle = 'italic';
                subtitle.style.marginBottom = '15px';
                mainHeader.appendChild(subtitle);
                tempDiv.appendChild(mainHeader);
                
                // Clone Performance Metrics section
                const perfHeader = document.querySelector('.section-header');
                if (perfHeader) {
                    tempDiv.appendChild(perfHeader.cloneNode(true));
                }
                
                // Clone portfolio key
                const portfolioKey = document.getElementById('portfolioKey');
                if (portfolioKey) {
                    tempDiv.appendChild(portfolioKey.cloneNode(true));
                }
                
                const perfTable = document.querySelector('.performance-table');
                if (perfTable) {
                    const tableClone = perfTable.cloneNode(true);
                    // Ensure tbody content is captured
                    const originalTbody = perfTable.querySelector('tbody');
                    const cloneTbody = tableClone.querySelector('tbody');
                    if (originalTbody && cloneTbody) {
                        cloneTbody.innerHTML = originalTbody.innerHTML;
                    }
                    tempDiv.appendChild(tableClone);
                }
                
                // Clone Investment Analysis section
                const invHeader = document.querySelectorAll('.section-header')[1];
                if (invHeader) {
                    tempDiv.appendChild(invHeader.cloneNode(true));
                }
                
                const metricsContainer = document.querySelector('.metrics-container');
                if (metricsContainer) {
                    tempDiv.appendChild(metricsContainer.cloneNode(true));
                }
                
                // Clone the note
                const note = document.querySelectorAll('#presentationContent > div[style*="font-size: 11px"]')[0];
                if (note) {
                    tempDiv.appendChild(note.cloneNode(true));
                }
                
                // Clone Portfolio Growth section
                const growthHeader = document.querySelectorAll('.section-header')[2];
                if (growthHeader) {
                    tempDiv.appendChild(growthHeader.cloneNode(true));
                }
                
                // Add chart content
                const chartContentDiv = document.createElement('div');
                chartContentDiv.style.background = '#ffffff';
                chartContentDiv.style.padding = '15px';
                chartContentDiv.style.borderRadius = '8px';
                chartContentDiv.style.marginTop = '6px';
                
                const titleDiv = document.createElement('div');
                titleDiv.style.textAlign = 'center';
                titleDiv.style.marginBottom = '10px';
                
                const h3 = document.createElement('h3');
                h3.textContent = '$100,000 Investment Growth';
                h3.style.fontSize = '18px';
                h3.style.color = '#1a1a1a';
                h3.style.fontWeight = '600';
                h3.style.marginBottom = '3px';
                titleDiv.appendChild(h3);
                
                const chartSubtitle = document.getElementById('chartSubtitle').cloneNode(true);
                titleDiv.appendChild(chartSubtitle);
                chartContentDiv.appendChild(titleDiv);
                
                const chartCanvas = document.getElementById('growthChart');
                if (chartCanvas) {
                    const canvasClone = document.createElement('canvas');
                    canvasClone.width = chartCanvas.width;
                    canvasClone.height = chartCanvas.height;
                    const ctx = canvasClone.getContext('2d');
                    ctx.drawImage(chartCanvas, 0, 0);
                    canvasClone.style.width = '100%';
                    canvasClone.style.height = 'auto';
                    chartContentDiv.appendChild(canvasClone);
                }
                
                const chartNote = document.createElement('div');
                chartNote.textContent = 'Growth calculated from annual returns with annual rebalancing.';
                chartNote.style.textAlign = 'center';
                chartNote.style.fontSize = '11px';
                chartNote.style.color = '#999';
                chartNote.style.fontStyle = 'italic';
                chartNote.style.marginTop = '8px';
                chartContentDiv.appendChild(chartNote);
                
                tempDiv.appendChild(chartContentDiv);
                
                // Clone Risk Metrics section
                const riskHeader = document.querySelectorAll('.section-header')[3];
                if (riskHeader) {
                    tempDiv.appendChild(riskHeader.cloneNode(true));
                }
                
                const riskContent = document.getElementById('riskMetricsContent');
                if (riskContent) {
                    tempDiv.appendChild(riskContent.cloneNode(true));
                }
                
                const canvas = await html2canvas(tempDiv, {
                    backgroundColor: '#ffffff',
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    allowTaint: true
                });
                
                // Clean up
                document.body.removeChild(tempDiv);
                
                canvas.toBlob(async (blob) => {
                    try {
                        await navigator.clipboard.write([
                            new ClipboardItem({'image/png': blob})
                        ]);
                        
                        copyStatus.textContent = '‚úì All sections copied to clipboard!';
                        copyStatus.style.display = 'block';
                        
                        setTimeout(() => {
                            copyStatus.style.display = 'none';
                        }, 3000);
                        
                    } catch (err) {
                        const url = canvas.toDataURL('image/png');
                        const link = document.createElement('a');
                        link.download = 'portfolio-comparison-all.png';
                        link.href = url;
                        link.click();
                        
                        copyStatus.textContent = '‚úì All sections downloaded!';
                        copyStatus.style.display = 'block';
                        
                        setTimeout(() => {
                            copyStatus.style.display = 'none';
                        }, 3000);
                    }
                }, 'image/png');
                
            } catch (err) {
                alert('Failed to generate image: ' + err.message);
            } finally {
                buttons[0].disabled = false;
                buttons[0].textContent = 'üìë Copy All';
            }
        }
        
        async function copyReportAsImage() {
            const copyStatus = document.getElementById('copyStatus');
            const buttons = document.querySelectorAll('.copy-button');
            
            buttons[1].disabled = true;
            buttons[1].textContent = '‚è≥ Generating...';
            
            try {
                // Create a temporary container with just the performance metrics and investment analysis
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                tempDiv.style.width = '540px'; // 60% of 900px to match display
                tempDiv.style.background = '#ffffff';
                tempDiv.style.padding = '20px';
                document.body.appendChild(tempDiv);
                
                // Add main header
                const mainHeader = document.createElement('div');
                mainHeader.className = 'header';
                const h1 = document.createElement('h1');
                h1.textContent = 'Performance Comparison';
                h1.style.fontSize = '28px';
                h1.style.fontWeight = '700';
                h1.style.color = '#1a1a1a';
                h1.style.marginBottom = '5px';
                mainHeader.appendChild(h1);
                
                const subtitle = document.createElement('div');
                subtitle.className = 'subtitle';
                const p1 = document.getElementById('portfolio1Description').textContent; const p2 = document.getElementById('portfolio2Description').textContent; subtitle.textContent = `${p1} vs ${p2}`;
                subtitle.style.fontSize = '14px';
                subtitle.style.color = '#666';
                subtitle.style.fontStyle = 'italic';
                subtitle.style.marginBottom = '15px';
                mainHeader.appendChild(subtitle);
                tempDiv.appendChild(mainHeader);
                
                // Clone the section header
                const perfHeader = document.querySelector('.section-header');
                if (perfHeader) {
                    tempDiv.appendChild(perfHeader.cloneNode(true));
                }
                
                // Clone portfolio key
                const portfolioKey = document.getElementById('portfolioKey');
                if (portfolioKey) {
                    tempDiv.appendChild(portfolioKey.cloneNode(true));
                }
                
                // Clone the performance table with all its content
                const perfTable = document.querySelector('.performance-table');
                if (perfTable) {
                    const tableClone = perfTable.cloneNode(true);
                    // Ensure tbody content is captured
                    const originalTbody = perfTable.querySelector('tbody');
                    const cloneTbody = tableClone.querySelector('tbody');
                    if (originalTbody && cloneTbody) {
                        cloneTbody.innerHTML = originalTbody.innerHTML;
                    }
                    tempDiv.appendChild(tableClone);
                }
                
                // Clone the Investment Analysis section
                const invHeader = document.querySelectorAll('.section-header')[1];
                if (invHeader) {
                    tempDiv.appendChild(invHeader.cloneNode(true));
                }
                
                const metricsContainer = document.querySelector('.metrics-container');
                if (metricsContainer) {
                    tempDiv.appendChild(metricsContainer.cloneNode(true));
                }
                
                // Clone the note
                const note = document.querySelectorAll('#presentationContent > div[style*="font-size: 11px"]')[0];
                if (note) {
                    tempDiv.appendChild(note.cloneNode(true));
                }
                
                const canvas = await html2canvas(tempDiv, {
                    backgroundColor: '#ffffff',
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    allowTaint: true
                });
                
                // Clean up
                document.body.removeChild(tempDiv);
                
                canvas.toBlob(async (blob) => {
                    try {
                        await navigator.clipboard.write([
                            new ClipboardItem({'image/png': blob})
                        ]);
                        
                        copyStatus.textContent = '‚úì Performance data copied to clipboard!';
                        copyStatus.style.display = 'block';
                        
                        setTimeout(() => {
                            copyStatus.style.display = 'none';
                        }, 3000);
                        
                    } catch (err) {
                        const url = canvas.toDataURL('image/png');
                        const link = document.createElement('a');
                        link.download = 'performance-comparison.png';
                        link.href = url;
                        link.click();
                        
                        copyStatus.textContent = '‚úì Performance data downloaded!';
                        copyStatus.style.display = 'block';
                        
                        setTimeout(() => {
                            copyStatus.style.display = 'none';
                        }, 3000);
                    }
                }, 'image/png');
                
            } catch (err) {
                alert('Failed to generate image: ' + err.message);
            } finally {
                buttons[1].disabled = false;
                buttons[1].textContent = 'üìã Copy Performance Report';
            }
        }
        
        async function copyRiskMetricsAsImage() {
            const riskMetricsContent = document.getElementById('riskMetricsContent');
            const copyStatus = document.getElementById('copyStatus');
            const buttons = document.querySelectorAll('.copy-button');
            
            buttons[3].disabled = true;
            buttons[3].textContent = '‚è≥ Generating...';
            
            try {
                // Create temp container with 60% width to match display
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                tempDiv.style.width = '540px'; // 60% of 900px container
                tempDiv.style.background = '#ffffff';
                tempDiv.style.padding = '20px';
                tempDiv.style.borderRadius = '8px';
                document.body.appendChild(tempDiv);
                
                // Add section header
                const header = document.createElement('div');
                header.className = 'section-header';
                header.style.marginTop = '0';
                header.textContent = 'Advanced Risk Metrics';
                tempDiv.appendChild(header);
                
                // Add portfolio key
                const portfolioKey = document.createElement('div');
                portfolioKey.style.textAlign = 'center';
                portfolioKey.style.fontSize = '13px';
                portfolioKey.style.color = '#666';
                portfolioKey.style.fontStyle = 'italic';
                portfolioKey.style.marginTop = '3px';
                portfolioKey.style.marginBottom = '8px';
                const portfolio1Name = document.getElementById('portfolio1DescriptionRisk').textContent;
                const portfolio2Name = document.getElementById('portfolio2DescriptionRisk').textContent;
                portfolioKey.innerHTML = `<span>${portfolio1Name}</span> vs <span>${portfolio2Name}</span>`;
                tempDiv.appendChild(portfolioKey);
                
                // Clone risk metrics content
                const riskContentClone = document.createElement('div');
                riskContentClone.innerHTML = riskMetricsContent.innerHTML;
                riskContentClone.style.background = '#fafbfc';
                riskContentClone.style.padding = '12px';
                riskContentClone.style.borderRadius = '8px';
                tempDiv.appendChild(riskContentClone);
                
                const canvas = await html2canvas(tempDiv, {
                    backgroundColor: '#ffffff',
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    allowTaint: true
                });
                
                // Clean up
                document.body.removeChild(tempDiv);
                
                canvas.toBlob(async (blob) => {
                    try {
                        await navigator.clipboard.write([
                            new ClipboardItem({'image/png': blob})
                        ]);
                        
                        copyStatus.textContent = '‚úì Risk metrics copied to clipboard!';
                        copyStatus.style.display = 'block';
                        
                        setTimeout(() => {
                            copyStatus.style.display = 'none';
                        }, 3000);
                        
                    } catch (err) {
                        const url = canvas.toDataURL('image/png');
                        const link = document.createElement('a');
                        link.download = 'risk-metrics.png';
                        link.href = url;
                        link.click();
                        
                        copyStatus.textContent = '‚úì Risk metrics downloaded!';
                        copyStatus.style.display = 'block';
                        
                        setTimeout(() => {
                            copyStatus.style.display = 'none';
                        }, 3000);
                    }
                }, 'image/png');
                
            } catch (err) {
                alert('Failed to generate image: ' + err.message);
            } finally {
                buttons[3].disabled = false;
                buttons[3].textContent = 'üìä Copy Risk Metrics';
            }
        }
        
        async function copyGrowthChartAsImage() {
            const copyStatus = document.getElementById('copyStatus');
            const buttons = document.querySelectorAll('.copy-button');
            
            buttons[2].disabled = true;
            buttons[2].textContent = '‚è≥ Generating...';
            
            try {
                // Create temp container
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                tempDiv.style.width = '540px'; // 60% of 900px
                tempDiv.style.background = '#ffffff';
                tempDiv.style.padding = '20px';
                document.body.appendChild(tempDiv);
                
                // Add Portfolio Growth section header
                const growthHeader = document.querySelectorAll('.section-header')[2];
                if (growthHeader) {
                    tempDiv.appendChild(growthHeader.cloneNode(true));
                }
                
                // Add chart content container
                const chartContentDiv = document.createElement('div');
                chartContentDiv.style.background = '#ffffff';
                chartContentDiv.style.padding = '15px';
                chartContentDiv.style.borderRadius = '8px';
                chartContentDiv.style.marginTop = '6px';
                
                // Add chart title and subtitle
                const titleDiv = document.createElement('div');
                titleDiv.style.textAlign = 'center';
                titleDiv.style.marginBottom = '10px';
                
                const h3 = document.createElement('h3');
                h3.textContent = '$100,000 Investment Growth';
                h3.style.fontSize = '18px';
                h3.style.color = '#1a1a1a';
                h3.style.fontWeight = '600';
                h3.style.marginBottom = '3px';
                titleDiv.appendChild(h3);
                
                const subtitle = document.getElementById('chartSubtitle').cloneNode(true);
                titleDiv.appendChild(subtitle);
                chartContentDiv.appendChild(titleDiv);
                
                // Add the chart canvas
                const chartCanvas = document.getElementById('growthChart');
                if (chartCanvas) {
                    const canvasClone = document.createElement('canvas');
                    canvasClone.width = chartCanvas.width;
                    canvasClone.height = chartCanvas.height;
                    const ctx = canvasClone.getContext('2d');
                    ctx.drawImage(chartCanvas, 0, 0);
                    canvasClone.style.width = '100%';
                    canvasClone.style.height = 'auto';
                    chartContentDiv.appendChild(canvasClone);
                }
                
                // Add chart note
                const chartNote = document.createElement('div');
                chartNote.textContent = 'Growth calculated from annual returns with annual rebalancing.';
                chartNote.style.textAlign = 'center';
                chartNote.style.fontSize = '11px';
                chartNote.style.color = '#999';
                chartNote.style.fontStyle = 'italic';
                chartNote.style.marginTop = '8px';
                chartContentDiv.appendChild(chartNote);
                
                tempDiv.appendChild(chartContentDiv);
                
                // Generate image using html2canvas
                const canvas = await html2canvas(tempDiv, {
                    backgroundColor: '#ffffff',
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    allowTaint: true
                });
                
                // Clean up
                document.body.removeChild(tempDiv);
                
                // Convert to blob and copy
                canvas.toBlob(async (blob) => {
                    try {
                        await navigator.clipboard.write([
                            new ClipboardItem({'image/png': blob})
                        ]);
                        
                        copyStatus.textContent = '‚úì Growth chart copied to clipboard!';
                        copyStatus.style.display = 'block';
                        
                        setTimeout(() => {
                            copyStatus.style.display = 'none';
                        }, 3000);
                        
                    } catch (err) {
                        const url = canvas.toDataURL('image/png');
                        const link = document.createElement('a');
                        link.download = 'growth-chart.png';
                        link.href = url;
                        link.click();
                        
                        copyStatus.textContent = '‚úì Growth chart downloaded!';
                        copyStatus.style.display = 'block';
                        
                        setTimeout(() => {
                            copyStatus.style.display = 'none';
                        }, 3000);
                    }
                }, 'image/png');
                
            } catch (err) {
                alert('Failed to generate image: ' + err.message);
            } finally {
                buttons[2].disabled = false;
                buttons[2].textContent = 'üìà Copy Growth Chart';
            }
        }
    
        
        // ============================================================================
        // DATA UPDATE FUNCTIONALITY
        // ============================================================================
        
        document.getElementById('updateDataInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Get date values from input boxes
            const startDateInput = document.getElementById('startDateInput').value;
            const endDateInput = document.getElementById('endDateInput').value;
            
            if (!startDateInput || !endDateInput) {
                alert('Please enter both start and end dates');
                return;
            }
            
            // Parse dates
            const startDate = new Date(startDateInput);
            const endDate = new Date(endDateInput);
            
            // Calculate years
            const yearsDiff = Math.round((endDate - startDate) / (365.25 * 24 * 60 * 60 * 1000));
            
            // Format dates for display
            const startDateLong = startDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
            const endDateLong = endDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
            const startDateShort = startDate.toLocaleDateString('en-US', { month: '2-digit', day: '2-digit', year: 'numeric' });
            const endDateShort = endDate.toLocaleDateString('en-US', { month: '2-digit', day: '2-digit', year: 'numeric' });
            const yearRange = `${startDate.getFullYear()}-${endDate.getFullYear()}`;
            
            const statusDiv = document.getElementById('updateStatus');
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = '<span style="color: #007bff;">‚è≥ Reading file...</span>';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // Parse Excel file
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, {header: 1});
                    
                    if (jsonData.length < 40) {
                        throw new Error(`Excel file must have at least 40 rows (found ${jsonData.length})`);
                    }
                    
                    // Validate structure
                    const modelCount = jsonData[1].filter((cell, idx) => idx >= 2 && cell).length;
                    if (modelCount < 1) {
                        throw new Error('No model columns found in Excel file');
                    }
                    
                    statusDiv.innerHTML = '<span style="color: #007bff;">‚è≥ Generating updated HTML file...</span>';
                    
                    // IMMEDIATELY create updated HTML with new data baked in
                    try {
                        let htmlContent = document.documentElement.outerHTML;
                        const doctype = "<!DOCTYPE html>\n";
                        
                        // Prepare the new data string
                        const newDataString = 'const EXCEL_DATA = ' + JSON.stringify(jsonData, null, 2) + ';';
                        
                        // Replace EXCEL_DATA in the HTML code
                        const dataPattern = /(const|var|let)\s+EXCEL_DATA\s*=\s*\[[\s\S]*?\];/;
                        
                        if (!dataPattern.test(htmlContent)) {
                            throw new Error('Could not find EXCEL_DATA in HTML. Contact support.');
                        }
                        
                        htmlContent = htmlContent.replace(dataPattern, newDataString);
                        
                        // Replace date constants
                        htmlContent = htmlContent.replace(/const DATA_START_DATE = "[^"]*";/, `const DATA_START_DATE = "${startDateLong}";`);
                        htmlContent = htmlContent.replace(/const DATA_END_DATE = "[^"]*";/, `const DATA_END_DATE = "${endDateLong}";`);
                        htmlContent = htmlContent.replace(/const DATA_START_DATE_SHORT = "[^"]*";/, `const DATA_START_DATE_SHORT = "${startDateShort}";`);
                        htmlContent = htmlContent.replace(/const DATA_END_DATE_SHORT = "[^"]*";/, `const DATA_END_DATE_SHORT = "${endDateShort}";`);
                        htmlContent = htmlContent.replace(/const DATA_YEAR_RANGE = "[^"]*";/, `const DATA_YEAR_RANGE = "${yearRange}";`);
                        htmlContent = htmlContent.replace(/const DATA_YEARS_COUNT = \d+;/, `const DATA_YEARS_COUNT = ${yearsDiff};`);
                        
                        // Replace the years value in EXCEL_DATA row 16 (where it says [20] or [19])
                        htmlContent = htmlContent.replace(/\[\s*19\s*\]/, `[${yearsDiff}]`);
                        htmlContent = htmlContent.replace(/\[\s*20\s*\]/, `[${yearsDiff}]`);
                        
                        // Auto-download the updated file
                        const blob = new Blob([doctype + htmlContent], { type: 'text/html' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'index.html';
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                        
                        statusDiv.innerHTML = `<span style="color: #28a745;">‚úÖ Success! Downloaded index.html with ${modelCount} models and date range ${startDateLong} - ${endDateLong} (${yearsDiff} years).<br><br><strong>Next Steps:</strong><br>1. Replace your current index.html with the downloaded file<br>2. Upload to GitHub and push changes<br>3. Refresh this page to see new data</span>`;
                        
                    } catch (error) {
                        throw new Error('Failed to generate HTML: ' + error.message);
                    }
                    
                } catch (error) {
                    statusDiv.innerHTML = `<span style="color: #dc3545;">‚ùå Error: ${error.message}</span>`;
                    console.error('Error updating data:', error);
                }
            };
            
            reader.onerror = function() {
                statusDiv.innerHTML = '<span style="color: #dc3545;">‚ùå Error reading file</span>';
            };
            
            reader.readAsArrayBuffer(file);
        });
        
        // Pie Chart Variables
        let pieChart1 = null;
        let pieChart2 = null;
        
        // Create Pie Charts for Portfolio Allocations
        function createPieCharts(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6,
                                 col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8,
                                 portfolio1Name, portfolio2Name) {
            // Current Data
            const p1Data = [];
            const p1Labels = [];
            const p1Colors = ['#4472C4', '#ED7D31', '#A5A5A5', '#FFC000'];
            
            if (col1 && alloc1 > 0) {
                const header1 = columnHeaders.find(h => h.index === col1);
                p1Labels.push(header1.name);
                p1Data.push(alloc1);
            }
            if (col2 && alloc2 > 0) {
                const header2 = columnHeaders.find(h => h.index === col2);
                p1Labels.push(header2.name);
                p1Data.push(alloc2);
            }
            if (col5 && alloc5 > 0) {
                const header5 = columnHeaders.find(h => h.index === col5);
                p1Labels.push(header5.name);
                p1Data.push(alloc5);
            }
            if (col6 && alloc6 > 0) {
                const header6 = columnHeaders.find(h => h.index === col6);
                p1Labels.push(header6.name);
                p1Data.push(alloc6);
            }
            
            // Modeled Data
            const p2Data = [];
            const p2Labels = [];
            const p2Colors = ['#70AD47', '#FFC000', '#5B9BD5', '#FF6B6B'];
            
            if (col3 && alloc3 > 0) {
                const header3 = columnHeaders.find(h => h.index === col3);
                p2Labels.push(header3.name);
                p2Data.push(alloc3);
            }
            if (col4 && alloc4 > 0) {
                const header4 = columnHeaders.find(h => h.index === col4);
                p2Labels.push(header4.name);
                p2Data.push(alloc4);
            }
            if (col7 && alloc7 > 0) {
                const header7 = columnHeaders.find(h => h.index === col7);
                p2Labels.push(header7.name);
                p2Data.push(alloc7);
            }
            if (col8 && alloc8 > 0) {
                const header8 = columnHeaders.find(h => h.index === col8);
                p2Labels.push(header8.name);
                p2Data.push(alloc8);
            }
            
            // Destroy existing charts
            if (pieChart1) pieChart1.destroy();
            if (pieChart2) pieChart2.destroy();
            
            // Create Current Pie Chart
            const ctx1 = document.getElementById('pieChart1').getContext('2d');
            pieChart1 = new Chart(ctx1, {
                type: 'pie',
                data: {
                    labels: p1Labels,
                    datasets: [{
                        data: p1Data,
                        backgroundColor: p1Colors.slice(0, p1Data.length),
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { font: { size: 11 }, padding: 10 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // Create Modeled Pie Chart
            const ctx2 = document.getElementById('pieChart2').getContext('2d');
            pieChart2 = new Chart(ctx2, {
                type: 'pie',
                data: {
                    labels: p2Labels,
                    datasets: [{
                        data: p2Data,
                        backgroundColor: p2Colors.slice(0, p2Data.length),
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { font: { size: 11 }, padding: 10 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // Update titles
            document.getElementById('pieChart1Title').textContent = 'Current: ' + portfolio1Name;
            document.getElementById('pieChart2Title').textContent = 'Modeled: ' + portfolio2Name;
            
            // Show pie charts section
            document.getElementById('pieChartsSection').style.display = 'flex';
        }
        
        // Download Report as PDF
        async function downloadReportAsPDF() {
            const button = document.getElementById('pdfDownloadButton');
            const originalText = button.innerHTML;
            
            try {
                button.innerHTML = '‚è≥ Generating PDF...';
                button.disabled = true;
                
                // Get jsPDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'letter');
                
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 15;
                const contentWidth = pageWidth - (2 * margin);
                
                // Get report sections
                const header = document.querySelector('.header');
                const perfSection = document.querySelector('.performance-table');
                const pieSection = document.getElementById('pieChartsSection');
                const metricsSection = document.querySelector('.metrics-container');
                const chartSection = document.querySelector('.chart-container');
                const riskSection = document.querySelectorAll('.metrics-container')[1];
                
                let yPosition = margin;
                
                // Page 1: Header + Performance Table
                if (header) {
                    const canvas1 = await html2canvas(header, { scale: 2, backgroundColor: '#ffffff' });
                    const imgData1 = canvas1.toDataURL('image/png');
                    const imgHeight1 = (canvas1.height * contentWidth) / canvas1.width;
                    pdf.addImage(imgData1, 'PNG', margin, yPosition, contentWidth, imgHeight1);
                    yPosition += imgHeight1 + 5;
                }
                
                // Performance Table
                if (perfSection) {
                    const tableParent = perfSection.parentElement;
                    const sectionHeader = tableParent.querySelector('.section-header');
                    const portfolioKey = tableParent.querySelector('#portfolioKey');
                    
                    // Add section header
                    if (sectionHeader) {
                        pdf.setFontSize(16);
                        pdf.setFont(undefined, 'bold');
                        pdf.text(sectionHeader.textContent, margin, yPosition);
                        yPosition += 7;
                    }
                    
                    // Add portfolio key
                    if (portfolioKey) {
                        pdf.setFontSize(10);
                        pdf.setFont(undefined, 'italic');
                        pdf.setTextColor(102, 102, 102);
                        pdf.text(portfolioKey.textContent, pageWidth / 2, yPosition, { align: 'center' });
                        pdf.setTextColor(0, 0, 0);
                        yPosition += 8;
                    }
                    
                    const canvas2 = await html2canvas(perfSection, { scale: 2, backgroundColor: '#ffffff' });
                    const imgData2 = canvas2.toDataURL('image/png');
                    const imgHeight2 = (canvas2.height * contentWidth) / canvas2.width;
                    
                    if (yPosition + imgHeight2 > pageHeight - margin) {
                        pdf.addPage();
                        yPosition = margin;
                    }
                    
                    pdf.addImage(imgData2, 'PNG', margin, yPosition, contentWidth, imgHeight2);
                    yPosition += imgHeight2 + 10;
                }
                
                // Pie Charts
                if (pieSection && pieSection.style.display !== 'none') {
                    if (yPosition + 80 > pageHeight - margin) {
                        pdf.addPage();
                        yPosition = margin;
                    }
                    
                    const canvas3 = await html2canvas(pieSection, { scale: 2, backgroundColor: '#ffffff' });
                    const imgData3 = canvas3.toDataURL('image/png');
                    const imgHeight3 = (canvas3.height * contentWidth) / canvas3.width;
                    pdf.addImage(imgData3, 'PNG', margin, yPosition, contentWidth, imgHeight3);
                    yPosition += imgHeight3 + 10;
                }
                
                // Page 2: Investment Analysis
                if (metricsSection) {
                    pdf.addPage();
                    yPosition = margin;
                    
                    pdf.setFontSize(16);
                    pdf.setFont(undefined, 'bold');
                    pdf.text('19-Year Investment Lookback Analysis', margin, yPosition);
                    yPosition += 10;
                    
                    const canvas4 = await html2canvas(metricsSection, { scale: 2, backgroundColor: '#ffffff' });
                    const imgData4 = canvas4.toDataURL('image/png');
                    const imgHeight4 = (canvas4.height * contentWidth) / canvas4.width;
                    pdf.addImage(imgData4, 'PNG', margin, yPosition, contentWidth, imgHeight4);
                }
                
                // Page 3: Growth Chart
                if (chartSection) {
                    pdf.addPage();
                    yPosition = margin;
                    
                    pdf.setFontSize(16);
                    pdf.setFont(undefined, 'bold');
                    pdf.text('Portfolio Growth Over Time', margin, yPosition);
                    yPosition += 10;
                    
                    const canvas5 = await html2canvas(chartSection, { scale: 2, backgroundColor: '#ffffff' });
                    const imgData5 = canvas5.toDataURL('image/png');
                    const imgHeight5 = (canvas5.height * contentWidth) / canvas5.width;
                    pdf.addImage(imgData5, 'PNG', margin, yPosition, contentWidth, imgHeight5);
                }
                
                // Page 4: Risk Metrics
                if (riskSection) {
                    pdf.addPage();
                    yPosition = margin;
                    
                    pdf.setFontSize(16);
                    pdf.setFont(undefined, 'bold');
                    pdf.text('Advanced Risk Metrics', margin, yPosition);
                    yPosition += 10;
                    
                    const canvas6 = await html2canvas(riskSection, { scale: 2, backgroundColor: '#ffffff' });
                    const imgData6 = canvas6.toDataURL('image/png');
                    const imgHeight6 = (canvas6.height * contentWidth) / canvas6.width;
                    pdf.addImage(imgData6, 'PNG', margin, yPosition, contentWidth, imgHeight6);
                }
                
                // Save PDF
                const p1Name = document.getElementById('portfolio1Description').textContent.replace(/\s+/g, '_');
                const p2Name = document.getElementById('portfolio2Description').textContent.replace(/\s+/g, '_');
                const filename = `Performance_Report_${p1Name}_vs_${p2Name}.pdf`;
                pdf.save(filename);
                
                button.innerHTML = '‚úÖ Downloaded!';
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('PDF generation error:', error);
                button.innerHTML = '‚ùå Error';
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 2000);
            }
        }
        
        // ============================================================================
        // MODEL CONFIGURATION MANAGEMENT
        // ============================================================================
        
        function populateModelConfigTable() {
            const tableBody = document.getElementById('modelConfigTable');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            // Get all available models from column headers (dynamically loaded from Excel)
            const models = columnHeaders.map(header => ({
                index: header.index,
                name: header.name
            }));
            
            models.forEach(model => {
                const row = document.createElement('tr');
                row.style.borderBottom = '1px solid #dee2e6';
                
                const inPortfolio1 = MODEL_CONFIG.portfolio1.includes(model.index);
                const inPortfolio2 = MODEL_CONFIG.portfolio2.includes(model.index);
                
                row.innerHTML = `
                    <td style="padding: 12px; text-align: left;">${model.name}</td>
                    <td style="padding: 12px; text-align: center; color: #6c757d; font-family: monospace;">${model.index}</td>
                    <td style="padding: 12px; text-align: center;">
                        <input type="checkbox" id="p1_${model.index}" ${inPortfolio1 ? 'checked' : ''} 
                               style="width: 18px; height: 18px; cursor: pointer;">
                    </td>
                    <td style="padding: 12px; text-align: center;">
                        <input type="checkbox" id="p2_${model.index}" ${inPortfolio2 ? 'checked' : ''} 
                               style="width: 18px; height: 18px; cursor: pointer;">
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        function saveModelConfig() {
            // Updates MODEL_CONFIG in memory for immediate preview
            // To persist: Export HTML after making changes
            MODEL_CONFIG.portfolio1 = [];
            MODEL_CONFIG.portfolio2 = [];
            
            // Use columnHeaders instead of hardcoded models
            columnHeaders.forEach(header => {
                const p1Checkbox = document.getElementById(`p1_${header.index}`);
                const p2Checkbox = document.getElementById(`p2_${header.index}`);
                
                if (p1Checkbox && p1Checkbox.checked) {
                    MODEL_CONFIG.portfolio1.push(header.index);
                }
                if (p2Checkbox && p2Checkbox.checked) {
                    MODEL_CONFIG.portfolio2.push(header.index);
                }
            });
            
            // Update the dropdowns immediately
            populateSelectors();
            
            const status = document.getElementById('configStatus');
            status.textContent = '‚úÖ Model configuration updated! Export HTML to make permanent.';
            status.style.color = '#28a745';
            
            // Hide success message after 3 seconds
            setTimeout(() => {
                status.textContent = '';
            }, 3000);
            
            console.log('‚úÖ Model config updated (in memory):', MODEL_CONFIG);
        }
        
        function generateUpdatedHTML() {
            // Get the current HTML
            let htmlContent = document.documentElement.outerHTML;
            
            // CRITICAL: Ensure updateDataSection is ALWAYS display: none in the HTML
            htmlContent = htmlContent.replace(
                /id="updateDataSection" style="display:\s*block\s*(!important)?;/g,
                'id="updateDataSection" style="display: none !important;'
            );
            
            // Create the new MODEL_CONFIG code
            const newModelConfig = `const MODEL_CONFIG = {
    portfolio1: [${MODEL_CONFIG.portfolio1.join(', ')}], // Current portfolio - limited models
    portfolio2: [${MODEL_CONFIG.portfolio2.join(', ')}] // Modeled - all models
};`;
            
            // Replace the old MODEL_CONFIG with new one
            const configRegex = /const MODEL_CONFIG = \{[\s\S]*?\};/;
            const updatedHTML = htmlContent.replace(configRegex, newModelConfig);
            
            // Create download button if it doesn't exist
            let downloadBtn = document.getElementById('downloadConfigHTML');
            if (!downloadBtn) {
                downloadBtn = document.createElement('button');
                downloadBtn.id = 'downloadConfigHTML';
                downloadBtn.innerHTML = 'üíæ Download Updated HTML File';
                downloadBtn.style.cssText = 'margin-top: 15px; padding: 12px 24px; background: #007bff; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 14px;';
                document.getElementById('configStatus').parentNode.appendChild(downloadBtn);
            }
            
            downloadBtn.onclick = function() {
                const blob = new Blob([updatedHTML], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'index.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                const status = document.getElementById('configStatus');
                status.textContent = '‚úÖ File downloaded! Replace your current index.html with this file.';
                status.style.color = '#28a745';
            };
            
            downloadBtn.style.display = 'inline-block';
        }
        
        function updatePortfolioDropdowns() {
            // Update Current (Current - rows A, B, C, D using option1, option2, option5, option6)
            const p1Selects = [
                document.getElementById('option1Select'),
                document.getElementById('option2Select'),
                document.getElementById('option5Select'),
                document.getElementById('option6Select')
            ];
            
            // Update Modeled (Modeled - rows E, F, G, H using option3, option4, option7, option8)
            const p2Selects = [
                document.getElementById('option3Select'),
                document.getElementById('option4Select'),
                document.getElementById('option7Select'),
                document.getElementById('option8Select')
            ];
            
            const modelNames = {
                2: '60/40',
                3: 'WavRyder QQQ',
                4: 'WavRyder SP500',
                5: 'Aggressive WR Adj',
                6: 'Moderate WR Adj',
                7: 'Conservative WR Adj',
                8: 'Leveraged Nasdaq',
                9: 'Leveraged S&P500',
                10: 'WavRyder QQQ/SP500 Leveraged)',
                11: 'QQQ (Leveraged) W/O WavRyder',
                12: 'SP 500',
                13: 'Bond',
                14: 'WavRyder AGG',
                15: 'International',
                16: 'WavRyder VEA',
                17: 'QQQ',
                18: 'S&P500',
                19: 'WavRyder SPY'
            };
            
            // Update Current dropdowns
            p1Selects.forEach(select => {
                if (!select) return;
                const currentValue = select.value;
                select.innerHTML = '<option value="">--</option>';
                MODEL_CONFIG.portfolio1.forEach(index => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = modelNames[index] || `Model ${index}`;
                    select.appendChild(option);
                });
                // Restore previous selection if still valid
                if (MODEL_CONFIG.portfolio1.includes(parseInt(currentValue))) {
                    select.value = currentValue;
                }
            });
            
            // Update Modeled dropdowns
            p2Selects.forEach(select => {
                if (!select) return;
                const currentValue = select.value;
                select.innerHTML = '<option value="">--</option>';
                MODEL_CONFIG.portfolio2.forEach(index => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = modelNames[index] || `Model ${index}`;
                    select.appendChild(option);
                });
                // Restore previous selection if still valid
                if (MODEL_CONFIG.portfolio2.includes(parseInt(currentValue))) {
                    select.value = currentValue;
                }
            });
        }
        
        // Initialize model config table when #update is accessed
        if (window.location.hash === '#update') {
            setTimeout(() => {
                populateModelConfigTable();
            }, 100);
        }
        
        // ============================================================================
        // INSTRUCTIONS MANAGEMENT
        // ============================================================================
        
        function toggleInstructions() {
            const content = document.getElementById('instructionsContent');
            const toggle = document.getElementById('instructionsToggle');
            
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                toggle.style.transform = 'rotate(180deg)';
                toggle.textContent = '‚ñ≤';
            } else {
                content.style.display = 'none';
                toggle.style.transform = 'rotate(0deg)';
                toggle.textContent = '‚ñº';
            }
        }
        
        function editInstructions() {
            const textDiv = document.getElementById('instructionsText');
            const currentHTML = textDiv.innerHTML;
            
            // Create textarea for editing
            const editArea = document.createElement('div');
            editArea.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #495057;">
                        Edit Instructions (HTML supported):
                    </label>
                    <textarea id="instructionsEditor" style="width: 100%; min-height: 400px; padding: 12px; 
                                font-family: monospace; font-size: 13px; border: 2px solid #dee2e6; 
                                border-radius: 6px; resize: vertical;">${currentHTML}</textarea>
                </div>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button onclick="saveInstructions()" style="padding: 10px 24px; background: #28a745; color: white; 
                            border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                        üíæ Save Instructions
                    </button>
                    <button onclick="cancelEditInstructions()" style="padding: 10px 24px; background: #6c757d; color: white; 
                            border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                        ‚úñÔ∏è Cancel
                    </button>
                    <button onclick="resetInstructions()" style="padding: 10px 24px; background: #dc3545; color: white; 
                            border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                        üîÑ Reset to Default
                    </button>
                </div>
                <div id="instructionsSaveStatus" style="margin-top: 15px; text-align: center; font-weight: 600;"></div>
            `;
            
            textDiv.style.display = 'none';
            textDiv.parentNode.insertBefore(editArea, textDiv.nextSibling);
            editArea.id = 'instructionsEditArea';
        }
        
        function saveInstructions() {
            const editor = document.getElementById('instructionsEditor');
            const textDiv = document.getElementById('instructionsText');
            const editArea = document.getElementById('instructionsEditArea');
            const status = document.getElementById('instructionsSaveStatus');
            
            if (!editor || !textDiv) return;
            
            // Update the instructions
            textDiv.innerHTML = editor.value;
            
            // Save to localStorage
            try {
                localStorage.setItem('customInstructions', editor.value);
                status.textContent = '‚úÖ Instructions saved successfully!';
                status.style.color = '#28a745';
            } catch (e) {
                status.textContent = '‚ö†Ô∏è Could not save to browser storage';
                status.style.color = '#ffc107';
            }
            
            // Show the text div and remove edit area
            setTimeout(() => {
                textDiv.style.display = 'block';
                if (editArea) editArea.remove();
            }, 1500);
        }
        
        function cancelEditInstructions() {
            const textDiv = document.getElementById('instructionsText');
            const editArea = document.getElementById('instructionsEditArea');
            
            textDiv.style.display = 'block';
            if (editArea) editArea.remove();
        }
        
        function resetInstructions() {
            if (!confirm('Reset instructions to default? This will overwrite your custom instructions.')) {
                return;
            }
            
            const textDiv = document.getElementById('instructionsText');
            const defaultInstructions = `
                <h4 style="color: #2196f3; margin: 0 0 15px 0; font-size: 16px;">üìä Quick Start Guide</h4>
                
                <div style="margin-bottom: 20px;">
                    <strong style="color: #1976d2;">STEP 1: Current Portfolio</strong> (What you have today)
                    <ul style="margin: 8px 0 0 20px;">
                        <li><strong>Quick Templates:</strong> Select a preset allocation (Conservative, Moderate, Balanced, etc.)</li>
                        <li><strong>Custom Build:</strong> Use rows A-D to select models and allocation percentages</li>
                        <li><strong>Must total 100%</strong></li>
                    </ul>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <strong style="color: #1976d2;">STEP 2: Modeled Portfolio</strong> (What you're considering)
                    <ul style="margin: 8px 0 0 20px;">
                        <li>Scroll down to the second portfolio section</li>
                        <li>Build your proposed allocation using rows A-D</li>
                        <li>More model options available</li>
                        <li><strong>Must total 100%</strong></li>
                    </ul>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <strong style="color: #1976d2;">STEP 3: Compare</strong>
                    <ul style="margin: 8px 0 0 20px;">
                        <li>Click <strong>"Compare Portfolios"</strong> button</li>
                        <li>View historical performance comparison</li>
                        <li>See growth charts, metrics, and risk analysis</li>
                    </ul>
                </div>
                
                <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 12px; margin-top: 15px; border-radius: 4px;">
                    <strong>üí° Tip:</strong> Use Quick Templates to load common allocations instantly, then customize as needed!
                </div>
                
                <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 12px; margin-top: 10px; border-radius: 4px; font-size: 13px;">
                    <strong>‚ö†Ô∏è Important:</strong> This tool shows hypothetical historical performance. Past results do not guarantee future returns. For educational purposes only.
                </div>
            `;
            
            textDiv.innerHTML = defaultInstructions;
            localStorage.removeItem('customInstructions');
            cancelEditInstructions();
            
            alert('Instructions reset to default!');
        }
        
        // Load custom instructions on page load
        function loadCustomInstructions() {
            try {
                const customInstructions = localStorage.getItem('customInstructions');
                if (customInstructions) {
                    const textDiv = document.getElementById('instructionsText');
                    if (textDiv) {
                        textDiv.innerHTML = customInstructions;
                    }
                }
            } catch (e) {
                console.log('Could not load custom instructions');
            }
            
            // Show/hide edit button based on #update mode
            const editBtn = document.getElementById('editInstructionsBtn');
            if (editBtn) {
                if (window.location.hash === '#update') {
                    editBtn.style.display = 'block';
                } else {
                    editBtn.style.display = 'none';
                }
            }
            
            // Listen for hash changes to show/hide edit button dynamically
            window.addEventListener('hashchange', function() {
                const editBtn = document.getElementById('editInstructionsBtn');
                if (editBtn) {
                    if (window.location.hash === '#update') {
                        editBtn.style.display = 'block';
                    } else {
                        editBtn.style.display = 'none';
                    }
                }
            });
        }
        
        // ============================================================================
        // RISK METRICS TOGGLE
        // ============================================================================
        
        function toggleRiskMetrics() {
            const section = document.getElementById('riskMetricsSection');
            const btn = document.getElementById('riskMetricsToggleBtn');
            
            if (section.style.display === 'none' || section.style.display === '') {
                section.style.display = 'block';
                btn.textContent = 'üìä Hide Advanced Risk Metrics';
                btn.style.background = 'linear-gradient(135deg, #f093fb, #f5576c)';
            } else {
                section.style.display = 'none';
                btn.textContent = 'üìä Show Advanced Risk Metrics';
                btn.style.background = 'linear-gradient(135deg, #667eea, #764ba2)';
            }
        }
        
        function toggleAdvancedMetricsVisibility() {
            const checkbox = document.getElementById('showAdvancedMetrics');
            SHOW_ADVANCED_METRICS = checkbox.checked;
            
            const status = document.getElementById('advancedMetricsStatus');
            if (SHOW_ADVANCED_METRICS) {
                status.textContent = '‚úÖ Advanced Metrics will be visible to end users';
                status.style.color = '#28a745';
            } else {
                status.textContent = '‚úÖ Advanced Metrics will be hidden from end users';
                status.style.color = '#6c757d';
            }
            
            // Hide status after 3 seconds
            setTimeout(() => {
                status.textContent = '';
            }, 3000);
            
            console.log('‚úÖ Advanced Metrics visibility set to:', SHOW_ADVANCED_METRICS);
        }
        
        function initializeAdvancedMetricsVisibility() {
            // On page load, hide/show the entire Advanced Metrics section based on setting
            const advancedMetricsContainer = document.querySelector('[style*="Advanced Risk Metrics"]')?.closest('div');
            const toggleButton = document.getElementById('riskMetricsToggleBtn');
            
            if (window.location.hash !== '#update') {
                // End user view - respect SHOW_ADVANCED_METRICS setting
                if (!SHOW_ADVANCED_METRICS && toggleButton) {
                    toggleButton.parentElement.style.display = 'none'; // Hide the button
                }
            } else {
                // Update mode - always show, set checkbox state
                const checkbox = document.getElementById('showAdvancedMetrics');
                if (checkbox) {
                    checkbox.checked = SHOW_ADVANCED_METRICS;
                }
            }
        }
        
        // ============================================================================
        // SCENARIO CONFIGURATION MANAGEMENT
        // ============================================================================
        
        function saveScenarios() {
            const scenarios = ['scenario1', 'scenario2', 'scenario3', 'scenario4'];
            
            scenarios.forEach((name, index) => {
                const num = index + 1;
                
                // Get values from inputs
                const title = document.getElementById(`s${num}_title`).value;
                const desc = document.getElementById(`s${num}_desc`).value;
                
                const p1_a = document.getElementById(`s${num}_p1_a`).value;
                const p1_a_pct = document.getElementById(`s${num}_p1_a_pct`).value;
                const p1_b = document.getElementById(`s${num}_p1_b`).value;
                const p1_b_pct = document.getElementById(`s${num}_p1_b_pct`).value;
                
                const p2_a = document.getElementById(`s${num}_p2_a`).value;
                const p2_a_pct = document.getElementById(`s${num}_p2_a_pct`).value;
                const p2_b = document.getElementById(`s${num}_p2_b`).value;
                const p2_b_pct = document.getElementById(`s${num}_p2_b_pct`).value;
                
                // Helper: Convert column name to index
                function findColumnIndex(colName) {
                    if (!colName || colName === 'None' || colName === '') return null;
                    const cleanName = colName.toString().trim();
                    const header = columnHeaders.find(h => 
                        h.name.toString().trim().toLowerCase() === cleanName.toLowerCase()
                    );
                    return header ? header.index : (isNaN(colName) ? null : parseInt(colName));
                }
                
                // Update SCENARIO_CONFIG
                SCENARIO_CONFIG[name] = {
                    title: title || SCENARIO_CONFIG[name].title,
                    desc: desc || SCENARIO_CONFIG[name].desc,
                    portfolio1: {
                        option1: findColumnIndex(p1_a),
                        alloc1: p1_a_pct ? parseInt(p1_a_pct) : 0,
                        option2: findColumnIndex(p1_b),
                        alloc2: p1_b_pct ? parseInt(p1_b_pct) : 0,
                        option5: null,
                        alloc5: 0,
                        option6: null,
                        alloc6: 0
                    },
                    portfolio2: {
                        option3: findColumnIndex(p2_a),
                        alloc3: p2_a_pct ? parseInt(p2_a_pct) : 0,
                        option4: findColumnIndex(p2_b),
                        alloc4: p2_b_pct ? parseInt(p2_b_pct) : 0,
                        option7: null,
                        alloc7: 0,
                        option8: null,
                        alloc8: 0
                    }
                };
                
                // Update button text in DOM immediately
                document.getElementById(`${name}_title`).textContent = title || SCENARIO_CONFIG[name].title;
                document.getElementById(`${name}_desc`).textContent = desc || SCENARIO_CONFIG[name].desc;
            });
            
            // Show success message
            const status = document.getElementById('scenarioStatus');
            status.textContent = '‚úÖ Scenarios updated! Export HTML to make permanent.';
            status.style.color = '#28a745';
            
            // Hide success message after 3 seconds
            setTimeout(() => {
                status.textContent = '';
            }, 3000);
            
            console.log('‚úÖ Scenarios updated (in memory):', SCENARIO_CONFIG);
        }
        
        function generateUpdatedHTMLWithScenarios() {
            let htmlContent = document.documentElement.outerHTML;
            
            // CRITICAL: Ensure updateDataSection is ALWAYS display: none in the HTML
            htmlContent = htmlContent.replace(
                /id="updateDataSection" style="display:\s*block\s*(!important)?;/g,
                'id="updateDataSection" style="display: none !important;'
            );
            
            // Create the new SCENARIO_CONFIG code
            const newScenarioConfig = `// SCENARIO CONFIGURATION DATA - Editable in #update mode
        const SCENARIO_CONFIG = {
            scenario1: {
                title: '${SCENARIO_CONFIG.scenario1.title}',
                desc: '${SCENARIO_CONFIG.scenario1.desc}',
                portfolio1: { option1: ${SCENARIO_CONFIG.scenario1.portfolio1.option1}, alloc1: ${SCENARIO_CONFIG.scenario1.portfolio1.alloc1}, option2: ${SCENARIO_CONFIG.scenario1.portfolio1.option2}, alloc2: ${SCENARIO_CONFIG.scenario1.portfolio1.alloc2}, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: ${SCENARIO_CONFIG.scenario1.portfolio2.option3}, alloc3: ${SCENARIO_CONFIG.scenario1.portfolio2.alloc3}, option4: ${SCENARIO_CONFIG.scenario1.portfolio2.option4}, alloc4: ${SCENARIO_CONFIG.scenario1.portfolio2.alloc4}, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario2: {
                title: '${SCENARIO_CONFIG.scenario2.title}',
                desc: '${SCENARIO_CONFIG.scenario2.desc}',
                portfolio1: { option1: ${SCENARIO_CONFIG.scenario2.portfolio1.option1}, alloc1: ${SCENARIO_CONFIG.scenario2.portfolio1.alloc1}, option2: ${SCENARIO_CONFIG.scenario2.portfolio1.option2}, alloc2: ${SCENARIO_CONFIG.scenario2.portfolio1.alloc2}, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: ${SCENARIO_CONFIG.scenario2.portfolio2.option3}, alloc3: ${SCENARIO_CONFIG.scenario2.portfolio2.alloc3}, option4: ${SCENARIO_CONFIG.scenario2.portfolio2.option4}, alloc4: ${SCENARIO_CONFIG.scenario2.portfolio2.alloc4}, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario3: {
                title: '${SCENARIO_CONFIG.scenario3.title}',
                desc: '${SCENARIO_CONFIG.scenario3.desc}',
                portfolio1: { option1: ${SCENARIO_CONFIG.scenario3.portfolio1.option1}, alloc1: ${SCENARIO_CONFIG.scenario3.portfolio1.alloc1}, option2: ${SCENARIO_CONFIG.scenario3.portfolio1.option2}, alloc2: ${SCENARIO_CONFIG.scenario3.portfolio1.alloc2}, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: ${SCENARIO_CONFIG.scenario3.portfolio2.option3}, alloc3: ${SCENARIO_CONFIG.scenario3.portfolio2.alloc3}, option4: ${SCENARIO_CONFIG.scenario3.portfolio2.option4}, alloc4: ${SCENARIO_CONFIG.scenario3.portfolio2.alloc4}, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario4: {
                title: '${SCENARIO_CONFIG.scenario4.title}',
                desc: '${SCENARIO_CONFIG.scenario4.desc}',
                portfolio1: { option1: ${SCENARIO_CONFIG.scenario4.portfolio1.option1}, alloc1: ${SCENARIO_CONFIG.scenario4.portfolio1.alloc1}, option2: ${SCENARIO_CONFIG.scenario4.portfolio1.option2}, alloc2: ${SCENARIO_CONFIG.scenario4.portfolio1.alloc2}, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: ${SCENARIO_CONFIG.scenario4.portfolio2.option3}, alloc3: ${SCENARIO_CONFIG.scenario4.portfolio2.alloc3}, option4: ${SCENARIO_CONFIG.scenario4.portfolio2.option4}, alloc4: ${SCENARIO_CONFIG.scenario4.portfolio2.alloc4}, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            }
        };`;
            
            // Replace the old SCENARIO_CONFIG with new one
            const scenarioRegex = /\/\/ SCENARIO CONFIGURATION DATA[\s\S]*?};/;
            let updatedHTML = htmlContent.replace(scenarioRegex, newScenarioConfig);
            
            // ALSO update the visible button text in the HTML (not just SCENARIO_CONFIG)
            // Update scenario button titles and descriptions in the HTML
            ['scenario1', 'scenario2', 'scenario3', 'scenario4'].forEach(name => {
                const scenario = SCENARIO_CONFIG[name];
                
                // Update title - match the id and replace content until the next <
                const titleRegex = new RegExp(`(id="${name}_title"[^>]*>\\s*)([^<]*)`, 'g');
                updatedHTML = updatedHTML.replace(titleRegex, `$1${scenario.title}`);
                
                // Update description
                const descRegex = new RegExp(`(id="${name}_desc"[^>]*>\\s*)([^<]*)`, 'g');
                updatedHTML = updatedHTML.replace(descRegex, `$1${scenario.desc}`);
            });
            
            // Create or update download button
            let downloadBtn = document.getElementById('downloadScenariosHTML');
            if (!downloadBtn) {
                downloadBtn = document.createElement('button');
                downloadBtn.id = 'downloadScenariosHTML';
                downloadBtn.innerHTML = 'üíæ Download Updated HTML File';
                downloadBtn.style.cssText = 'margin-top: 15px; padding: 12px 24px; background: #007bff; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 14px;';
                document.getElementById('scenarioStatus').parentNode.appendChild(downloadBtn);
            }
            
            downloadBtn.onclick = function() {
                const blob = new Blob([updatedHTML], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'index.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                const status = document.getElementById('scenarioStatus');
                status.textContent = '‚úÖ File downloaded! Replace your current index.html with this file.';
                status.style.color = '#28a745';
            };
            
            downloadBtn.style.display = 'inline-block';
            
            const status = document.getElementById('scenarioStatus');
            status.textContent = '‚úÖ Scenarios saved! Download updated HTML file below.';
            status.style.color = '#28a745';
        }
        
        function loadScenarioInputs() {
            // Load current scenario values into input fields
            const scenarios = ['scenario1', 'scenario2', 'scenario3', 'scenario4'];
            
            scenarios.forEach((name, index) => {
                const num = index + 1;
                const scenario = SCENARIO_CONFIG[name];
                
                if (!scenario) return;
                
                // Helper function to get column name from index
                function getColumnName(colIndex) {
                    if (!colIndex) return '';
                    const header = columnHeaders.find(h => h.index === colIndex);
                    return header ? header.name : colIndex;
                }
                
                // Set title and description
                document.getElementById(`s${num}_title`).value = scenario.title || '';
                document.getElementById(`s${num}_desc`).value = scenario.desc || '';
                
                // Portfolio 1 - show column names
                document.getElementById(`s${num}_p1_a`).value = getColumnName(scenario.portfolio1.option1);
                document.getElementById(`s${num}_p1_a_pct`).value = scenario.portfolio1.alloc1 || '';
                document.getElementById(`s${num}_p1_b`).value = getColumnName(scenario.portfolio1.option2);
                document.getElementById(`s${num}_p1_b_pct`).value = scenario.portfolio1.alloc2 || '';
                
                // Portfolio 2 - show column names
                document.getElementById(`s${num}_p2_a`).value = getColumnName(scenario.portfolio2.option3);
                document.getElementById(`s${num}_p2_a_pct`).value = scenario.portfolio2.alloc3 || '';
                document.getElementById(`s${num}_p2_b`).value = getColumnName(scenario.portfolio2.option4);
                document.getElementById(`s${num}_p2_b_pct`).value = scenario.portfolio2.alloc4 || '';
            });
            
            console.log('‚úÖ Populated scenario input fields');
        }
        
        // ============================================================================
        // EXCEL IS SINGLE SOURCE OF TRUTH
        // ============================================================================
        // Note: No localStorage for configs. All configurations come from Excel.
        // Workflow: Upload Excel ‚Üí Make any edits ‚Üí Export HTML ‚Üí Upload to GitHub
        
        
        // ============================================================================
        // EXPORT FOR GITHUB - PREVIEW & DOWNLOAD
        // ============================================================================
        
        function showExportPreview() {
            // Check if Excel has been uploaded (columnHeaders should be populated)
            if (!columnHeaders || columnHeaders.length === 0) {
                alert('‚ö†Ô∏è Please upload your Excel file first!\n\nThe export needs your performance data and configurations from Excel.\n\n1. Click "üìÅ Upload Excel File" at the top\n2. Select your performance_data_with_config.xlsx\n3. Then return here to export');
                return;
            }
            
            // Populate scenario preview
            const scenarioPreview = document.getElementById('scenarioPreviewContent');
            scenarioPreview.innerHTML = '';
            
            ['scenario1', 'scenario2', 'scenario3', 'scenario4'].forEach((key, index) => {
                const scenario = SCENARIO_CONFIG[key];
                const div = document.createElement('div');
                div.style.cssText = 'background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 12px;';
                div.innerHTML = `
                    <div style="font-weight: 700; color: #495057; margin-bottom: 6px; font-size: 14px;">${scenario.title}</div>
                    <div style="font-size: 11px; color: #6c757d; line-height: 1.4;">${scenario.desc}</div>
                `;
                scenarioPreview.appendChild(div);
            });
            
            // Populate model preview - Current
            const p1Preview = document.getElementById('portfolio1PreviewContent');
            const p1Models = MODEL_CONFIG.portfolio1.map(idx => {
                const header = columnHeaders.find(h => h.index === idx);
                return header ? header.name : `Column ${idx}`;
            });
            p1Preview.innerHTML = p1Models.length > 0 
                ? '‚úÖ ' + p1Models.join('<br>‚úÖ ')
                : '‚ö†Ô∏è No models selected';
            
            // Populate model preview - Modeled
            const p2Preview = document.getElementById('portfolio2PreviewContent');
            const p2Models = MODEL_CONFIG.portfolio2.map(idx => {
                const header = columnHeaders.find(h => h.index === idx);
                return header ? header.name : `Column ${idx}`;
            });
            p2Preview.innerHTML = p2Models.length > 0 
                ? '‚úÖ ' + p2Models.join('<br>‚úÖ ')
                : '‚ö†Ô∏è No models selected';
            
            // Show modal
            document.getElementById('exportPreviewModal').style.display = 'block';
        }
        
        function closeExportPreview() {
            document.getElementById('exportPreviewModal').style.display = 'none';
        }
        
        function downloadForGitHub() {
            // Generate HTML with current configs baked in
            let htmlContent = document.documentElement.outerHTML;
            
            // CRITICAL: Ensure updateDataSection is ALWAYS display: none in the exported HTML
            htmlContent = htmlContent.replace(
                /id="updateDataSection" style="display:\s*block\s*(!important)?;/g,
                'id="updateDataSection" style="display: none !important;'
            );
            
            // Replace SCENARIO_CONFIG in HTML with current config
            const scenarioConfigCode = `// SCENARIO CONFIGURATION DATA - Editable in #update mode
        const SCENARIO_CONFIG = {
            scenario1: {
                title: '${SCENARIO_CONFIG.scenario1.title.replace(/'/g, "\\'")}',
                desc: '${SCENARIO_CONFIG.scenario1.desc.replace(/'/g, "\\'")}',
                portfolio1: { option1: ${SCENARIO_CONFIG.scenario1.portfolio1.option1}, alloc1: ${SCENARIO_CONFIG.scenario1.portfolio1.alloc1}, option2: ${SCENARIO_CONFIG.scenario1.portfolio1.option2}, alloc2: ${SCENARIO_CONFIG.scenario1.portfolio1.alloc2}, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: ${SCENARIO_CONFIG.scenario1.portfolio2.option3}, alloc3: ${SCENARIO_CONFIG.scenario1.portfolio2.alloc3}, option4: ${SCENARIO_CONFIG.scenario1.portfolio2.option4}, alloc4: ${SCENARIO_CONFIG.scenario1.portfolio2.alloc4}, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario2: {
                title: '${SCENARIO_CONFIG.scenario2.title.replace(/'/g, "\\'")}',
                desc: '${SCENARIO_CONFIG.scenario2.desc.replace(/'/g, "\\'")}',
                portfolio1: { option1: ${SCENARIO_CONFIG.scenario2.portfolio1.option1}, alloc1: ${SCENARIO_CONFIG.scenario2.portfolio1.alloc1}, option2: ${SCENARIO_CONFIG.scenario2.portfolio1.option2}, alloc2: ${SCENARIO_CONFIG.scenario2.portfolio1.alloc2}, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: ${SCENARIO_CONFIG.scenario2.portfolio2.option3}, alloc3: ${SCENARIO_CONFIG.scenario2.portfolio2.alloc3}, option4: ${SCENARIO_CONFIG.scenario2.portfolio2.option4}, alloc4: ${SCENARIO_CONFIG.scenario2.portfolio2.alloc4}, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario3: {
                title: '${SCENARIO_CONFIG.scenario3.title.replace(/'/g, "\\'")}',
                desc: '${SCENARIO_CONFIG.scenario3.desc.replace(/'/g, "\\'")}',
                portfolio1: { option1: ${SCENARIO_CONFIG.scenario3.portfolio1.option1}, alloc1: ${SCENARIO_CONFIG.scenario3.portfolio1.alloc1}, option2: ${SCENARIO_CONFIG.scenario3.portfolio1.option2}, alloc2: ${SCENARIO_CONFIG.scenario3.portfolio1.alloc2}, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: ${SCENARIO_CONFIG.scenario3.portfolio2.option3}, alloc3: ${SCENARIO_CONFIG.scenario3.portfolio2.alloc3}, option4: ${SCENARIO_CONFIG.scenario3.portfolio2.option4}, alloc4: ${SCENARIO_CONFIG.scenario3.portfolio2.alloc4}, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario4: {
                title: '${SCENARIO_CONFIG.scenario4.title.replace(/'/g, "\\'")}',
                desc: '${SCENARIO_CONFIG.scenario4.desc.replace(/'/g, "\\'")}',
                portfolio1: { option1: ${SCENARIO_CONFIG.scenario4.portfolio1.option1}, alloc1: ${SCENARIO_CONFIG.scenario4.portfolio1.alloc1}, option2: ${SCENARIO_CONFIG.scenario4.portfolio1.option2}, alloc2: ${SCENARIO_CONFIG.scenario4.portfolio1.alloc2}, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: ${SCENARIO_CONFIG.scenario4.portfolio2.option3}, alloc3: ${SCENARIO_CONFIG.scenario4.portfolio2.alloc3}, option4: ${SCENARIO_CONFIG.scenario4.portfolio2.option4}, alloc4: ${SCENARIO_CONFIG.scenario4.portfolio2.alloc4}, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            }
        };`;
            
            const scenarioRegex = /\/\/ SCENARIO CONFIGURATION DATA[\s\S]*?const SCENARIO_CONFIG = \{[\s\S]*?\};/;
            htmlContent = htmlContent.replace(scenarioRegex, scenarioConfigCode);
            
            // Replace MODEL_CONFIG in HTML with current config
            const modelConfigCode = `// MODEL CONFIGURATION - Which models appear in which portfolio selector
        const MODEL_CONFIG = {
            portfolio1: [${MODEL_CONFIG.portfolio1.join(', ')}],
            portfolio2: [${MODEL_CONFIG.portfolio2.join(', ')}]
        };
        
        // ADVANCED METRICS VISIBILITY - Controls whether Advanced Risk Metrics section is shown
        // Default: false (hidden for end users, shown in #update mode only)
        let SHOW_ADVANCED_METRICS = ${SHOW_ADVANCED_METRICS};`;
            
            const modelRegex = /\/\/ MODEL CONFIGURATION[\s\S]*?let SHOW_ADVANCED_METRICS = (?:true|false);/;
            htmlContent = htmlContent.replace(modelRegex, modelConfigCode);
            
            // Update button text in HTML to match current config
            ['scenario1', 'scenario2', 'scenario3', 'scenario4'].forEach(name => {
                const scenario = SCENARIO_CONFIG[name];
                
                const titleRegex = new RegExp(`(id="${name}_title"[^>]*>\\s*)([^<]*)`, 'g');
                htmlContent = htmlContent.replace(titleRegex, `$1${scenario.title}`);
                
                const descRegex = new RegExp(`(id="${name}_desc"[^>]*>\\s*)([^<]*)`, 'g');
                htmlContent = htmlContent.replace(descRegex, `$1${scenario.desc}`);
            });
            
            // Remove the export preview modal from the download
            htmlContent = htmlContent.replace(/<div id="exportPreviewModal"[\s\S]*?<\/div>\s*<\/div>\s*<\/div>/g, '');
            
            // Create download with timestamp
            const timestamp = new Date().toISOString().slice(0,16).replace(/:/g, '-');
            const filename = `wavryder-tool-${timestamp}.html`;
            
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Close modal and show success
            closeExportPreview();
            alert(`‚úÖ Downloaded: ${filename}\n\nThis HTML file has your scenarios and model configs permanently baked in. Upload this to GitHub!`);
            
            console.log('‚úÖ Exported HTML for GitHub with configs:', {
                scenarios: SCENARIO_CONFIG,
                models: MODEL_CONFIG,
                filename: filename
            });
        }
        
        // Initialize on page load
        setTimeout(loadCustomInstructions, 100);
        
        // Load scenario inputs if in #update mode
        if (window.location.hash === '#update') {
            setTimeout(loadScenarioInputs, 150);
        }
        
        // ============================================================================
        // CONVERSION & ENGAGEMENT FEATURES
        // ============================================================================
        
        // Pre-Built Scenarios - One-click portfolio comparisons
        // SCENARIO CONFIGURATION DATA - Editable in #update mode
        const SCENARIO_CONFIG = {
            scenario1: {
                title: 'üõ°Ô∏è Conservative',
                desc: 'Traditional 60/40 vs Conservative + WR Adj',
                portfolio1: { option1: 18, alloc1: 40, option2: 13, alloc2: 60, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: 7, alloc3: 100, option4: null, alloc4: 0, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario2: {
                title: 'üöÄ Aggressive Growth',
                desc: 'Traditional Aggressive 80/20 vs Aggressive + WR Adj / Lev Nasdaq + WR Adj',
                portfolio1: { option1: 18, alloc1: 80, option2: 13, alloc2: 20, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: 5, alloc3: 80, option4: 8, alloc4: 20, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario3: {
                title: 'üìâ Balanced Growth',
                desc: 'Traditional balanced vs Aggressive + WR Adj',
                portfolio1: { option1: 18, alloc1: 60, option2: 13, alloc2: 40, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: 5, alloc3: 100, option4: null, alloc4: 0, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            },
            scenario4: {
                title: 'üíº Moderate Growth',
                desc: 'Traditional Moderate 50/50 vs Moderate + WR Adj',
                portfolio1: { option1: 18, alloc1: 50, option2: 13, alloc2: 50, option5: null, alloc5: 0, option6: null, alloc6: 0 },
                portfolio2: { option3: 6, alloc3: 100, option4: null, alloc4: 0, option7: null, alloc7: 0, option8: null, alloc8: 0 }
            }
        };
        
        function loadScenario(scenarioName) {
            const scenario = SCENARIO_CONFIG[scenarioName];
            if (!scenario) return;
            
            // Load Current (Current)
            document.getElementById('option1Select').value = scenario.portfolio1.option1 || '';
            document.getElementById('allocation1Select').value = scenario.portfolio1.alloc1;
            document.getElementById('option2Select').value = scenario.portfolio1.option2 || '';
            document.getElementById('allocation2Select').value = scenario.portfolio1.alloc2;
            document.getElementById('option5Select').value = scenario.portfolio1.option5 || '';
            document.getElementById('allocation5Select').value = scenario.portfolio1.alloc5;
            document.getElementById('option6Select').value = scenario.portfolio1.option6 || '';
            document.getElementById('allocation6Select').value = scenario.portfolio1.alloc6;
            
            // Load Modeled (Modeled)
            document.getElementById('option3Select').value = scenario.portfolio2.option3 || '';
            document.getElementById('allocation3Select').value = scenario.portfolio2.alloc3;
            document.getElementById('option4Select').value = scenario.portfolio2.option4 || '';
            document.getElementById('allocation4Select').value = scenario.portfolio2.alloc4;
            document.getElementById('option7Select').value = scenario.portfolio2.option7 || '';
            document.getElementById('allocation7Select').value = scenario.portfolio2.alloc7;
            document.getElementById('option8Select').value = scenario.portfolio2.option8 || '';
            document.getElementById('allocation8Select').value = scenario.portfolio2.alloc8;
            
            // Scroll to compare button and trigger comparison
            setTimeout(() => {
                const compareBtn = document.querySelector('button[onclick="updateComparison()"]');
                if (compareBtn) {
                    compareBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    setTimeout(() => {
                        updateComparison();
                    }, 500);
                }
            }, 100);
        }
        
        // Generate Aha Card with compelling messaging
        function generateAhaCard(p1Growth, p2Growth, p1Drawdown, p2Drawdown, p1CAGR, p2CAGR) {
            const ahaCard = document.getElementById('ahaCard');
            const ahaMessage = document.getElementById('ahaMessage');
            const dollarImpact = document.getElementById('dollarImpactAmount');
            
            if (!ahaCard || !ahaMessage || !dollarImpact) return;
            
            // Calculate differences
            const growthDiff = p2Growth - p1Growth;
            const drawdownImprovement = p1Drawdown - p2Drawdown; // Lower is better, so p1 - p2
            const cagrDiff = p2CAGR - p1CAGR;
            
            // Determine the key message based on data
            let message = '';
            let dollarAmount = '';
            
            if (growthDiff > 10000) {
                // Modeled portfolio significantly outperformed
                const pctGain = ((growthDiff / p1Growth) * 100).toFixed(1);
                message = `The Modeled Portfolio would have grown <strong>${pctGain}% more</strong> over 20 years. ` +
                         `That's an extra <strong>$${growthDiff.toLocaleString()}</strong> on a $100K investment.`;
                dollarAmount = `+$${growthDiff.toLocaleString()}`;
            } else if (growthDiff < -10000) {
                // Current portfolio outperformed (rare with WavRyder scenarios)
                const pctLoss = ((Math.abs(growthDiff) / p1Growth) * 100).toFixed(1);
                message = `The Current Portfolio would have grown <strong>${pctLoss}% more</strong> over 20 years. ` +
                         `However, check the risk metrics below to see the full picture.`;
                dollarAmount = `-$${Math.abs(growthDiff).toLocaleString()}`;
            } else if (drawdownImprovement > 5) {
                // Focus on risk reduction
                const pctReduction = ((drawdownImprovement / Math.abs(p1Drawdown)) * 100).toFixed(1);
                message = `While returns were similar, the Modeled Portfolio would have <strong>reduced worst drawdowns by ${pctReduction}%</strong> ` +
                         `(from ${Math.abs(p1Drawdown).toFixed(1)}% to ${Math.abs(p2Drawdown).toFixed(1)}%). Better sleep at night with similar returns.`;
                dollarAmount = `${drawdownImprovement.toFixed(1)}% Less Risk`;
            } else {
                // General comparison
                message = `Over 20 years, the Modeled Portfolio would have turned $100K into <strong>$${p2Growth.toLocaleString()}</strong> ` +
                         `compared to <strong>$${p1Growth.toLocaleString()}</strong> for the Current Portfolio.`;
                dollarAmount = growthDiff > 0 ? `+$${growthDiff.toLocaleString()}` : `$${Math.abs(growthDiff).toLocaleString()}`;
            }
            
            ahaMessage.innerHTML = message;
            dollarImpact.textContent = dollarAmount;
            
            // Update Aha Card text from configuration (loaded from Excel or defaults)
            const ahaTitle = document.querySelector('#ahaCard h2');
            const button1 = document.querySelector('button[onclick="showLeadCaptureModal()"]');
            const button2 = document.querySelector('button[onclick="showScheduleModal()"]');
            const subtext = document.querySelector('#ahaCard > div > div:last-child');
            
            if (ahaTitle) ahaTitle.textContent = ahaCardConfig.title;
            if (button1) button1.innerHTML = ahaCardConfig.button1;
            if (button2) button2.innerHTML = ahaCardConfig.button2;
            if (subtext && subtext.textContent.includes('‚Ä¢')) {
                subtext.textContent = ahaCardConfig.subtext;
            }
            
            ahaCard.style.display = 'block';
            
            // Scroll to Aha Card
            setTimeout(() => {
                ahaCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 300);
        }
        
        // Modal Functions
        function showLeadCaptureModal() {
            document.getElementById('leadCaptureModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        function closeLeadCaptureModal() {
            document.getElementById('leadCaptureModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function showScheduleModal() {
            document.getElementById('scheduleModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        function closeScheduleModal() {
            document.getElementById('scheduleModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function submitLeadCapture(event) {
            event.preventDefault();
            
            const email = document.getElementById('leadEmail').value;
            const name = document.getElementById('leadName').value;
            const status = document.getElementById('leadCaptureStatus');
            
            // In production, send this to your CRM/email service
            // For now, just show success message
            status.innerHTML = '‚úÖ Success! Check your email for the detailed report.';
            status.style.color = '#059669';
            
            // Log to console for now (in production, send to your backend)
            console.log('Lead Captured:', { email, name, timestamp: new Date() });
            
            // Close modal after 2 seconds
            setTimeout(() => {
                closeLeadCaptureModal();
                status.innerHTML = '';
            }, 2000);
        }
        
        // Close modals when clicking outside
        window.onclick = function(event) {
            const leadModal = document.getElementById('leadCaptureModal');
            const scheduleModal = document.getElementById('scheduleModal');
            
            if (event.target === leadModal) {
                closeLeadCaptureModal();
            }
            if (event.target === scheduleModal) {
                closeScheduleModal();
            }
        }
        
        // ============================================================================
        // AUDIT REPORT GENERATION - Phase 2 Priority 7
        // ============================================================================
        
        function generateAuditReport() {
            const copyStatus = document.getElementById('copyStatus');
            copyStatus.innerHTML = '‚è≥ Generating audit report...';
            copyStatus.style.color = '#007bff';
            
            // Gather current portfolio data
            const portfolio1Name = document.getElementById('portfolio1Description').textContent;
            const portfolio2Name = document.getElementById('portfolio2Description').textContent;
            const yearsCount = document.getElementById('sectionYearsCount').textContent;
            const yearRange = document.getElementById('sectionYearRange').textContent;
            
            // Gather performance metrics
            const p1_100k = document.getElementById('option1_100k').textContent;
            const p2_100k = document.getElementById('option2_100k').textContent;
            const diff100k = document.getElementById('diff100k').textContent;
            
            const p1Drawdown = document.getElementById('option1Drawdown').textContent;
            const p2Drawdown = document.getElementById('option2Drawdown').textContent;
            const drawdownDiff = document.getElementById('drawdownDiff').textContent;
            
            // Build audit HTML
            const auditHTML = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WavRyder Performance Report - Audit Trail</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #1565c0;
            font-size: 32px;
            margin-bottom: 10px;
            border-bottom: 3px solid #2196f3;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #1976d2;
            font-size: 24px;
            margin: 30px 0 15px 0;
            border-left: 4px solid #2196f3;
            padding-left: 12px;
        }
        
        h3 {
            color: #424242;
            font-size: 18px;
            margin: 20px 0 10px 0;
        }
        
        .report-header {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .metadata {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .metadata-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            border-left: 3px solid #2196f3;
        }
        
        .metadata-label {
            font-weight: 600;
            color: #666;
            font-size: 13px;
            margin-bottom: 4px;
        }
        
        .metadata-value {
            font-size: 16px;
            color: #1a1a1a;
            font-weight: 500;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #dee2e6;
        }
        
        th {
            background: #e3f2fd;
            font-weight: 600;
            color: #1565c0;
        }
        
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .section {
            margin: 30px 0;
            page-break-inside: avoid;
        }
        
        .calculation-detail {
            background: #f0f7ff;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #dee2e6;
            font-size: 12px;
            color: #666;
        }
        
        .print-button {
            padding: 12px 30px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 20px 0;
        }
        
        .print-button:hover {
            background: #1976d2;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                padding: 20px;
            }
            
            .print-button {
                display: none;
            }
            
            h1 {
                page-break-after: avoid;
            }
            
            .section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìÑ WavRyder Performance Report - Audit Trail</h1>
        
        <div class="report-header">
            <p style="font-size: 14px; color: #666; margin-bottom: 8px;">
                <strong>Generated:</strong> ${new Date().toLocaleString()}
            </p>
            <p style="font-size: 14px; color: #666;">
                <strong>Analysis Period:</strong> ${yearRange} (${yearsCount} years)
            </p>
        </div>
        
        <button class="print-button" onclick="window.print()">üñ®Ô∏è Print to PDF</button>
        
        <div class="section">
            <h2>Portfolio Configuration</h2>
            
            <div class="metadata">
                <div class="metadata-item">
                    <div class="metadata-label">Current Portfolio</div>
                    <div class="metadata-value">${portfolio1Name}</div>
                </div>
                <div class="metadata-item">
                    <div class="metadata-label">Modeled Portfolio</div>
                    <div class="metadata-value">${portfolio2Name}</div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>Performance Summary</h2>
            
            <h3>$100,000 Investment Growth</h3>
            <table>
                <thead>
                    <tr>
                        <th>Portfolio</th>
                        <th>Final Value</th>
                        <th>Total Growth</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Current Portfolio</td>
                        <td>${p1_100k}</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>Modeled Portfolio</td>
                        <td>${p2_100k}</td>
                        <td>${diff100k}</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Maximum Annual Drawdown</h3>
            <table>
                <thead>
                    <tr>
                        <th>Portfolio</th>
                        <th>Max Drawdown</th>
                        <th>Difference</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Current Portfolio</td>
                        <td>${p1Drawdown}</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>Modeled Portfolio</td>
                        <td>${p2Drawdown}</td>
                        <td>${drawdownDiff}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>Calculation Methodology</h2>
            
            <h3>CAGR (Compound Annual Growth Rate)</h3>
            <div class="calculation-detail">
CAGR = (Ending Value / Beginning Value)^(1 / Number of Years) - 1

This metric represents the mean annual growth rate of an investment over a 
specified time period longer than one year, assuming profits are reinvested 
at the end of each year.
            </div>
            
            <h3>Maximum Drawdown</h3>
            <div class="calculation-detail">
Max Drawdown = (Trough Value - Peak Value) / Peak Value

The maximum observed loss from a peak to a trough of a portfolio, before a 
new peak is attained. This metric measures the largest single drop from peak 
to bottom in the value of a portfolio.
            </div>
            
            <h3>Investment Growth Calculation</h3>
            <div class="calculation-detail">
Future Value = Initial Investment √ó (1 + r‚ÇÅ) √ó (1 + r‚ÇÇ) √ó ... √ó (1 + r‚Çô)

Where r‚ÇÅ, r‚ÇÇ, ... r‚Çô are the annual returns for each year in the period.
Starting amount: $100,000
Calculation: Year-by-year compounding of actual historical returns
            </div>
        </div>
        
        <div class="section">
            <h2>Data Sources</h2>
            <table>
                <thead>
                    <tr>
                        <th>Source Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Historical Returns</td>
                        <td>Annual return data from ${yearRange}</td>
                    </tr>
                    <tr>
                        <td>Allocation</td>
                        <td>User-specified portfolio weightings</td>
                    </tr>
                    <tr>
                        <td>Benchmark</td>
                        <td>Standard market indices (S&P 500, AGG, VEA)</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>Assumptions & Limitations</h2>
            <ul style="margin-left: 20px; line-height: 1.8;">
                <li>Assumes annual rebalancing to target allocations</li>
                <li>Does not account for transaction costs, taxes, or fees</li>
                <li>Based on historical data; past performance does not guarantee future results</li>
                <li>Assumes reinvestment of all dividends and capital gains</li>
                <li>Returns are nominal (not adjusted for inflation)</li>
                <li>Assumes perfect execution at end-of-year prices</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>Risk Disclosure</h2>
            <p style="padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
                <strong>‚ö†Ô∏è Important:</strong> This analysis is for educational and illustrative purposes 
                only. The performance data presented is based on hypothetical, backtested historical 
                analysis and does not represent actual trading results. No representation is being made 
                that any account will or is likely to achieve profits or losses similar to those shown. 
                Please consult with a qualified financial advisor before making any investment decisions.
            </p>
        </div>
        
        <div class="footer">
            <p><strong>Report Generated By:</strong> WavRyder Performance Comparison Tool</p>
            <p><strong>Version:</strong> 2.0 (Phase 2 Complete)</p>
            <p><strong>Generated:</strong> ${new Date().toLocaleString()}</p>
            <p style="margin-top: 15px; font-style: italic;">
                This audit trail provides transparency into the calculations and methodology used 
                to generate the performance comparison. All figures are derived from the historical 
                data provided and user-specified allocations.
            </p>
        </div>
    </div>
</body>
</html>
            `;
            
            // Create blob and open in new window
            const blob = new Blob([auditHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            window.open(url, '_blank');
            
            copyStatus.innerHTML = '‚úÖ Audit report generated! Opening in new window...';
            copyStatus.style.color = '#28a745';
            
            setTimeout(() => {
                copyStatus.innerHTML = '';
            }, 3000);
        }
        
        // ============================================================================
        // TOOLTIP SUPPORT FOR METRIC DEFINITIONS - Phase 2 Priority 5
        // ============================================================================
        
        // Handle mobile touch events for tooltips
        document.addEventListener('DOMContentLoaded', function() {
            // Add click support for mobile devices
            const metricTerms = document.querySelectorAll('.metric-term');
            
            metricTerms.forEach(term => {
                term.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // Toggle active class for mobile
                    const isActive = this.classList.contains('active');
                    
                    // Close all other tooltips
                    document.querySelectorAll('.metric-term.active').forEach(t => {
                        t.classList.remove('active');
                    });
                    
                    // Toggle this tooltip
                    if (!isActive) {
                        this.classList.add('active');
                    }
                });
            });
            
            // Close tooltips when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.classList.contains('metric-term')) {
                    document.querySelectorAll('.metric-term.active').forEach(t => {
                        t.classList.remove('active');
                    });
                }
            });
        });
        
</script>


</body></html>