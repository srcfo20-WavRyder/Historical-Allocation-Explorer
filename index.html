<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Performance Comparison Tool</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
</head>
<body>
<div class="update-data-section" id="updateDataSection" style="display: none; text-align: center; margin: 20px 0px; padding: 20px; background: rgb(248, 249, 250); border-radius: 8px;">
<h3 style="color: #495057; margin-bottom: 15px;">Update Tool Data</h3>
<p style="color: #6c757d; margin-bottom: 15px;">Upload a new Excel file to update all models and data in this tool</p>
<input type="file" id="updateDataInput" accept=".xlsx,.xls" style="display: none;">
<button onclick="document.getElementById('updateDataInput').click()" class="btn-primary" style="margin-right: 10px;">
üìä Upload New Data File
</button>
<button id="downloadUpdatedHtml" onclick="downloadUpdatedHTML()" class="btn-secondary" style="display: inline-block;">
üíæ Download Updated Tool
</button>
<div id="updateStatus" style="margin-top: 15px; font-weight: bold;"><span style="color: #007bff;">‚è≥ Generating updated file...</span></div>
</div>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;600;700&#x26;display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <script>
// Auto-generated from performance_data.xlsx
const EXCEL_DATA = [
  [
    "Option",
    null,
    "A",
    "B",
    "C",
    "D",
    "E",
    "F",
    "G",
    "H",
    "I",
    "J",
    "K",
    "L",
    "M",
    "N",
    "O",
    "P",
    "Q",
    "R"
  ],
  [
    "Performance Measure",
    null,
    "60/40",
    "WavRyder QQQ",
    "WavRyder SP500",
    "WavRyder(H)",
    "WavRyder(M)",
    "WavRyder(L)",
    "WavRyder QQQ (Leveraged)",
    "WavRyder SP500 (Leveraged)",
    "WavRyder QQQ/SP500 Leveraged)",
    "QQQ (Leveraged) W/O WavRyder",
    "SP 500",
    "AGG",
    "WavRyder AGG",
    "VEA",
    "WavRyder VEA",
    "QQQ",
    "SPY",
    "WavRyder SPY"
  ],
  [
    "Total Return",
    "1 year",
    0.13478289285581346,
    0.1755558345823689,
    0.1500984966064436,
    0.14446026845364224,
    0.16306143835477638,
    0.15533947507090806,
    0.3600802462787316,
    0.3600802462787316,
    0.3600802462787316,
    0.2638826792924889,
    0.09623333431267755,
    0.0743001063121318,
    0.07204148844041747,
    0.3474626822676845,
    0.23492556670435416,
    0.1840145170095442,
    0.16143345656192087,
    0.1500984966064436
  ],
  [
    "Total Return",
    "YTD",
    0.005845927172144716,
    0.17490936156735293,
    0.14946602333652814,
    0.0002859475348011564,
    0.1624218363787724,
    0.15470411963151198,
    0.3593322978175786,
    0.3593322978175786,
    0.3593322978175786,
    0.4095494272678759,
    0.17715053440658535,
    0.07363484433270728,
    0.07145194103410457,
    0.3590157170341228,
    0.23424644451301124,
    0.2265596637279068,
    0.19167417738414572,
    0.14946602333652814
  ],
  [
    "CAGR",
    "5 Year",
    0.08853338923317944,
    0.10452174579562423,
    0.09778825230799693,
    0.10246994140123711,
    0.10168211138720884,
    0.099473155483087,
    0.20583394573438207,
    0.20583394573438207,
    0.20583394573438207,
    0.20787345614101205,
    0.1318018589326304,
    -0.003341552200764264,
    0.02483725167382067,
    0.09410402157004549,
    0.052638021631999266,
    0.15507161028161898,
    0.14720198027767672,
    0.09778825230799693
  ],
  [
    "CAGR",
    "10 Year",
    0.09985991826404361,
    0.1514020320183065,
    0.12067335018460312,
    0.14472912965606533,
    0.13636857488789333,
    0.12702990217666899,
    0.36408155855902913,
    0.36408155855902913,
    0.36408155855902913,
    0.3734403360399954,
    0.14469481410365326,
    0.019912976507280744,
    0.038779274086202076,
    0.08715480173850243,
    0.08040465034534994,
    0.19544936041992722,
    0.14780635737728853,
    0.12067335018460312
  ],
  [
    "CAGR",
    "15 Year",
    0.09466132093415092,
    0.12807838607348154,
    0.10092326392916484,
    0.12089101435539074,
    0.11477927616801487,
    0.10653174331546889,
    0.3075958747086125,
    0.3075958747086125,
    0.3075958747086125,
    0.3954994701202532,
    0.1353363262367564,
    0.02400024610020135,
    0.034956859343680646,
    0.07069442459595554,
    0.0547897766452341,
    0.1864064668867551,
    0.14046367211624777,
    0.10092326392916484
  ],
  [
    "CAGR",
    "20 Year",
    0.0814670041020702,
    0.12427253755029244,
    0.0953211493896522,
    0.1117653973750059,
    0.11008882126271935,
    0.10129718649640762,
    0.2783300098727388,
    0.2783300098727388,
    0.2783300098727388,
    0.3469592078853829,
    0.10521271732857285,
    0.03141720097010392,
    0.04204064362146509,
    0.05404327478725124,
    0.06076962850322465,
    0.15471284756328063,
    0.10936063754732261,
    0.0953211493896522
  ],
  [],
  [],
  [
    " $100K Investment Growth",
    "20 Year",
    478922.753025214,
    1040955.2187866488,
    617773.7768892092,
    832267.7348264777,
    806367.9292071358,
    687886.1412265772,
    13533147.851294626,
    13533147.851294626,
    13533147.851294626,
    38487250.90564725,
    738452.0870592844,
    185568.1187366363,
    227744.64488165607,
    286322.648921958,
    325140.1191067703,
    1772654.7125073008,
    795861.7044993716,
    617003.7527443555
  ],
  [],
  [],
  [
    "Worst Annual Drawdown%",
    "20 Year",
    -0.19061453613527835,
    -0.09572172918412059,
    -0.08463731735187463,
    -0.09031353870693348,
    -0.08217694754550631,
    -0.08146880362524733,
    -0.2618634015601986,
    -0.2618634015601986,
    -0.2618634015601986,
    -0.7909001278779242,
    -0.36997611132718566,
    -0.13021651691583458,
    -0.033208122709457166,
    -0.40623204383435196,
    -0.15020561241625574,
    -0.4172716255522949,
    -0.3679500303113997,
    -0.08463731735187463
  ],
  [],
  [100000],
  [20],
  [],
  [],
  [
    null,
    "Year"
  ],
  [
    "Total Return",
    1,
    0.11039403783585588,
    0.14283881637958684,
    0.16423536018966356,
    0.022948335634813022,
    0.15430656346437943,
    0.16044909477256764,
    0.1588216757855454,
    0.1588216757855454,
    0.1588216757855454,
    0.1150192778810828,
    0.15794461193725562,
    0.0389650907962078,
    0.05753085698825666,
    0.1696127967415515,
    0.16442822599454554,
    0.07144044374185077,
    0.15845259514833843,
    0.16423536018966356
  ],
  [
    "Total Return",
    2,
    0.057082190428648705,
    0.19256594171615782,
    0.03559244690897145,
    0.1580699189960051,
    0.11182016705577658,
    0.06555461887426417,
    0.20854254569951913,
    0.20854254569951913,
    0.20854254569951913,
    0.12066537916995723,
    0.05493731118195888,
    0.06594822173447668,
    0.07139015216818279,
    0.08923609792958342,
    0.11682289683516478,
    0.19027997796682605,
    0.051462156336747444,
    0.03559244690897145
  ],
  [
    "Total Return",
    3,
    -0.19061453613527835,
    0.1498029927279101,
    0.0872030849356289,
    0.1370430162403533,
    0.1183904672527687,
    0.09965036746424838,
    0.16304845541853452,
    0.16304845541853452,
    0.16304845541853452,
    -0.39282170027907437,
    -0.36997611132718566,
    0.07900006306508467,
    0.17689350858521036,
    -0.40623204383435196,
    0.09869966679707765,
    -0.4172716255522949,
    -0.3679500303113997,
    0.0872030849356289
  ],
  [
    "Total Return",
    4,
    0.16303867134354477,
    -0.0185300909582935,
    0.034524320114372564,
    -0.010178438464917727,
    0.00806981004897045,
    0.023962626763297745,
    -0.004514816331647742,
    -0.004514816331647742,
    -0.004514816331647742,
    0.4040000388004261,
    0.264642338297876,
    0.029693929804595065,
    0.005255944335200269,
    0.27507327304801943,
    0.04868736318732947,
    0.5468405175753084,
    0.2635173081475055,
    0.034524320114372564
  ],
  [
    "Total Return",
    5,
    0.11624689959080481,
    0.12105797297878929,
    0.08611033279024793,
    0.10119535929040313,
    0.1037095453998147,
    0.09317937202805404,
    0.49944746071607926,
    0.49944746071607926,
    0.49944746071607926,
    0.1759039547473844,
    0.1506340348639459,
    0.06362036229624168,
    0.021578615221991226,
    0.08354358718490418,
    -0.00851190705534155,
    0.2014384230365669,
    0.15056174792422494,
    0.08611033279024793
  ],
  [
    "Total Return",
    6,
    0.042462825447058705,
    0.04814215624201701,
    0.0570870296680166,
    0.050049747135175515,
    0.0527068482037476,
    0.055357280823195465,
    -0.008236796723226303,
    -0.008236796723226303,
    -0.008236796723226303,
    0.026901004754602775,
    0.021118153857238253,
    0.07696712084053026,
    0.09706457046610462,
    -0.12314572230261056,
    0.0010752326237901677,
    0.03475766098084043,
    0.018949928514852665,
    0.0570870296680166
  ],
  [
    "Total Return",
    7,
    0.1102160797991456,
    0.15551414997120228,
    0.13617666387598693,
    0.15187320770273494,
    0.14623601995752122,
    0.14029344955916634,
    0.27692032146189116,
    0.27692032146189116,
    0.27692032146189116,
    0.17050978218817048,
    0.16003224238602765,
    0.03754892670638044,
    0.09684341500834992,
    0.1856053052527893,
    0.12166817724917012,
    0.18112548698889497,
    0.1599029285130973,
    0.13617666387598693
  ],
  [
    "Total Return",
    8,
    0.18465075090714222,
    0.292764017775748,
    0.26080510265980816,
    0.28649707010734904,
    0.27710634315196714,
    0.2674008870965081,
    1.143566785241899,
    1.143566785241899,
    1.143566785241899,
    0.3446876391344167,
    0.3238848466970623,
    -0.019776787112616656,
    -0.033208122709457166,
    0.2180651123012045,
    0.18282810446590303,
    0.36634180917950654,
    0.3230786471313738,
    0.26080510265980816
  ],
  [
    "Total Return",
    9,
    0.1042517064486359,
    0.026872124168275002,
    -0.02404169974907766,
    0.016604564018459556,
    0.0012799527142683953,
    -0.013945890944580985,
    0.15819977416437792,
    0.15819977416437792,
    0.15819977416437792,
    0.1632151568545468,
    0.13688358376182075,
    0.05998575399926809,
    -0.020629371376090777,
    -0.0596740621783014,
    -0.15020561241625574,
    0.19181409801244942,
    0.13463785464442046,
    -0.02404169974907766
  ],
  [
    "Total Return",
    10,
    0.009384163962939507,
    -0.06875823796704572,
    -0.08463731735187463,
    -0.0719712015484294,
    -0.07670916317846221,
    -0.08146880362524733,
    -0.19126874920449666,
    -0.19126874920449666,
    -0.19126874920449666,
    0.05337263021974459,
    0.013837640885861369,
    0.004807529874164551,
    0.000005480856025252834,
    -0.003731686170505122,
    -0.0987580854176413,
    0.09435945660210376,
    0.012342937428686751,
    -0.08463731735187463
  ],
  [
    "Total Return",
    11,
    0.0819911416073209,
    -0.0008905988514329444,
    0.0016488605404514356,
    -0.0003597900240145391,
    0.00040962705829405976,
    0.0011605015440672162,
    -0.03469655918615988,
    -0.03469655918615988,
    -0.03469655918615988,
    0.09524485743532929,
    0.11959913306315295,
    0.024137948970977208,
    0.011062759863883942,
    0.026340064463413748,
    0.06474504245040835,
    0.0709786180948071,
    0.1199786573675592,
    0.0016488605404514356
  ],
  [
    "Total Return",
    12,
    0.14432943721549019,
    0.2984309693345417,
    0.18653367166480161,
    0.27548084361229175,
    0.2416013228940621,
    0.20835151671784513,
    1.1082585418480155,
    1.1082585418480155,
    1.1082585418480155,
    0.2717948315480272,
    0.21831591555840868,
    0.0355271535359738,
    0.021736243529953292,
    0.2642050582339448,
    0.19332981151141837,
    0.32663541332799406,
    0.21705430268489923,
    0.18653367166480161
  ],
  [
    "Total Return",
    13,
    -0.026540367217998573,
    0.05763779780682232,
    0.06624045019195823,
    0.06194614474958837,
    0.062305799239056325,
    0.06475547865673636,
    0.024165129683128672,
    0.024165129683128672,
    0.024165129683128672,
    -0.023352004143146976,
    -0.043842333247032905,
    0.003407565345097119,
    0.03349550264437284,
    -0.1474532662537571,
    -0.04167095047975666,
    -0.0012619253233363548,
    -0.04569022272848022,
    0.06624045019195823
  ],
  [
    "Total Return",
    14,
    0.2211324209987624,
    0.23879180541511924,
    0.17432524132453397,
    0.2256656507941066,
    0.20628085092416315,
    0.18704100755190511,
    0.556188877477886,
    0.556188877477886,
    0.556188877477886,
    0.35090802412032707,
    0.3148636179238715,
    0.08455644431316389,
    0.1065779092265351,
    0.2262117470601237,
    0.12055955905511428,
    0.38961544865598197,
    0.31223883174763056,
    0.17432524132453397
  ],
  [
    "Total Return",
    15,
    0.14032135463687068,
    0.4669429079542302,
    0.31438372890572164,
    0.43244029946314977,
    0.3894257884703023,
    0.34410254195834034,
    1.7053069122550153,
    1.7053069122550153,
    1.7053069122550153,
    0.33329219844253055,
    0.18398831564768492,
    0.07476090042475958,
    0.09551295485360534,
    0.09713838640624717,
    0.23853336627781951,
    0.48406086417127137,
    0.18331629868868005,
    0.31438372890572164
  ],
  [
    "Total Return",
    16,
    0.1660288621521957,
    0.04061675606806747,
    0.07366548213266078,
    0.047785725602705886,
    0.057965364027131816,
    0.06758853553290445,
    0.0803695935334181,
    0.0803695935334181,
    0.0803695935334181,
    0.28070493528718576,
    0.28705369259328073,
    -0.017660378398383303,
    -0.03119830723582484,
    0.1166407749905305,
    -0.04720009518805979,
    0.27419733789440026,
    0.28728740938940045,
    0.07366548213266078
  ],
  [
    "Total Return",
    17,
    -0.1602470542058062,
    -0.09572172918412059,
    -0.06855377204992374,
    -0.09031353870693348,
    -0.08217694754550631,
    -0.07401243774277833,
    -0.2618634015601986,
    -0.2618634015601986,
    -0.2618634015601986,
    -0.2536289362862124,
    -0.18110888886303056,
    -0.13021651691583458,
    -0.02012605943820811,
    -0.15341864638316305,
    -0.04015918172731581,
    -0.32577005901822353,
    -0.18175359611134545,
    -0.06855377204992374
  ],
  [
    "Total Return",
    18,
    0.1804838434194902,
    0.22156177601373916,
    0.16594603064765456,
    0.2107451189067462,
    0.19421592758891038,
    0.1773642464713019,
    0.5689517091686349,
    0.5689517091686349,
    0.5689517091686349,
    0.40552035833500977,
    0.26287659524670337,
    0.0565530750370844,
    0.07127871491392757,
    0.17933365081746167,
    0.1373274335967798,
    0.548556055008738,
    0.26175794848840206,
    0.16594603064765456
  ],
  [
    "Total Return",
    19,
    0.15454644818603303,
    0.21609543256174124,
    0.19184189001727714,
    0.21160461258843255,
    0.2045161079048896,
    0.19704266104117796,
    0.49456006935294905,
    0.49456006935294905,
    0.49456006935294905,
    0.25164338808851805,
    0.25019681916030745,
    0.013092501993107186,
    0.037333329898712186,
    0.03149637874015632,
    -0.0011424346169758293,
    0.2557826053805423,
    0.24886459611702305,
    0.19184189001727714
  ],
  [
    "Total Return",
    20,
    0.13441444186193752,
    0.17490936156735293,
    0.14946602333652814,
    0.16216191327418095,
    0.1624218363787724,
    0.15470411963151198,
    0.3593322978175786,
    0.3593322978175786,
    0.3593322978175786,
    0.20906973265254902,
    0.1788,
    0.0719,
    0.07145194103410457,
    0.3517,
    0.23424644451301124,
    0.2017,
    0.1788,
    0.14946602333652814
  ]
];
</script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
body {
font-family: 'Roboto Slab', serif;
background: #f8f9fa;
padding: 40px 20px;
}
.container {
max-width: 900px;
margin: 0 auto;
background: white;
border-radius: 12px;
padding: 40px;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.upload-section {
text-align: center;
padding: 30px;
background: #f8f9fa;
border-radius: 8px;
margin-bottom: 30px;
border: 2px dashed #dee2e6;
}
.upload-row {
display: flex;
gap: 20px;
justify-content: center;
align-items: center;
margin-top: 20px;
flex-wrap: wrap;
}
/* Portfolio Container Styles */
.portfolio-container {
border: 3px solid #4472C4;
border-radius: 0px;
padding: 20px;
background: #F0F4FF;
box-shadow: none;
max-width: 400px;
width: 100%;
box-sizing: border-box;
margin: 0 auto 25px auto;
}
.portfolio-container.portfolio-2 {
border-color: #28a745;
background: #F0FFF4;
box-shadow: none;
}
.portfolio-header {
font-size: 16px;
font-weight: 700;
color: #000000;
margin-bottom: 12px;
text-align: center;
}
.portfolio-container.portfolio-2 .portfolio-header {
color: #000000;
font-weight: 700;
}
/* Models Label */
.models-label {
font-size: 12px;
font-weight: 600;
color: #495057;
margin-bottom: 5px;
}
/* Selector row - model (70%) + allocation (30%) pairs */
.selector-row-even {
display: grid;
grid-template-columns: 2.3fr 1fr 2.3fr 1fr 2.3fr 1fr 2.3fr 1fr;
gap: 8px;
align-items: end;
}
/* Even selector groups - all same width */
.selector-group-even {
display: flex;
flex-direction: column;
gap: 4px;
}
/* Even labels - compact */
.selector-label-even {
font-size: 11px;
font-weight: 600;
color: #495057;
}
/* Even selects - all same size */
.select-even {
width: 100%;
padding: 8px;
border: 1.5px solid #ced4da;
border-radius: 6px;
font-size: 13px;
background: white;
cursor: pointer;
transition: border-color 0.2s ease;
}
/* Smaller allocation selects */
.select-alloc {
font-size: 12px;
padding: 6px 4px;
text-align: center;
}
.select-even:focus {
outline: none;
border-color: #667eea;
box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
.portfolio-container.portfolio-2 .select-even:focus {
border-color: #28a745;
box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
}
/* 2-column layout - 2 models per row */
/* Stacked layout - one row per model */
.selector-row-stack {
display: flex;
align-items: center;
gap: 8px;
margin-bottom: 12px;
margin-left: 5px;
margin-right: 5px;
}
.selector-label-stack {
font-size: 14px;
font-weight: 600;
color: #000000;
white-space: nowrap;
text-align: left;
width: 20px;
flex-shrink: 0;
}
.select-stack {
padding: 6px 8px;
border: 1px solid #000000;
border-radius: 0px;
font-size: 16px;
font-weight: 700;
background: white;
cursor: pointer;
transition: border-color 0.2s ease;
box-sizing: border-box;
flex: 1;
min-width: 0;
max-width: 180px;
text-align: left;
}
.select-alloc-stack {
flex: 0 0 55px;
width: 55px;
text-align: center;
font-size: 16px;
font-weight: 700;
padding: 6px 4px;
box-sizing: border-box;
}
.select-stack:focus {
outline: none;
border-color: #667eea;
box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
.portfolio-container.portfolio-2 .select-stack:focus {
border-color: #28a745;
box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
}
.selector-row-2col {
display: grid;
grid-template-columns: 15ch 8ch 15ch 8ch;
gap: 1ch;
align-items: end;
max-width: 100%;
margin-bottom: 20px;
}
.selector-group-2col {
display: flex;
flex-direction: column;
gap: 6px;
}
.selector-label-2col {
font-size: 11px;
font-weight: 600;
color: #495057;
}
.select-2col {
width: 15ch;
max-width: 15ch;
padding: 6px 4px;
border: 1.5px solid #ced4da;
border-radius: 6px;
font-size: 13px;
background: white;
cursor: pointer;
transition: border-color 0.2s ease;
box-sizing: border-box;
overflow: hidden;
text-overflow: ellipsis;
white-space: nowrap;
}
.select-alloc-2col {
font-size: 13px;
text-align: center;
padding: 4px 2px;
width: 8ch;
max-width: 8ch;
}
.select-2col:focus {
outline: none;
border-color: #667eea;
box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
.portfolio-container.portfolio-2 .select-2col:focus {
border-color: #28a745;
box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
}
.selector-group-compact {
display: flex;
flex-direction: column;
gap: 3px;
min-width: 80px;
}
/* Make model selectors wider than allocation dropdowns */
.selector-group-compact:nth-child(odd) {
flex: 2;
}
.selector-group-compact:nth-child(even) {
flex: 1;
max-width: 70px;
}
.selector-label-compact {
font-size: 11px;
font-weight: 600;
color: #495057;
}
.select-compact {
padding: 6px 8px;
border: 1.5px solid #ced4da;
border-radius: 6px;
font-size: 12px;
background: white;
cursor: pointer;
transition: border-color 0.2s ease;
}
.select-compact:focus {
outline: none;
border-color: #667eea;
box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
.portfolio-container.portfolio-2 .select-compact:focus {
border-color: #28a745;
box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
}
.selector-row {
display: flex;
gap: 20px;
justify-content: center;
align-items: center;
margin-top: 15px;
flex-wrap: wrap;
}
.selector-group {
display: flex;
flex-direction: column;
gap: 5px;
}
.selector-label {
font-weight: 600;
color: #495057;
font-size: 13px;
}
select {
padding: 8px 12px;
font-size: 14px;
border: 2px solid #dee2e6;
border-radius: 6px;
background: white;
cursor: pointer;
font-family: 'Roboto Slab', serif;
min-width: 250px;
}
select:focus {
outline: none;
border-color: #007bff;
}
.upload-button {
background: linear-gradient(135deg, #007bff, #0056b3);
color: white;
padding: 12px 30px;
border: none;
border-radius: 6px;
font-size: 16px;
font-weight: 600;
cursor: pointer;
transition: transform 0.2s, box-shadow 0.2s;
}
.upload-button:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(0,123,255,0.3);
}
#fileInput {
display: none;
}
.message {
padding: 15px;
border-radius: 6px;
margin-top: 15px;
display: none;
}
.error-message {
background: #f8d7da;
color: #721c24;
}
.success-message {
background: #d4edda;
color: #155724;
}
#reportContent {
display: none;
}
.copy-button-container {
text-align: center;
margin: 20px 0 30px 0;
padding: 20px;
background: #f8f9fa;
border-radius: 8px;
}
.copy-button {
background: linear-gradient(135deg, #28a745, #20c997);
color: white;
padding: 12px 30px;
border: none;
border-radius: 6px;
font-size: 15px;
font-weight: 600;
cursor: pointer;
transition: transform 0.2s, box-shadow 0.2s;
}
.copy-button:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(40,167,69,0.3);
}
.copy-status {
margin-top: 10px;
font-size: 14px;
color: #28a745;
font-weight: 600;
display: none;
}
#presentationContent {
width: 60%;
margin: 0 auto;
}
.header {
display: flex;
align-items: flex-start;
gap: 15px;
margin-bottom: 15px;
}
.header > div:first-child {
flex-shrink: 0;
}
.header > div:last-child {
flex: 1;
}
h1 {
font-size: 32px;
color: #1a1a1a;
margin-bottom: 3px;
font-weight: 700;
}
.subtitle {
font-size: 16px;
color: #666;
font-style: italic;
}
.section-header {
font-size: 20px;
font-weight: 700;
color: #1a1a1a;
margin: 10px 0 6px 0;
padding-bottom: 4px;
border-bottom: 3px solid #007bff;
text-align: center;
}
.performance-table {
width: 100%;
border-collapse: collapse;
margin: 10px 0;
}
.performance-table thead tr {
background: linear-gradient(135deg, #007bff, #0056b3);
color: white;
}
.performance-table th {
padding: 4px 5px;
text-align: center;
font-weight: 600;
font-size: 17px;
}
.performance-table th:nth-child(2),
.performance-table td:nth-child(2) {
width: 80px;
white-space: nowrap;
}
.performance-table th:first-child {
border-top-left-radius: 8px;
}
.performance-table th:last-child {
border-top-right-radius: 8px;
}
.perfo...(truncated 96487 characters)...= 0 ? 'positive' : 'negative';
// Win Rate (now position 10)
document.getElementById('option1WinRate').textContent = (risk1.winRate * 100).toFixed(1) + '%';
document.getElementById('option2WinRate').textContent = (risk2.winRate * 100).toFixed(1) + '%';
const winRateDiff = risk1.winRate - risk2.winRate;
const winRateDiffEl = document.getElementById('winRateDiff');
winRateDiffEl.textContent = (winRateDiff * 100).toFixed(1) + '%';
winRateDiffEl.className = winRateDiff >= 0 ? 'positive' : 'negative';
// Create growth chart
createGrowthChart(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6, col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8, portfolio1Name, portfolio2Name);
document.getElementById('reportContent').style.display = 'block';
}
function createGrowthChart(col1, alloc1, col2, alloc2, col5, alloc5, col6, alloc6, col3, alloc3, col4, alloc4, col7, alloc7, col8, alloc8, portfolio1Name, portfolio2Name) {
const years = Math.round(yearsValue);
// Calculate year-by-year growth for both portfolios
const portfolio1Values = [100000]; // Start with $100K
const portfolio2Values = [100000];
const labels = ['Year 0'];
let value1 = 100000;
let value2 = 100000;
for (let year = 1; year <= years; year++) {
const rowIndex = 19 + year;
const row = excelData[rowIndex];
// Portfolio 1 blended return
let return1 = 0;
if (col1 && alloc1 > 0 && row && row[col1] !== null) {
const ret = typeof row[col1] === 'number' ? row[col1] : parseValue(row[col1]);
return1 += ret * (alloc1 / 100);
}
if (col2 && alloc2 > 0 && row && row[col2] !== null) {
const ret = typeof row[col2] === 'number' ? row[col2] : parseValue(row[col2]);
return1 += ret * (alloc2 / 100);
}
if (col5 && alloc5 > 0 && row && row[col5] !== null) {
const ret = typeof row[col5] === 'number' ? row[col5] : parseValue(row[col5]);
return1 += ret * (alloc5 / 100);
}
if (col6 && alloc6 > 0 && row && row[col6] !== null) {
const ret = typeof row[col6] === 'number' ? row[col6] : parseValue(row[col6]);
return1 += ret * (alloc6 / 100);
}
// Portfolio 2 blended return
let return2 = 0;
if (col3 && alloc3 > 0 && row && row[col3] !== null) {
const ret = typeof row[col3] === 'number' ? row[col3] : parseValue(row[col3]);
return2 += ret * (alloc3 / 100);
}
if (col4 && alloc4 > 0 && row && row[col4] !== null) {
const ret = typeof row[col4] === 'number' ? row[col4] : parseValue(row[col4]);
return2 += ret * (alloc4 / 100);
}
if (col7 && alloc7 > 0 && row && row[col7] !== null) {
const ret = typeof row[col7] === 'number' ? row[col7] : parseValue(row[col7]);
return2 += ret * (alloc7 / 100);
}
if (col8 && alloc8 > 0 && row && row[col8] !== null) {
const ret = typeof row[col8] === 'number' ? row[col8] : parseValue(row[col8]);
return2 += ret * (alloc8 / 100);
}
value1 *= (1 + return1);
value2 *= (1 + return2);
portfolio1Values.push(value1);
portfolio2Values.push(value2);
labels.push(Year ${year});
}
// Update chart subtitle
document.getElementById('chartSubtitle').textContent = ${portfolio1Name} vs ${portfolio2Name};
// Destroy existing chart if it exists
if (growthChart) {
growthChart.destroy();
}
// Create new chart
const ctx = document.getElementById('growthChart').getContext('2d');
growthChart = new Chart(ctx, {
type: 'line',
data: {
labels: labels,
datasets: [
{
label: portfolio1Name,
data: portfolio1Values,
borderColor: '#007bff',
backgroundColor: 'rgba(0, 123, 255, 0.1)',
borderWidth: 3,
fill: false,
tension: 0.1,
pointRadius: 2,
pointHoverRadius: 5
},
{
label: portfolio2Name,
data: portfolio2Values,
borderColor: '#28a745',
backgroundColor: 'rgba(40, 167, 69, 0.1)',
borderWidth: 3,
fill: false,
tension: 0.1,
pointRadius: 2,
pointHoverRadius: 5
}
]
},
options: {
responsive: true,
maintainAspectRatio: false,
plugins: {
legend: {
display: true,
position: 'bottom',
labels: {
font: {
size: 14,
family: "'Roboto Slab', serif",
weight: 600
},
padding: 15,
usePointStyle: true
}
},
tooltip: {
mode: 'index',
intersect: false,
backgroundColor: 'rgba(0, 0, 0, 0.8)',
titleFont: {
size: 14,
family: "'Roboto Slab', serif"
},
bodyFont: {
size: 13,
family: "'Roboto Slab', serif"
},
padding: 12,
callbacks: {
label: function(context) {
let label = context.dataset.label || '';
if (label) {
label += ': ';
}
label += '$' + Math.round(context.parsed.y).toLocaleString();
return label;
}
}
}
},
scales: {
x: {
grid: {
display: false
},
ticks: {
font: {
size: 11,
family: "'Roboto Slab', serif"
},
maxRotation: 45,
minRotation: 45
}
},
y: {
beginAtZero: true,
grid: {
color: 'rgba(0, 0, 0, 0.05)'
},
ticks: {
font: {
size: 12,
family: "'Roboto Slab', serif"
},
callback: function(value) {
if (value >= 1000000) {
return '$' + (value / 1000000).toFixed(1) + 'M';
}
return '$' + (value / 1000).toFixed(0) + 'K';
}
}
}
},
interaction: {
mode: 'nearest',
axis: 'x',
intersect: false
}
}
});
}
function calculateDifference(val1, val2, isCurrency = false) {
const num1 = parseValue(val1);
const num2 = parseValue(val2);
if (isNaN(num1) || isNaN(num2)) return 0;
return num1 - num2;
}
function parseValue(value) {
if (typeof value === 'number') return value;
if (typeof value === 'string') {
const cleaned = value.replace(/[$,%,\s]/g, '');
const num = parseFloat(cleaned);
if (value.includes('%')) {
return num / 100;
}
return num;
}
return 0;
}
function formatValue(value) {
if (value === null || value === undefined) return 'N/A';
if (typeof value === 'string') return value;
if (typeof value === 'number') {
if (Math.abs(value) <= 1) {
return formatPercent(value);
}
return formatCurrency(value);
}
return value;
}
function formatPercent(value) {
if (value === null || value === undefined || isNaN(value)) return '0.00%';
if (typeof value === 'number') {
return (value * 100).toFixed(2) + '%';
}
if (typeof value === 'string' && value.includes('%')) {
return value;
}
return value + '%';
}
function formatCurrency(value) {
if (value === null || value === undefined || isNaN(value)) return '$0';
if (typeof value === 'number') {
return '$' + value.toLocaleString('en-US', {
minimumFractionDigits: 0,
maximumFractionDigits: 0
});
}
if (typeof value === 'string' && value.includes('$')) {
return value;
}
return '$' + value;
}
async function copyAllAsImage() {
const copyStatus = document.getElementById('copyStatus');
const buttons = document.querySelectorAll('.copy-button');
buttons[0].disabled = true;
buttons[0].textContent = '‚è≥ Generating...';
try {
// Create a temporary container with everything
const tempDiv = document.createElement('div');
tempDiv.style.position = 'absolute';
tempDiv.style.left = '-9999px';
tempDiv.style.width = '540px'; // 60% of 900px to match display
tempDiv.style.background = '#ffffff';
tempDiv.style.padding = '20px';
document.body.appendChild(tempDiv);
// Add main header
const mainHeader = document.createElement('div');
mainHeader.className = 'header';
const h1 = document.createElement('h1');
h1.textContent = 'Performance Comparison';
h1.style.fontSize = '28px';
h1.style.fontWeight = '700';
h1.style.color = '#1a1a1a';
h1.style.marginBottom = '5px';
mainHeader.appendChild(h1);
const subtitle = document.createElement('div');
subtitle.className = 'subtitle';
subtitle.textContent = document.getElementById('comparisonSubtitle').textContent;
subtitle.style.fontSize = '14px';
subtitle.style.color = '#666';
subtitle.style.fontStyle = 'italic';
subtitle.style.marginBottom = '15px';
mainHeader.appendChild(subtitle);
tempDiv.appendChild(mainHeader);
// Clone Performance Metrics section
const perfHeader = document.querySelector('.section-header');
if (perfHeader) {
tempDiv.appendChild(perfHeader.cloneNode(true));
}
// Clone portfolio key
const portfolioKey = document.getElementById('portfolioKey');
if (portfolioKey) {
tempDiv.appendChild(portfolioKey.cloneNode(true));
}
const perfTable = document.querySelector('.performance-table');
if (perfTable) {
const tableClone = perfTable.cloneNode(true);
// Ensure tbody content is captured
const originalTbody = perfTable.querySelector('tbody');
const cloneTbody = tableClone.querySelector('tbody');
if (originalTbody && cloneTbody) {
cloneTbody.innerHTML = originalTbody.innerHTML;
}
tempDiv.appendChild(tableClone);
}
// Clone Investment Analysis section
const invHeader = document.querySelectorAll('.section-header')[1];
if (invHeader) {
tempDiv.appendChild(invHeader.cloneNode(true));
}
const metricsContainer = document.querySelector('.metrics-container');
if (metricsContainer) {
tempDiv.appendChild(metricsContainer.cloneNode(true));
}
// Clone the note
const note = document.querySelectorAll('#presentationContent > div[style*="font-size: 11px"]')[0];
if (note) {
tempDiv.appendChild(note.cloneNode(true));
}
// Clone Portfolio Growth section
const growthHeader = document.querySelectorAll('.section-header')[2];
if (growthHeader) {
tempDiv.appendChild(growthHeader.cloneNode(true));
}
// Add chart content
const chartContentDiv = document.createElement('div');
chartContentDiv.style.background = '#ffffff';
chartContentDiv.style.padding = '15px';
chartContentDiv.style.borderRadius = '8px';
chartContentDiv.style.marginTop = '6px';
const titleDiv = document.createElement('div');
titleDiv.style.textAlign = 'center';
titleDiv.style.marginBottom = '10px';
const h3 = document.createElement('h3');
h3.textContent = '$100,000 Investment Growth';
h3.style.fontSize = '18px';
h3.style.color = '#1a1a1a';
h3.style.fontWeight = '600';
h3.style.marginBottom = '3px';
titleDiv.appendChild(h3);
const chartSubtitle = document.getElementById('chartSubtitle').cloneNode(true);
titleDiv.appendChild(chartSubtitle);
chartContentDiv.appendChild(titleDiv);
const chartCanvas = document.getElementById('growthChart');
if (chartCanvas) {
const canvasClone = document.createElement('canvas');
canvasClone.width = chartCanvas.width;
canvasClone.height = chartCanvas.height;
const ctx = canvasClone.getContext('2d');
ctx.drawImage(chartCanvas, 0, 0);
canvasClone.style.width = '100%';
canvasClone.style.height = 'auto';
chartContentDiv.appendChild(canvasClone);
}
const chartNote = document.createElement('div');
chartNote.textContent = 'Growth calculated from annual returns with annual rebalancing.';
chartNote.style.textAlign = 'center';
chartNote.style.fontSize = '11px';
chartNote.style.color = '#999';
chartNote.style.fontStyle = 'italic';
chartNote.style.marginTop = '8px';
chartContentDiv.appendChild(chartNote);
tempDiv.appendChild(chartContentDiv);
// Clone Risk Metrics section
const riskHeader = document.querySelectorAll('.section-header')[3];
if (riskHeader) {
tempDiv.appendChild(riskHeader.cloneNode(true));
}
const riskContent = document.getElementById('riskMetricsContent');
if (riskContent) {
tempDiv.appendChild(riskContent.cloneNode(true));
}
const canvas = await html2canvas(tempDiv, {
backgroundColor: '#ffffff',
scale: 2,
logging: false,
useCORS: true,
allowTaint: true
});
// Clean up
document.body.removeChild(tempDiv);
canvas.toBlob(async (blob) => {
try {
await navigator.clipboard.write([
new ClipboardItem({'image/png': blob})
]);
copyStatus.textContent = '‚úì All sections copied to clipboard!';
copyStatus.style.display = 'block';
setTimeout(() => {
copyStatus.style.display = 'none';
}, 3000);
} catch (err) {
const url = canvas.toDataURL('image/png');
const link = document.createElement('a');
link.download = 'portfolio-comparison-all.png';
link.href = url;
link.click();
copyStatus.textContent = '‚úì All sections downloaded!';
copyStatus.style.display = 'block';
setTimeout(() => {
copyStatus.style.display = 'none';
}, 3000);
}
}, 'image/png');
} catch (err) {
alert('Failed to generate image: ' + err.message);
} finally {
buttons[0].disabled = false;
buttons[0].textContent = 'üìë Copy All';
}
}
async function copyReportAsImage() {
const copyStatus = document.getElementById('copyStatus');
const buttons = document.querySelectorAll('.copy-button');
buttons[1].disabled = true;
buttons[1].textContent = '‚è≥ Generating...';
try {
// Create a temporary container with just the performance metrics and investment analysis
const tempDiv = document.createElement('div');
tempDiv.style.position = 'absolute';
tempDiv.style.left = '-9999px';
tempDiv.style.width = '540px'; // 60% of 900px to match display
tempDiv.style.background = '#ffffff';
tempDiv.style.padding = '20px';
document.body.appendChild(tempDiv);
// Add main header
const mainHeader = document.createElement('div');
mainHeader.className = 'header';
const h1 = document.createElement('h1');
h1.textContent = 'Performance Comparison';
h1.style.fontSize = '28px';
h1.style.fontWeight = '700';
h1.style.color = '#1a1a1a';
h1.style.marginBottom = '5px';
mainHeader.appendChild(h1);
const subtitle = document.createElement('div');
subtitle.className = 'subtitle';
subtitle.textContent = document.getElementById('comparisonSubtitle').textContent;
subtitle.style.fontSize = '14px';
subtitle.style.color = '#666';
subtitle.style.fontStyle = 'italic';
subtitle.style.marginBottom = '15px';
mainHeader.appendChild(subtitle);
tempDiv.appendChild(mainHeader);
// Clone the section header
const perfHeader = document.querySelector('.section-header');
if (perfHeader) {
tempDiv.appendChild(perfHeader.cloneNode(true));
}
// Clone portfolio key
const portfolioKey = document.getElementById('portfolioKey');
if (portfolioKey) {
tempDiv.appendChild(portfolioKey.cloneNode(true));
}
// Clone the performance table with all its content
const perfTable = document.querySelector('.performance-table');
if (perfTable) {
const tableClone = perfTable.cloneNode(true);
// Ensure tbody content is captured
const originalTbody = perfTable.querySelector('tbody');
const cloneTbody = tableClone.querySelector('tbody');
if (originalTbody && cloneTbody) {
cloneTbody.innerHTML = originalTbody.innerHTML;
}
tempDiv.appendChild(tableClone);
}
// Clone the Investment Analysis section
const invHeader = document.querySelectorAll('.section-header')[1];
if (invHeader) {
tempDiv.appendChild(invHeader.cloneNode(true));
}
const metricsContainer = document.querySelector('.metrics-container');
if (metricsContainer) {
tempDiv.appendChild(metricsContainer.cloneNode(true));
}
// Clone the note
const note = document.querySelectorAll('#presentationContent > div[style*="font-size: 11px"]')[0];
if (note) {
tempDiv.appendChild(note.cloneNode(true));
}
const canvas = await html2canvas(tempDiv, {
backgroundColor: '#ffffff',
scale: 2,
logging: false,
useCORS: true,
allowTaint: true
});
// Clean up
document.body.removeChild(tempDiv);
canvas.toBlob(async (blob) => {
try {
await navigator.clipboard.write([
new ClipboardItem({'image/png': blob})
]);
copyStatus.textContent = '‚úì Performance data copied to clipboard!';
copyStatus.style.display = 'block';
setTimeout(() => {
copyStatus.style.display = 'none';
}, 3000);
} catch (err) {
const url = canvas.toDataURL('image/png');
const link = document.createElement('a');
link.download = 'performance-comparison.png';
link.href = url;
link.click();
copyStatus.textContent = '‚úì Performance data downloaded!';
copyStatus.style.display = 'block';
setTimeout(() => {
copyStatus.style.display = 'none';
}, 3000);
}
}, 'image/png');
} catch (err) {
alert('Failed to generate image: ' + err.message);
} finally {
buttons[1].disabled = false;
buttons[1].textContent = 'üìã Copy Performance Report';
}
}
async function copyRiskMetricsAsImage() {
const riskMetricsContent = document.getElementById('riskMetricsContent');
const copyStatus = document.getElementById('copyStatus');
const buttons = document.querySelectorAll('.copy-button');
buttons[3].disabled = true;
buttons[3].textContent = '‚è≥ Generating...';
try {
// Create temp container with 60% width to match display
const tempDiv = document.createElement('div');
tempDiv.style.position = 'absolute';
tempDiv.style.left = '-9999px';
tempDiv.style.width = '540px'; // 60% of 900px container
tempDiv.style.background = '#ffffff';
tempDiv.style.padding = '20px';
tempDiv.style.borderRadius = '8px';
document.body.appendChild(tempDiv);
// Add section header
const header = document.createElement('div');
header.className = 'section-header';
header.style.marginTop = '0';
header.textContent = 'Advanced Risk Metrics';
tempDiv.appendChild(header);
// Add portfolio key
const portfolioKey = document.createElement('div');
portfolioKey.style.textAlign = 'center';
portfolioKey.style.fontSize = '13px';
portfolioKey.style.color = '#666';
portfolioKey.style.fontStyle = 'italic';
portfolioKey.style.marginTop = '3px';
portfolioKey.style.marginBottom = '8px';
const portfolio1Name = document.getElementById('portfolio1DescriptionRisk').textContent;
const portfolio2Name = document.getElementById('portfolio2DescriptionRisk').textContent;
portfolioKey.innerHTML = <span>${portfolio1Name}</span> vs <span>${portfolio2Name}</span>;
tempDiv.appendChild(portfolioKey);
// Clone risk metrics content
const riskContentClone = document.createElement('div');
riskContentClone.innerHTML = riskMetricsContent.innerHTML;
riskContentClone.style.background = '#fafbfc';
riskContentClone.style.padding = '12px';
riskContentClone.style.borderRadius = '8px';
tempDiv.appendChild(riskContentClone);
const canvas = await html2canvas(tempDiv, {
backgroundColor: '#ffffff',
scale: 2,
logging: false,
useCORS: true,
allowTaint: true
});
// Clean up
document.body.removeChild(tempDiv);
canvas.toBlob(async (blob) => {
try {
await navigator.clipboard.write([
new ClipboardItem({'image/png': blob})
]);
copyStatus.textContent = '‚úì Risk metrics copied to clipboard!';
copyStatus.style.display = 'block';
setTimeout(() => {
copyStatus.style.display = 'none';
}, 3000);
} catch (err) {
const url = canvas.toDataURL('image/png');
const link = document.createElement('a');
link.download = 'risk-metrics.png';
link.href = url;
link.click();
copyStatus.textContent = '‚úì Risk metrics downloaded!';
copyStatus.style.display = 'block';
setTimeout(() => {
copyStatus.style.display = 'none';
}, 3000);
}
}, 'image/png');
} catch (err) {
alert('Failed to generate image: ' + err.message);
} finally {
buttons[3].disabled = false;
buttons[3].textContent = 'üìä Copy Risk Metrics';
}
}
async function copyGrowthChartAsImage() {
const copyStatus = document.getElementById('copyStatus');
const buttons = document.querySelectorAll('.copy-button');
buttons[2].disabled = true;
buttons[2].textContent = '‚è≥ Generating...';
try {
// Create temp container
const tempDiv = document.createElement('div');
tempDiv.style.position = 'absolute';
tempDiv.style.left = '-9999px';
tempDiv.style.width = '540px'; // 60% of 900px
tempDiv.style.background = '#ffffff';
tempDiv.style.padding = '20px';
document.body.appendChild(tempDiv);
// Add Portfolio Growth section header
const growthHeader = document.querySelectorAll('.section-header')[2];
if (growthHeader) {
tempDiv.appendChild(growthHeader.cloneNode(true));
}
// Add chart content container
const chartContentDiv = document.createElement('div');
chartContentDiv.style.background = '#ffffff';
chartContentDiv.style.padding = '15px';
chartContentDiv.style.borderRadius = '8px';
chartContentDiv.style.marginTop = '6px';
// Add chart title and subtitle
const titleDiv = document.createElement('div');
titleDiv.style.textAlign = 'center';
titleDiv.style.marginBottom = '10px';
const h3 = document.createElement('h3');
h3.textContent = '$100,000 Investment Growth';
h3.style.fontSize = '18px';
h3.style.color = '#1a1a1a';
h3.style.fontWeight = '600';
h3.style.marginBottom = '3px';
titleDiv.appendChild(h3);
const subtitle = document.getElementById('chartSubtitle').cloneNode(true);
titleDiv.appendChild(subtitle);
chartContentDiv.appendChild(titleDiv);
// Add the chart canvas
const chartCanvas = document.getElementById('growthChart');
if (chartCanvas) {
const canvasClone = document.createElement('canvas');
canvasClone.width = chartCanvas.width;
canvasClone.height = chartCanvas.height;
const ctx = canvasClone.getContext('2d');
ctx.drawImage(chartCanvas, 0, 0);
canvasClone.style.width = '100%';
canvasClone.style.height = 'auto';
chartContentDiv.appendChild(canvasClone);
}
// Add chart note
const chartNote = document.createElement('div');
chartNote.textContent = 'Growth calculated from annual returns with annual rebalancing.';
chartNote.style.textAlign = 'center';
chartNote.style.fontSize = '11px';
chartNote.style.color = '#999';
chartNote.style.fontStyle = 'italic';
chartNote.style.marginTop = '8px';
chartContentDiv.appendChild(chartNote);
tempDiv.appendChild(chartContentDiv);
// Generate image using html2canvas
const canvas = await html2canvas(tempDiv, {
backgroundColor: '#ffffff',
scale: 2,
logging: false,
useCORS: true,
allowTaint: true
});
// Clean up
document.body.removeChild(tempDiv);
// Convert to blob and copy
canvas.toBlob(async (blob) => {
try {
await navigator.clipboard.write([
new ClipboardItem({'image/png': blob})
]);
copyStatus.textContent = '‚úì Growth chart copied to clipboard!';
copyStatus.style.display = 'block';
setTimeout(() => {
copyStatus.style.display = 'none';
}, 3000);
} catch (err) {
const url = canvas.toDataURL('image/png');
const link = document.createElement('a');
link.download = 'growth-chart.png';
link.href = url;
link.click();
copyStatus.textContent = '‚úì Growth chart downloaded!';
copyStatus.style.display = 'block';
setTimeout(() => {
copyStatus.style.display = 'none';
}, 3000);
}
}, 'image/png');
} catch (err) {
alert('Failed to generate image: ' + err.message);
} finally {
buttons[2].disabled = false;
buttons[2].textContent = 'üìà Copy Growth Chart';
}
}
// ============================================================================
// DATA UPDATE FUNCTIONALITY
// ============================================================================
let updatedExcelData = null;
document.getElementById('updateDataInput').addEventListener('change', function(e) {
const file = e.target.files[0];
if (!file) return;
const statusDiv = document.getElementById('updateStatus');
statusDiv.innerHTML = '‚è≥ Reading file...';
const reader = new FileReader();
reader.onload = function(e) {
try {
// Parse Excel file
const data = new Uint8Array(e.target.result);
const workbook = XLSX.read(data, {type: 'array'});
const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
const jsonData = XLSX.utils.sheet_to_json(firstSheet, {header: 1});
if (jsonData.length < 40) {
throw new Error(Excel file must have at least 40 rows (found ${jsonData.length}));
}
// Validate structure
const modelCount = jsonData[1].filter((cell, idx) => idx >= 2 && cell).length; // Count from column C onwards
if (modelCount < 1) {
throw new Error('No model columns found in Excel file');
}
// Store the updated data
updatedExcelData = jsonData;
// Update the tool with new data
updateToolWithNewData(jsonData);
statusDiv.innerHTML = <span style="color: #28a745;">‚úÖ Success! Loaded ${modelCount} models from ${jsonData.length} rows</span>;
// Show download button
document.getElementById('downloadUpdatedHtml').style.display = 'inline-block';
} catch (error) {
statusDiv.innerHTML = `<span style="color: #dc354